if (typeof define !== 'function') var define = require('amdefine')(module);define(['exports', 'esast/dist/Loc', 'tupl/dist/tupl', '../CompileError', '../Expression', './util'], function (exports, _esastDistLoc, _tuplDistTupl, _CompileError, _Expression, _util) {
	'use strict';

	Object.defineProperty(exports, '__esModule', {
		value: true
	});

	function _interopRequire(obj) { return obj && obj.__esModule ? obj['default'] : obj; }

	var _Loc = _interopRequire(_esastDistLoc);

	var _tupl = _interopRequire(_tuplDistTupl);

	const Token = (0, _tuplDistTupl.abstract)('Token', Object, 'TODO:doc', {
		toString: function () {
			return (0, _CompileError.code)(this.show());
		}
	});
	exports.default = Token;

	const tt = function (name, namesTypes, props) {
		return (0, _tupl)(name, Token, 'doc', ['loc', _Loc].concat(namesTypes), {}, props);
	};

	const gIs = function (k) {
		return function (t) {
			return t instanceof Group && t.kind === k;
		};
	};
	const kwIs = function (k) {
		return function (t) {
			return t instanceof Keyword && t.kind === k;
		};
	};

	// Don't use `0` because we want to use negative nmbers to represent GroupPre closers.
	const G_Paren = 1,
	      G_Bracket = 2,
	      G_Block = 3,
	      G_Quote = 4,
	      G_Line = 5,
	      G_Space = 6;

	exports.G_Paren = G_Paren;
	exports.G_Bracket = G_Bracket;
	exports.G_Block = G_Block;
	exports.G_Quote = G_Quote;
	exports.G_Line = G_Line;
	exports.G_Space = G_Space;
	let nextId = 0;
	const nameToK = new Map();
	const kToName = new Map();
	const kw = function (name) {
		const k = kwNotName(name);
		nameToK.set(name, k);
		return k;
	};
	const kwNotName = function (debugName) {
		const k = nextId;
		kToName.set(k, debugName);
		nextId = nextId + 1;
		return k;
	};

	const KW_Assign = kw('='),
	      KW_Case = kw('case'),
	      KW_CaseDo = kw('case!'),
	      KW_Debug = kw('debug'),
	      KW_Debugger = kw('debugger'),
	      KW_Else = kw('else'),
	      KW_EndLoop = kw('end-loop!'),
	      KW_False = kw('false'),
	      KW_Focus = kwNotName('_'),
	      KW_Fun = kw('|'),
	      KW_GenFun = kw('~|'),
	      KW_In = kw('in'),
	      KW_Lazy = kwNotName('~'),
	      KW_Loop = kw('loop!'),
	      KW_MapEntry = kw('->'),
	      KW_Null = kw('null'),
	      KW_ObjAssign = kw('. '),
	      KW_Out = kw('out'),
	      KW_Pass = kw('pass'),
	      KW_Region = kw('region'),
	      KW_This = kw('this'),
	      KW_ThisModuleDirectory = kw('this-module-directory'),
	      KW_True = kw('true'),
	      KW_Type = kwNotName(':'),
	      KW_Undefined = kw('undefined'),
	      KW_Use = kw('use'),
	      KW_UseDebug = kw('use-debug'),
	      KW_UseDo = kw('use!'),
	      KW_UseLazy = kw('use~'),
	      KW_Yield = kw('<~'),
	      KW_YieldTo = kw('<~~');

	exports.KW_Assign = KW_Assign;
	exports.KW_Case = KW_Case;
	exports.KW_CaseDo = KW_CaseDo;
	exports.KW_Debug = KW_Debug;
	exports.KW_Debugger = KW_Debugger;
	exports.KW_Else = KW_Else;
	exports.KW_EndLoop = KW_EndLoop;
	exports.KW_False = KW_False;
	exports.KW_Focus = KW_Focus;
	exports.KW_Fun = KW_Fun;
	exports.KW_GenFun = KW_GenFun;
	exports.KW_In = KW_In;
	exports.KW_Lazy = KW_Lazy;
	exports.KW_Loop = KW_Loop;
	exports.KW_MapEntry = KW_MapEntry;
	exports.KW_Null = KW_Null;
	exports.KW_ObjAssign = KW_ObjAssign;
	exports.KW_Out = KW_Out;
	exports.KW_Pass = KW_Pass;
	exports.KW_Region = KW_Region;
	exports.KW_This = KW_This;
	exports.KW_ThisModuleDirectory = KW_ThisModuleDirectory;
	exports.KW_True = KW_True;
	exports.KW_Type = KW_Type;
	exports.KW_Undefined = KW_Undefined;
	exports.KW_Use = KW_Use;
	exports.KW_UseDebug = KW_UseDebug;
	exports.KW_UseDo = KW_UseDo;
	exports.KW_UseLazy = KW_UseLazy;
	exports.KW_Yield = KW_Yield;
	exports.KW_YieldTo = KW_YieldTo;
	const keywordKFromName = function (name) {
		return nameToK.get(name);
	},
	      opKWtoSV = function (kw) {
		switch (kw) {
			case KW_False:
				return _Expression.SV_False;
			case KW_Null:
				return _Expression.SV_Null;
			case KW_This:
				return _Expression.SV_This;
			case KW_ThisModuleDirectory:
				return _Expression.SV_ThisModuleDirectory;
			case KW_True:
				return _Expression.SV_True;
			case KW_Undefined:
				return _Expression.SV_Undefined;
			default:
				return null;
		}
	};

	exports.keywordKFromName = keywordKFromName;
	exports.opKWtoSV = opKWtoSV;
	const CallOnFocus = tt('CallOnFocus', ['name', String]),
	      DotName = tt('DotName', ['nDots', Number, 'name', String]),
	      Group = tt('Group', ['tokens', [Token], 'kind', Number], {
		isBlock: gIs(G_Block),
		isSpaced: gIs(G_Space)
	}),
	      Keyword = tt('Keyword', ['kind', Number], {
		is: kwIs,
		isType: kwIs(KW_Type),
		isFocus: kwIs(KW_Focus),
		isElse: kwIs(KW_Else),
		isLazy: kwIs(KW_Lazy),
		isLineSplit: function (t) {
			return t instanceof Keyword && (t.kind === KW_Assign || t.kind === KW_ObjAssign || t.kind === KW_Yield || t.kind === KW_YieldTo || t.kind === KW_MapEntry);
		},
		isObjAssign: kwIs(KW_ObjAssign)
	}),
	      Name = tt('Name', ['name', String]),
	      TokenNumberLiteral = tt('TokenNumberLiteral', ['value', Number]);

	exports.CallOnFocus = CallOnFocus;
	exports.DotName = DotName;
	exports.Group = Group;
	exports.Keyword = Keyword;
	exports.Name = Name;
	exports.TokenNumberLiteral = TokenNumberLiteral;
	// toString is used by some parsing errors. Use U.inspect for a more detailed view.
	(0, _util.implementMany)({ CallOnFocus: CallOnFocus, DotName: DotName, Group: Group, Keyword: Keyword, Name: Name, TokenNumberLiteral: TokenNumberLiteral }, 'show', {
		CallOnFocus: function () {
			return '' + this.name + '_';
		},
		DotName: function () {
			return '' + '.'.repeat(this.nDots) + '' + this.name;
		},
		// TODO: better representation of k
		Group: function () {
			return 'group(k=' + this.kind + ')';
		},
		// TODO: better representation of k
		Keyword: function () {
			return 'keyword(k=' + kToName.get(this.kind) + ')';
		},
		Name: function () {
			return this.name;
		},
		TokenNumberLiteral: function () {
			return this.value;
		}
	});
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1ldGEvY29tcGlsZS9wcml2YXRlL1Rva2VuLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFPQSxPQUFNLEtBQUssR0FBRyxrQkFOQyxRQUFRLEVBTUEsT0FBTyxFQUFFLE1BQU0sRUFDckMsVUFBVSxFQUNWO0FBQ0MsVUFBUSxFQUFBLFlBQUc7QUFBRSxVQUFPLGtCQVJiLElBQUksRUFRYyxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQTtHQUFFO0VBQ3ZDLENBQUMsQ0FBQTttQkFDWSxLQUFLOztBQUVwQixPQUFNLEVBQUUsR0FBRyxVQUFDLElBQUksRUFBRSxVQUFVLEVBQUUsS0FBSztTQUNsQyxXQUFLLElBQUksRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLENBQUUsS0FBSyxPQUFPLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxFQUFFLEVBQUcsRUFBRSxLQUFLLENBQUM7RUFBQSxDQUFBOztBQUV4RSxPQUFNLEdBQUcsR0FBRyxVQUFBLENBQUM7U0FBSSxVQUFBLENBQUM7VUFBSSxDQUFDLFlBQVksS0FBSyxJQUFJLENBQUMsQ0FBQyxJQUFJLEtBQUssQ0FBQztHQUFBO0VBQUEsQ0FBQTtBQUN4RCxPQUFNLElBQUksR0FBRyxVQUFBLENBQUM7U0FBSSxVQUFBLENBQUM7VUFBSSxDQUFDLFlBQVksT0FBTyxJQUFJLENBQUMsQ0FBQyxJQUFJLEtBQUssQ0FBQztHQUFBO0VBQUEsQ0FBQTs7O0FBR3BELE9BQ04sT0FBTyxHQUFHLENBQUM7T0FDWCxTQUFTLEdBQUcsQ0FBQztPQUNiLE9BQU8sR0FBRyxDQUFDO09BQ1gsT0FBTyxHQUFHLENBQUM7T0FDWCxNQUFNLEdBQUcsQ0FBQztPQUNWLE9BQU8sR0FBRyxDQUFDLENBQUE7O1NBTFgsT0FBTyxHQUFQLE9BQU87U0FDUCxTQUFTLEdBQVQsU0FBUztTQUNULE9BQU8sR0FBUCxPQUFPO1NBQ1AsT0FBTyxHQUFQLE9BQU87U0FDUCxNQUFNLEdBQU4sTUFBTTtTQUNOLE9B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QUFFLENBQUM7T0FDckMsa0JBQWtCLEdBQUcsRUFBRSxDQUFDLG9CQUFvQixFQUFFLENBQUUsT0FBTyxFQUFFLE1BQU0sQ0FBRSxDQUFDLENBQUE7O1NBekJsRSxXQUFXLEdBQVgsV0FBVztTQUNYLE9BQU8sR0FBUCxPQUFPO1NBQ1AsS0FBSyxHQUFMLEtBQUs7U0FNTCxPQUFPLEdBQVAsT0FBTztTQWdCUCxJQUFJLEdBQUosSUFBSTtTQUNKLGtCQUFrQixHQUFsQixrQkFBa0I7O0FBR25CLFdBbkhTLGFBQWEsRUFtSFIsRUFBRSxXQUFXLEVBQVgsV0FBVyxFQUFFLE9BQU8sRUFBUCxPQUFPLEVBQUUsS0FBSyxFQUFMLEtBQUssRUFBRSxPQUFPLEVBQVAsT0FBTyxFQUFFLElBQUksRUFBSixJQUFJLEVBQUUsa0JBQWtCLEVBQWxCLGtCQUFrQixFQUFFLEVBQUUsTUFBTSxFQUFFO0FBQ3pGLGFBQVcsRUFBQSxZQUFHO0FBQUUsZUFBVSxJQUFJLENBQUMsSUFBSSxPQUFHO0dBQUU7QUFDeEMsU0FBTyxFQUFBLFlBQUc7QUFBRSxlQUFVLEdBQUcsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxRQUFHLElBQUksQ0FBQyxJQUFJLENBQUU7R0FBRTs7QUFFNUQsT0FBSyxFQUFBLFlBQUc7QUFBRSx1QkFBa0IsSUFBSSxDQUFDLElBQUksT0FBRztHQUFFOztBQUUxQyxTQUFPLEVBQUEsWUFBRztBQUFFLHlCQUFvQixPQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsT0FBRztHQUFFO0FBQzNELE1BQUksRUFBQSxZQUFHO0FBQUUsVUFBTyxJQUFJLENBQUMsSUFBSSxDQUFBO0dBQUU7QUFDM0Isb0JBQWtCLEVBQUEsWUFBRztBQUFFLFVBQU8sSUFBSSxDQUFDLEtBQUssQ0FBQTtHQUFFO0VBQzFDLENBQUMsQ0FBQSIsImZpbGUiOiJtZXRhL2NvbXBpbGUvcHJpdmF0ZS9Ub2tlbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBMb2MgZnJvbSAnZXNhc3QvZGlzdC9Mb2MnXG5pbXBvcnQgdHVwbCwgeyBhYnN0cmFjdCB9IGZyb20gJ3R1cGwvZGlzdC90dXBsJ1xuaW1wb3J0IHsgY29kZSB9IGZyb20gJy4uL0NvbXBpbGVFcnJvcidcbmltcG9ydCB7IFNWX0ZhbHNlLCBTVl9OdWxsLCBTVl9UaGlzLCBTVl9UaGlzTW9kdWxlRGlyZWN0b3J5LCBTVl9UcnVlLCBTVl9VbmRlZmluZWRcblx0fSBmcm9tICcuLi9FeHByZXNzaW9uJ1xuaW1wb3J0IHsgaW1wbGVtZW50TWFueSB9IGZyb20gJy4vdXRpbCdcblxuY29uc3QgVG9rZW4gPSBhYnN0cmFjdCgnVG9rZW4nLCBPYmplY3QsXG5cdCdUT0RPOmRvYycsXG5cdHtcblx0XHR0b1N0cmluZygpIHsgcmV0dXJuIGNvZGUodGhpcy5zaG93KCkpIH1cblx0fSlcbmV4cG9ydCBkZWZhdWx0IFRva2VuXG5cbmNvbnN0IHR0ID0gKG5hbWUsIG5hbWVzVHlwZXMsIHByb3BzKSA9PlxuXHR0dXBsKG5hbWUsIFRva2VuLCAnZG9jJywgWyAnbG9jJywgTG9jIF0uY29uY2F0KG5hbWVzVHlwZXMpLCB7IH0sIHByb3BzKVxuXG5jb25zdCBnSXMgPSBrID0+IHQgPT4gdCBpbnN0YW5jZW9mIEdyb3VwICYmIHQua2luZCA9PT0ga1xuY29uc3Qga3dJcyA9IGsgPT4gdCA9PiB0IGluc3RhbmNlb2YgS2V5d29yZCAmJiB0LmtpbmQgPT09IGtcblxuLy8gRG9uJ3QgdXNlIGAwYCBiZWNhdXNlIHdlIHdhbnQgdG8gdXNlIG5lZ2F0aXZlIG5tYmVycyB0byByZXByZXNlbnQgR3JvdXBQcmUgY2xvc2Vycy5cbmV4cG9ydCBjb25zdFxuXHRHX1BhcmVuID0gMSxcblx0R19CcmFja2V0ID0gMixcblx0R19CbG9jayA9IDMsXG5cdEdfUXVvdGUgPSA0LFxuXHRHX0xpbmUgPSA1LFxuXHRHX1NwYWNlID0gNlxuXG5sZXQgbmV4dElkID0gMFxuY29uc3QgbmFtZVRvSyA9IG5ldyBNYXAoKVxuY29uc3Qga1RvTmFtZSA9IG5ldyBNYXAoKVxuY29uc3Qga3cgPSBuYW1lID0+IHtcblx0Y29uc3QgayA9IGt3Tm90TmFtZShuYW1lKVxuXHRuYW1lVG9LLnNldChuYW1lLCBrKVxuXHRyZXR1cm4ga1xufVxuY29uc3Qga3dOb3ROYW1lID0gZGVidWdOYW1lID0+IHtcblx0Y29uc3QgayA9IG5leHRJZFxuXHRrVG9OYW1lLnNldChrLCBkZWJ1Z05hbWUpXG5cdG5leHRJZCA9IG5leHRJZCArIDFcblx0cmV0dXJuIGtcbn1cblxuZXhwb3J0IGNvbnN0XG5cdEtXX0Fzc2lnbiA9IGt3KCc9JyksXG5cdEtXX0Nhc2UgPSBrdygnY2FzZScpLFxuXHRLV19DYXNlRG8gPSBrdygnY2FzZSEnKSxcblx0S1dfRGVidWcgPSBrdygnZGVidWcnKSxcblx0S1dfRGVidWdnZXIgPSBrdygnZGVidWdnZXInKSxcblx0S1dfRWxzZSA9IGt3KCdlbHNlJyksXG5cdEtXX0VuZExvb3AgPSBrdygnZW5kLWxvb3AhJyksXG5cdEtXX0ZhbHNlID0ga3coJ2ZhbHNlJyksXG5cdEtXX0ZvY3VzID0ga3dOb3ROYW1lKCdfJyksXG5cdEtXX0Z1biA9IGt3KCd8JyksXG5cdEtXX0dlbkZ1biA9IGt3KCd+fCcpLFxuXHRLV19JbiA9IGt3KCdpbicpLFxuXHRLV19MYXp5ID0ga3dOb3ROYW1lKCd+JyksXG5cdEtXX0xvb3AgPSBrdygnbG9vcCEnKSxcblx0S1dfTWFwRW50cnkgPSBrdygnLT4nKSxcblx0S1dfTnVsbCA9IGt3KCdudWxsJyksXG5cdEtXX09iakFzc2lnbiA9IGt3KCcuICcpLFxuXHRLV19PdXQgPSBrdygnb3V0JyksXG5cdEtXX1Bhc3MgPSBrdygncGFzcycpLFxuXHRLV19SZWdpb24gPSBrdygncmVnaW9uJyksXG5cdEtXX1RoaXMgPSBrdygndGhpcycpLFxuXHRLV19UaGlzTW9kdWxlRGlyZWN0b3J5ID0ga3coJ3RoaXMtbW9kdWxlLWRpcmVjdG9yeScpLFxuXHRLV19UcnVlID0ga3coJ3RydWUnKSxcblx0S1dfVHlwZSA9IGt3Tm90TmFtZSgnOicpLFxuXHRLV19VbmRlZmluZWQgPSBrdygndW5kZWZpbmVkJyksXG5cdEtXX1VzZSA9IGt3KCd1c2UnKSxcblx0S1dfVXNlRGVidWcgPSBrdygndXNlLWRlYnVnJyksXG5cdEtXX1VzZURvID0ga3coJ3VzZSEnKSxcblx0S1dfVXNlTGF6eSA9IGt3KCd1c2V+JyksXG5cdEtXX1lpZWxkID0ga3coJzx+JyksXG5cdEtXX1lpZWxkVG8gPSBrdygnPH5+JylcblxuZXhwb3J0IGNvbnN0XG5cdGtleXdvcmRLRnJvbU5hbWUgPSBuYW1lID0+IG5hbWVUb0suZ2V0KG5hbWUpLFxuXHRvcEtXdG9TViA9IGt3ID0+IHtcblx0XHRzd2l0Y2ggKGt3KSB7XG5cdFx0XHRjYXNlIEtXX0ZhbHNlOiByZXR1cm4gU1ZfRmFsc2Vcblx0XHRcdGNhc2UgS1dfTnVsbDogcmV0dXJuIFNWX051bGxcblx0XHRcdGNhc2UgS1dfVGhpczogcmV0dXJuIFNWX1RoaXNcblx0XHRcdGNhc2UgS1dfVGhpc01vZHVsZURpcmVjdG9yeTogcmV0dXJuIFNWX1RoaXNNb2R1bGVEaXJlY3Rvcnlcblx0XHRcdGNhc2UgS1dfVHJ1ZTogcmV0dXJuIFNWX1RydWVcblx0XHRcdGNhc2UgS1dfVW5kZWZpbmVkOiByZXR1cm4gU1ZfVW5kZWZpbmVkXG5cdFx0XHRkZWZhdWx0OiByZXR1cm4gbnVsbFxuXHRcdH1cblx0fVxuXG5leHBvcnQgY29uc3Rcblx0Q2FsbE9uRm9jdXMgPSB0dCgnQ2FsbE9uRm9jdXMnLCBbICduYW1lJywgU3RyaW5nIF0pLFxuXHREb3ROYW1lID0gdHQoJ0RvdE5hbWUnLCBbICduRG90cycsIE51bWJlciwgJ25hbWUnLCBTdHJpbmcgXSksXG5cdEdyb3VwID0gdHQoJ0dyb3VwJyxcblx0XHRbICd0b2tlbnMnLCBbVG9rZW5dLCAna2luZCcsIE51bWJlciBdLFxuXHRcdHtcblx0XHRcdGlzQmxvY2s6IGdJcyhHX0Jsb2NrKSxcblx0XHRcdGlzU3BhY2VkOiBnSXMoR19TcGFjZSlcblx0XHR9KSxcblx0S2V5d29yZCA9IHR0KCdLZXl3b3JkJywgWyAna2luZCcsIE51bWJlciBdLFxuXHRcdHtcblx0XHRcdGlzOiBrd0lzLFxuXHRcdFx0aXNUeXBlOiBrd0lzKEtXX1R5cGUpLFxuXHRcdFx0aXNGb2N1czoga3dJcyhLV19Gb2N1cyksXG5cdFx0XHRpc0Vsc2U6IGt3SXMoS1dfRWxzZSksXG5cdFx0XHRpc0xhenk6IGt3SXMoS1dfTGF6eSksXG5cdFx0XHRpc0xpbmVTcGxpdDogdCA9PlxuXHRcdFx0XHR0IGluc3RhbmNlb2YgS2V5d29yZCAmJiAoXG5cdFx0XHRcdFx0dC5raW5kID09PSBLV19Bc3NpZ24gfHxcblx0XHRcdFx0XHR0LmtpbmQgPT09IEtXX09iakFzc2lnbiB8fFxuXHRcdFx0XHRcdHQua2luZCA9PT0gS1dfWWllbGQgfHxcblx0XHRcdFx0XHR0LmtpbmQgPT09IEtXX1lpZWxkVG8gfHxcblx0XHRcdFx0XHR0LmtpbmQgPT09IEtXX01hcEVudHJ5KSxcblx0XHRcdGlzT2JqQXNzaWduOiBrd0lzKEtXX09iakFzc2lnbilcblx0XHR9KSxcblx0TmFtZSA9IHR0KCdOYW1lJywgWyAnbmFtZScsIFN0cmluZyBdKSxcblx0VG9rZW5OdW1iZXJMaXRlcmFsID0gdHQoJ1Rva2VuTnVtYmVyTGl0ZXJhbCcsIFsgJ3ZhbHVlJywgTnVtYmVyIF0pXG5cbi8vIHRvU3RyaW5nIGlzIHVzZWQgYnkgc29tZSBwYXJzaW5nIGVycm9ycy4gVXNlIFUuaW5zcGVjdCBmb3IgYSBtb3JlIGRldGFpbGVkIHZpZXcuXG5pbXBsZW1lbnRNYW55KHsgQ2FsbE9uRm9jdXMsIERvdE5hbWUsIEdyb3VwLCBLZXl3b3JkLCBOYW1lLCBUb2tlbk51bWJlckxpdGVyYWwgfSwgJ3Nob3cnLCB7XG5cdENhbGxPbkZvY3VzKCkgeyByZXR1cm4gYCR7dGhpcy5uYW1lfV9gIH0sXG5cdERvdE5hbWUoKSB7IHJldHVybiBgJHsnLicucmVwZWF0KHRoaXMubkRvdHMpfSR7dGhpcy5uYW1lfWAgfSxcblx0Ly8gVE9ETzogYmV0dGVyIHJlcHJlc2VudGF0aW9uIG9mIGtcblx0R3JvdXAoKSB7IHJldHVybiBgZ3JvdXAoaz0ke3RoaXMua2luZH0pYCB9LFxuXHQvLyBUT0RPOiBiZXR0ZXIgcmVwcmVzZW50YXRpb24gb2Yga1xuXHRLZXl3b3JkKCkgeyByZXR1cm4gYGtleXdvcmQoaz0ke2tUb05hbWUuZ2V0KHRoaXMua2luZCl9KWAgfSxcblx0TmFtZSgpIHsgcmV0dXJuIHRoaXMubmFtZSB9LFxuXHRUb2tlbk51bWJlckxpdGVyYWwoKSB7IHJldHVybiB0aGlzLnZhbHVlIH1cbn0pXG4iXSwic291cmNlUm9vdCI6Ii9zcmMifQ==