{"version":3,"sources":["meta/compile/private/parse/parseSingle.js"],"names":[],"mappings":"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","file":"meta/compile/private/parse/parseSingle.js","sourcesContent":["import { Call, ListSimple, ELiteral, GlobalAccess,\n\tLocalAccess, Quote, Special, Splat } from '../../Expression'\nimport { CallOnFocus, DotName, Group, Keyword, Literal, Name } from '../Token'\nimport { JsGlobals, SpecialKeywords } from '../Lang'\nimport type from '../U/type'\nimport { assert } from '../U/util'\nimport Px from './Px'\n// TODO:ES6\nimport * as PB from './parseBlock'\nimport * as ParseExpr from './parseExpr'\nimport * as PS from './parseSpaced'\n\nexport default function parseSingle(px) {\n\ttype(px, Px)\n\tconst t = px.tokens.head()\n\tassert(px.tokens.size() === 1)\n\tswitch (true) {\n\t\tcase t instanceof CallOnFocus:\n\t\t\treturn Call(px.loc, access(px, t.name), [ LocalAccess.focus(px.loc) ])\n\t\tcase t instanceof Literal:\n\t\t\treturn ELiteral(t.loc, t.value, t.k)\n\t\tcase t instanceof Name:\n\t\t\treturn access(px, t.name)\n\t\tcase t instanceof Keyword:\n\t\t\tif (t.k === '_')\n\t\t\t\treturn LocalAccess.focus(px.loc)\n\t\t\tif (SpecialKeywords.has(t.k))\n\t\t\t\treturn Special(px.loc, t.k)\n\t\t\t// Else fallthrough to fail\n\t\tcase t instanceof Group:\n\t\t\tswitch (t.k) {\n\t\t\t\tcase 'sp': return px.w(t.tokens, PS.parseSpaced)\n\t\t\t\tcase '->': return px.w(t.tokens, PB.blockWrap, 'val')\n\t\t\t\tcase '\"': return Quote(px.loc, t.tokens.map(tSub => px.wt(tSub, parseSingle)))\n\t\t\t\tcase '(': return px.w(t.tokens, ParseExpr.default)\n\t\t\t\tcase '[': return ListSimple(px.loc, px.w(t.tokens, ParseExpr.parseExprParts))\n\t\t\t\tdefault:\n\t\t\t\t\t// fallthrough\n\t\t\t}\n\t\tcase t instanceof DotName:\n\t\t\tif (t.nDots === 3)\n\t\t\t\treturn Splat(px.loc, LocalAccess(px.loc, t.name))\n\t\t\t// Else fallthrough to fail\n\t\tdefault:\n\t\t\tpx.fail(`Unexpected ${t}`)\n\t}\n}\n\nconst access = (px, name) =>\n\tJsGlobals.has(name) ? GlobalAccess(px.loc, name) : LocalAccess(px.loc, name)\n"],"sourceRoot":"/src"}