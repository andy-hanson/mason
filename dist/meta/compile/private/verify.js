if (typeof define !== 'function') var define = require('amdefine')(module);define(['exports', 'module', '../CompileError', '../Expression', './U/Bag', './U/Op', './U/util', './Vr'], function (exports, module, _CompileError, _Expression, _UBag, _UOp, _UUtil, _Vr) {
	'use strict';

	module.exports = verify;

	function _interopRequire(obj) { return obj && obj.__esModule ? obj['default'] : obj; }

	function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) arr2[i] = arr[i]; return arr2; } else { return Array.from(arr); } }

	var _Vr2 = _interopRequire(_Vr);

	const vm = function (es) {
		return es.forEach(function (e) {
			return e.verify();
		});
	};

	let cx, locals,
	// Locals for this block.
	// Replaces `locals` when entering into sub-function.
	pendingBlockLocals, isInDebug, isInGenerator, opLoop, vr;

	const init = function (_cx) {
		cx = _cx;
		locals = new Map();
		pendingBlockLocals = [];
		isInDebug = false;
		isInGenerator = false;
		opLoop = [];
		vr = new _Vr2();
	},
	     
	// Release for garbage collection
	uninit = function () {
		locals = pendingBlockLocals = opLoop = vr = undefined;
	},
	      withInGenerator = function (_isInGenerator, fun) {
		const g = isInGenerator;
		isInGenerator = _isInGenerator;
		fun();
		isInGenerator = g;
	},
	      plusLocals = function (addedLocals, fun) {
		const shadowed = new Map();
		addedLocals.forEach(function (l) {
			const got = locals.get(l.name);
			if (got !== undefined) shadowed.set(l.name, got);
			locals.set(l.name, l);
		});
		fun();
		addedLocals.forEach(function (l) {
			const s = shadowed.get(l.name);
			if (s === undefined) locals.delete(l.name);else locals.set(l.name, s);
		});
	},
	      plusPendingBlockLocals = function (pending, fun) {
		const oldLength = pendingBlockLocals.length;
		pendingBlockLocals.push.apply(pendingBlockLocals, _toConsumableArray(pending));
		fun();
		while (pendingBlockLocals.length > oldLength) pendingBlockLocals.pop();
	},
	      withInLoop = function (loop, fun) {
		const l = opLoop;
		opLoop = _UOp.some(loop);
		fun();
		opLoop = l;
	},
	      withInDebug = function (_isInDebug, fun) {
		const d = isInDebug;
		isInDebug = _isInDebug;
		fun();
		isInDebug = d;
	},
	      withBlockLocals = function (fun) {
		const bl = pendingBlockLocals;
		pendingBlockLocals = [];
		plusLocals(bl, fun);
		pendingBlockLocals = bl;
	},
	     

	// Vr setters
	setEndLoop = function (endLoop, loop) {
		vr.endLoopToLoop.set(endLoop, loop);
	},
	      registerLocal = function (local) {
		vr.localToInfo.set(local, _Vr.VrLocalInfo(isInDebug, [], []));
	},
	      setEntryIndex = function (listMapEntry, index) {
		vr.entryToIndex.set(listMapEntry, index);
	},
	      setListMapLength = function (returner, length) {
		vr.returnToLength.set(returner, length);
	};

	function verify(cx, e) {
		init(cx);
		e.verify();
		verifyLocalUse();
		const out = vr;
		uninit();
		return out;
	}

	const verifyLocalUse = function () {
		vr.localToInfo.forEach(function (info, local) {
			const noNonDebug = _UBag.isEmpty(info.nonDebugAccesses);
			if (noNonDebug && _UBag.isEmpty(info.debugAccesses)) cx.warnIf(!local.okToNotUse, local.loc, function () {
				return 'Unused local variable ' + _CompileError.code(local.name) + '.';
			});else if (info.isInDebug) cx.warnIf(!noNonDebug, function () {
				return _UBag.head(info.nonDebugAccesses).loc;
			}, function () {
				return 'Debug-only local ' + _CompileError.code(local.name) + ' used outside of debug.';
			});else cx.warnIf(!local.okToNotUse && noNonDebug, local.loc, function () {
				return 'Local ' + _CompileError.code(local.name) + ' used only in debug.';
			});
		});
	};

	_UUtil.implementMany(_Expression, 'verify', {
		Assign: function () {
			var _this = this;

			const doV = function () {
				_this.assignee.verify();
				_this.value.verify();
			};
			if (this.assignee.isLazy) withBlockLocals(doV);else doV();
		},
		BlockDo: function () {
			verifyLines(this.lines);
		},
		BlockVal: function () {
			var _this2 = this;

			var _verifyLines = verifyLines(this.lines);

			const newLocals = _verifyLines.newLocals;
			const listMapLength = _verifyLines.listMapLength;

			if (this.returned instanceof _Expression.ListReturn || this.returned instanceof _Expression.MapReturn) setListMapLength(this.returned, listMapLength);else _UUtil.assert(listMapLength === 0);
			plusLocals(newLocals, function () {
				return _this2.returned.verify();
			});
		},
		BlockWrap: function () {
			this.block.verify();
		},
		CaseDo: verifyCase,
		CaseVal: verifyCase,
		// Only reach here for in/out condition
		Debug: function () {
			verifyLines([this]);
		},
		EndLoop: function () {
			var _this3 = this;

			_UOp.ifElse(opLoop, function (loop) {
				return setEndLoop(_this3, loop);
			}, function () {
				return cx.fail(_this3.loc, 'Not in a loop.');
			});
		},
		Fun: function () {
			var _this4 = this;

			withBlockLocals(function () {
				cx.check(_UBag.isEmpty(_this4.opResDeclare) || _this4.block instanceof _Expression.BlockVal, _this4.loc, 'Function with return condition must return something.');
				_this4.args.forEach(function (arg) {
					return vm(arg.opType);
				});
				withInGenerator(_this4.isGenerator, function () {
					const allArgs = _this4.args.concat(_this4.opRestArg);
					allArgs.forEach(function (_) {
						return registerLocal(_);
					});
					plusLocals(allArgs, function () {
						vm(_this4.opIn);
						_this4.block.verify();
						_this4.opResDeclare.forEach(function (rd) {
							rd.verify();
							registerLocal(rd);
						});
						_this4.opOut.forEach(function (o) {
							return plusLocals(_this4.opResDeclare, function () {
								return o.verify();
							});
						});
					});
				});
			});
		},
		LocalAccess: function () {
			const local = locals.get(this.name);
			if (local !== undefined) {
				vr.accessToLocal.set(this, local);
				const info = vr.localToInfo.get(local);
				const accesses = isInDebug ? info.debugAccesses : info.nonDebugAccesses;
				accesses.push(this);
			} else cx.fail(this.loc, 'Could not find local or global ' + _CompileError.code(this.name) + '.\n' + 'Available locals are:\n' + ('' + _CompileError.code(_UUtil.mapKeys(locals).join(' ')) + '.'));
		},
		Loop: function () {
			var _this5 = this;

			withInLoop(this, function () {
				return _this5.block.verify();
			});
		},
		// Adding LocalDeclares to the available locals is done by Fun or lineNewLocals.
		LocalDeclare: function () {
			vm(this.opType);
		},
		MapEntry: function () {
			this.key.verify();
			this.val.verify();
		},
		// TODO: Just have lines, not block.lines
		Module: function () {
			var _this6 = this;

			const useLocals = verifyUses(this.uses, this.debugUses);
			plusLocals(useLocals, function () {
				var _verifyLines2 = verifyLines(_this6.block.lines);

				const listMapLength = _verifyLines2.listMapLength;

				// If we are returning a list, the ModuleDefaultExport will be the last line.
				const ex = _UBag.last(_this6.block.lines);
				if (ex instanceof _Expression.ModuleDefaultExport) {
					const ret = ex.value;
					if (ret instanceof _Expression.ListReturn || ret instanceof _Expression.MapReturn) setListMapLength(ret, listMapLength);
				}
			});
		},
		Yield: function () {
			cx.check(isInGenerator, this.loc, 'Cannot yield outside of generator context');
			this.yielded.verify();
		},
		YieldTo: function () {
			cx.check(isInGenerator, this.loc, 'Cannot yield outside of generator context');
			this.yieldedTo.verify();
		},

		// These ones just recurse to their children.
		AssignDestructure: function () {
			this.value.verify();
			vm(this.assignees);
		},
		Call: function () {
			this.called.verify();
			vm(this.args);
		},
		CaseDoPart: verifyCasePart,
		CaseValPart: verifyCasePart,
		GlobalAccess: function () {},
		ObjReturn: function () {
			vm(this.opObjed);
		},
		ObjSimple: function () {
			const keys = new Set();
			this.pairs.forEach(function (pair) {
				cx.check(!keys.has(pair.key), pair.loc, function () {
					return 'Duplicate key ' + pair.key;
				});
				keys.add(pair.key);
				pair.value.verify();
			});
		},
		Lazy: function () {
			var _this7 = this;

			withBlockLocals(function () {
				return _this7.value.verify();
			});
		},
		ListReturn: function () {},
		ListEntry: function () {
			this.value.verify();
		},
		ListSimple: function () {
			vm(this.parts);
		},
		NumberLiteral: function () {},
		MapReturn: function () {},
		Member: function () {
			this.object.verify();
		},
		ModuleDefaultExport: function () {
			this.value.verify();
		},
		Quote: function () {
			this.parts.forEach(function (_) {
				if (typeof _ !== 'string') _.verify();
			});
		},
		Special: function () {},
		Splat: function () {
			this.splatted.verify();
		}
	});

	function verifyCase() {
		var _this8 = this;

		const newLocals = [];
		this.opCased.forEach(function (cased) {
			registerLocal(cased.assignee);
			cased.verify();
			newLocals.push(cased.assignee);
		});
		plusLocals(newLocals, function () {
			vm(_this8.parts);
			vm(_this8.opElse);
		});
	}

	function verifyCasePart() {
		var _this9 = this;

		if (this.test instanceof _Expression.Pattern) {
			this.test.type.verify();
			this.test.patterned.verify();
			vm(this.test.locals);
			this.test.locals.forEach(registerLocal);
			plusLocals(this.test.locals, function () {
				return _this9.result.verify();
			});
		} else {
			this.test.verify();
			this.result.verify();
		}
	}

	const verifyUses = function (uses, debugUses) {
		const useLocals = [];
		const verifyUse = function (use) {
			use.used.forEach(useLocal);
			use.opUseDefault.forEach(useLocal);
		},
		      useLocal = function (_) {
			registerLocal(_);
			useLocals.push(_);
		};
		uses.forEach(function (use) {
			if (!(use instanceof _Expression.UseDo)) verifyUse(use);
		});
		withInDebug(true, function () {
			return debugUses.forEach(verifyUse);
		});
		return useLocals;
	},
	      verifyLines = function (lines) {
		const newLocals = [];
		// First, get locals for the whole block.
		const getLineLocals = function (line) {
			if (line instanceof _Expression.Debug) withInDebug(true, function () {
				return line.lines.forEach(getLineLocals);
			});else {
				const news = lineNewLocals(line);
				news.forEach(registerLocal);
				newLocals.push.apply(newLocals, _toConsumableArray(news));
			}
		};

		lines.forEach(getLineLocals);

		const thisBlockLocalNames = new Set();
		const shadowed = new Map();

		let listMapLength = 0;

		const verifyLine = function (line) {
			if (line instanceof _Expression.Debug)
				// TODO: Do anything in this situation?
				// cx.check(!inDebug, line.loc, 'Redundant `debug`.')
				withInDebug(true, function () {
					return line.lines.forEach(verifyLine);
				});else {
				verifyIsStatement(line);
				lineNewLocals(line).forEach(function (l) {
					const got = locals.get(l.name);
					if (got !== undefined) {
						cx.check(!thisBlockLocalNames.has(l.name), l.loc, function () {
							return 'A local ' + _CompileError.code(l.name) + ' is already in this block.';
						});
						shadowed.set(l.name, got);
					}
					locals.set(l.name, l);
					thisBlockLocalNames.add(l.name);
				});
				if (line instanceof _Expression.ListEntry || line instanceof _Expression.MapEntry) {
					setEntryIndex(line, listMapLength);
					listMapLength = listMapLength + 1;
				}
				line.verify();
			}
		};

		plusPendingBlockLocals(newLocals, function () {
			return lines.forEach(verifyLine);
		});

		newLocals.forEach(function (l) {
			const s = shadowed.get(l.name);
			if (s === undefined) locals.delete(l.name);else locals.set(l.name, s);
		});

		return { newLocals: newLocals, listMapLength: listMapLength };
	},
	      verifyIsStatement = function (line) {
		switch (true) {
			case line instanceof _Expression.Do:
			// Some Vals are also conceptually Dos, but this was easier than multiple inheritance.
			case line instanceof _Expression.Call:
			case line instanceof _Expression.Yield:
			case line instanceof _Expression.YieldTo:
			case line instanceof _Expression.Special && line.k === 'debugger':
			// OK, used to mean `pass`
			case line instanceof _Expression.GlobalAccess && line.name === 'null':
				return;
			default:
				cx.fail(line.loc, 'Expression in statement position.');
		}
	},
	      lineNewLocals = function (line) {
		return line instanceof _Expression.Assign ? [line.assignee] : line instanceof _Expression.AssignDestructure ? line.assignees : [];
	};
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1ldGEvY29tcGlsZS9wcml2YXRlL3ZlcmlmeS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7a0JBNEd3QixNQUFNOzs7Ozs7OztBQWxHOUIsT0FBTSxFQUFFLEdBQUcsVUFBQSxFQUFFO1NBQUksRUFBRSxDQUFDLE9BQU8sQ0FBQyxVQUFBLENBQUM7VUFBSSxDQUFDLENBQUMsTUFBTSxFQUFFO0dBQUEsQ0FBQztFQUFBLENBQUE7O0FBRTVDLEtBQ0MsRUFBRSxFQUNGLE1BQU07OztBQUdOLG1CQUFrQixFQUNsQixTQUFTLEVBQ1QsYUFBYSxFQUNiLE1BQU0sRUFDTixFQUFFLENBQUE7O0FBRUgsT0FDQyxJQUFJLEdBQUcsVUFBQSxHQUFHLEVBQUk7QUFDYixJQUFFLEdBQUcsR0FBRyxDQUFBO0FBQ1IsUUFBTSxHQUFHLElBQUksR0FBRyxFQUFFLENBQUE7QUFDbEIsb0JBQWtCLEdBQUcsRUFBRSxDQUFBO0FBQ3ZCLFdBQVMsR0FBRyxLQUFLLENBQUE7QUFDakIsZUFBYSxHQUFHLEtBQUssQ0FBQTtBQUNyQixRQUFNLEdBQUcsRUFBRSxDQUFBO0FBQ1gsSUFBRSxHQUFHLFVBQVEsQ0FBQTtFQUNiOzs7QUFFRCxPQUFNLEdBQUcsWUFBTTtBQUNkLFFBQU0sR0FBRyxrQkFBa0IsR0FBRyxNQUFNLEdBQUcsRUFBRSxHQUFHLFNBQVMsQ0FBQTtFQUNyRDtPQUVELGVBQWUsR0FBRyxVQUFDLGNBQWMsRUFBRSxHQUFHLEVBQUs7QUFDMUMsUUFBTSxDQUFDLEdBQUcsYUFBYSxDQUFBO0FBQ3ZCLGVBQWEsR0FBRyxjQUFjLENBQUE7QUFDOUIsS0FBRyxFQUFFLENBQUE7QUFDTCxlQUFhLEdBQUcsQ0FBQyxDQUFBO0VBQ2pCO09BRUQsVUFBVSxHQUFHLFVBQUMsV0FBVyxFQUFFLEdBQUcsRUFBSztBQUNsQyxRQUFNLFFBQVEsR0FBRyxJQUFJLEdBQUcsRUFBRSxDQUFBO0FBQzFCLGFBQVcsQ0FBQyxPQUFPLENBQUMsVUFBQSxDQUFDLEVBQUk7QUFDeEIsU0FB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O0FBQ1gsUUFBSyxJQUFJLHdCQWpYK0MsRUFBRSxBQWlYbkMsQ0FBQzs7QUFFeEIsUUFBSyxJQUFJLHdCQW5Ya0MsSUFBSSxBQW1YdEIsQ0FBQztBQUMxQixRQUFLLElBQUksd0JBbFhtQyxLQUFLLEFBa1h2QixDQUFDO0FBQzNCLFFBQUssSUFBSSx3QkFuWDBDLE9BQU8sQUFtWDlCLENBQUM7QUFDN0IsUUFBSyxJQUFJLHdCQXBYbUIsT0FBTyxBQW9YUCxJQUFJLElBQUksQ0FBQyxDQUFDLEtBQUssVUFBVSxDQUFDOztBQUV0RCxRQUFLLElBQUksd0JBeFhtRCxZQUFZLEFBd1h2QyxJQUFJLElBQUksQ0FBQyxJQUFJLEtBQUssTUFBTTtBQUN4RCxXQUFNO0FBQUEsQUFDUDtBQUNDLE1BQUUsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEdBQUcsRUFBRSxtQ0FBbUMsQ0FBQyxDQUFBO0FBQUEsR0FDdkQ7RUFDRDtPQUVELGFBQWEsR0FBRyxVQUFBLElBQUk7U0FDbkIsSUFBSSx3QkFoWUcsTUFBTSxBQWdZUyxHQUNyQixDQUFFLElBQUksQ0FBQyxRQUFRLENBQUUsR0FDakIsSUFBSSx3QkFsWVUsaUJBQWlCLEFBa1lFLEdBQ2pDLElBQUksQ0FBQyxTQUFTLEdBQ2QsRUFBRztFQUFBLENBQUEiLCJmaWxlIjoibWV0YS9jb21waWxlL3ByaXZhdGUvdmVyaWZ5LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY29kZSB9IGZyb20gJy4uL0NvbXBpbGVFcnJvcidcbmltcG9ydCAqIGFzIEVFeHBvcnRzIGZyb20gJy4uL0V4cHJlc3Npb24nXG5pbXBvcnQgeyBBc3NpZ24sIEFzc2lnbkRlc3RydWN0dXJlLCBCbG9ja1ZhbCwgQ2FsbCwgRGVidWcsIERvLCBHbG9iYWxBY2Nlc3MsXG5cdExpc3RFbnRyeSwgTGlzdFJldHVybiwgTWFwRW50cnksIE1hcFJldHVybixcblx0TW9kdWxlRGVmYXVsdEV4cG9ydCwgUGF0dGVybiwgU3BlY2lhbCwgVXNlRG8sIFlpZWxkLCBZaWVsZFRvIH0gZnJvbSAnLi4vRXhwcmVzc2lvbidcbmltcG9ydCB7IGhlYWQsIGlzRW1wdHksIGxhc3QgfSBmcm9tICcuL1UvQmFnJ1xuaW1wb3J0IHsgaWZFbHNlLCBzb21lIH0gZnJvbSAnLi9VL09wJ1xuaW1wb3J0IHsgYXNzZXJ0LCBpbXBsZW1lbnRNYW55LCBtYXBLZXlzIH0gZnJvbSAnLi9VL3V0aWwnXG5pbXBvcnQgVnIsIHsgVnJMb2NhbEluZm8gfSBmcm9tICcuL1ZyJ1xuXG5jb25zdCB2bSA9IGVzID0+IGVzLmZvckVhY2goZSA9PiBlLnZlcmlmeSgpKVxuXG5sZXRcblx0Y3gsXG5cdGxvY2Fscyxcblx0Ly8gTG9jYWxzIGZvciB0aGlzIGJsb2NrLlxuXHQvLyBSZXBsYWNlcyBgbG9jYWxzYCB3aGVuIGVudGVyaW5nIGludG8gc3ViLWZ1bmN0aW9uLlxuXHRwZW5kaW5nQmxvY2tMb2NhbHMsXG5cdGlzSW5EZWJ1Zyxcblx0aXNJbkdlbmVyYXRvcixcblx0b3BMb29wLFxuXHR2clxuXG5jb25zdFxuXHRpbml0ID0gX2N4ID0+IHtcblx0XHRjeCA9IF9jeFxuXHRcdGxvY2FscyA9IG5ldyBNYXAoKVxuXHRcdHBlbmRpbmdCbG9ja0xvY2FscyA9IFtdXG5cdFx0aXNJbkRlYnVnID0gZmFsc2Vcblx0XHRpc0luR2VuZXJhdG9yID0gZmFsc2Vcblx0XHRvcExvb3AgPSBbXVxuXHRcdHZyID0gbmV3IFZyKClcblx0fSxcblx0Ly8gUmVsZWFzZSBmb3IgZ2FyYmFnZSBjb2xsZWN0aW9uXG5cdHVuaW5pdCA9ICgpID0+IHtcblx0XHRsb2NhbHMgPSBwZW5kaW5nQmxvY2tMb2NhbHMgPSBvcExvb3AgPSB2ciA9IHVuZGVmaW5lZFxuXHR9LFxuXG5cdHdpdGhJbkdlbmVyYXRvciA9IChfaXNJbkdlbmVyYXRvciwgZnVuKSA9PiB7XG5cdFx0Y29uc3QgZyA9IGlzSW5HZW5lcmF0b3Jcblx0XHRpc0luR2VuZXJhdG9yID0gX2lzSW5HZW5lcmF0b3Jcblx0XHRmdW4oKVxuXHRcdGlzSW5HZW5lcmF0b3IgPSBnXG5cdH0sXG5cblx0cGx1c0xvY2FscyA9IChhZGRlZExvY2FscywgZnVuKSA9PiB7XG5cdFx0Y29uc3Qgc2hhZG93ZWQgPSBuZXcgTWFwKClcblx0XHRhZGRlZExvY2Fscy5mb3JFYWNoKGwgPT4ge1xuXHRcdFx0Y29uc3QgZ290ID0gbG9jYWxzLmdldChsLm5hbWUpXG5cdFx0XHRpZiAoZ290ICE9PSB1bmRlZmluZWQpXG5cdFx0XHRcdHNoYWRvd2VkLnNldChsLm5hbWUsIGdvdClcblx0XHRcdGxvY2Fscy5zZXQobC5uYW1lLCBsKVxuXHRcdH0pXG5cdFx0ZnVuKClcblx0XHRhZGRlZExvY2Fscy5mb3JFYWNoKGwgPT4ge1xuXHRcdFx0Y29uc3QgcyA9IHNoYWRvd2VkLmdldChsLm5hbWUpXG5cdFx0XHRpZiAocyA9PT0gdW5kZWZpbmVkKVxuXHRcdFx0XHRsb2NhbHMuZGVsZXRlKGwubmFtZSlcblx0XHRcdGVsc2Vcblx0XHRcdFx0bG9jYWxzLnNldChsLm5hbWUsIHMpXG5cdFx0fSlcblx0fSxcblxuXHRwbHVzUGVuZGluZ0Jsb2NrTG9jYWxzID0gKHBlbmRpbmcsIGZ1bikgPT4ge1xuXHRcdGNvbnN0IG9sZExlbmd0aCA9IHBlbmRpbmdCbG9ja0xvY2Fscy5sZW5ndGhcblx0XHRwZW5kaW5nQmxvY2tMb2NhbHMucHVzaCguLi5wZW5kaW5nKVxuXHRcdGZ1bigpXG5cdFx0d2hpbGUgKHBlbmRpbmdCbG9ja0xvY2Fscy5sZW5ndGggPiBvbGRMZW5ndGgpXG5cdFx0XHRwZW5kaW5nQmxvY2tMb2NhbHMucG9wKClcblx0fSxcblxuXHR3aXRoSW5Mb29wID0gKGxvb3AsIGZ1bikgPT4ge1xuXHRcdGNvbnN0IGwgPSBvcExvb3Bcblx0XHRvcExvb3AgPSBzb21lKGxvb3ApXG5cdFx0ZnVuKClcblx0XHRvcExvb3AgPSBsXG5cdH0sXG5cblx0d2l0aEluRGVidWcgPSAoX2lzSW5EZWJ1ZywgZnVuKSA9PiB7XG5cdFx0Y29uc3QgZCA9IGlzSW5EZWJ1Z1xuXHRcdGlzSW5EZWJ1ZyA9IF9pc0luRGVidWdcblx0XHRmdW4oKVxuXHRcdGlzSW5EZWJ1ZyA9IGRcblx0fSxcblxuXHR3aXRoQmxvY2tMb2NhbHMgPSBmdW4gPT4ge1xuXHRcdGNvbnN0IGJsID0gcGVuZGluZ0Jsb2NrTG9jYWxzXG5cdFx0cGVuZGluZ0Jsb2NrTG9jYWxzID0gW11cblx0XHRwbHVzTG9jYWxzKGJsLCBmdW4pXG5cdFx0cGVuZGluZ0Jsb2NrTG9jYWxzID0gYmxcblx0fSxcblxuXHQvLyBWciBzZXR0ZXJzXG5cdHNldEVuZExvb3AgPSAoZW5kTG9vcCwgbG9vcCkgPT4ge1xuXHRcdHZyLmVuZExvb3BUb0xvb3Auc2V0KGVuZExvb3AsIGxvb3ApXG5cdH0sXG5cblx0cmVnaXN0ZXJMb2NhbCA9IGxvY2FsID0+IHtcblx0XHR2ci5sb2NhbFRvSW5mby5zZXQobG9jYWwsIFZyTG9jYWxJbmZvKFx0aXNJbkRlYnVnLCBbXSwgW10pKVxuXHR9LFxuXG5cdHNldEVudHJ5SW5kZXggPSAobGlzdE1hcEVudHJ5LCBpbmRleCkgPT4ge1xuXHRcdHZyLmVudHJ5VG9JbmRleC5zZXQobGlzdE1hcEVudHJ5LCBpbmRleClcblx0fSxcblx0c2V0TGlzdE1hcExlbmd0aCA9IChyZXR1cm5lciwgbGVuZ3RoKSA9PiB7XG5cdFx0dnIucmV0dXJuVG9MZW5ndGguc2V0KHJldHVybmVyLCBsZW5ndGgpXG5cdH1cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gdmVyaWZ5KGN4LCBlKSB7XG5cdGluaXQoY3gpXG5cdGUudmVyaWZ5KClcblx0dmVyaWZ5TG9jYWxVc2UoKVxuXHRjb25zdCBvdXQgPSB2clxuXHR1bmluaXQoKVxuXHRyZXR1cm4gb3V0XG59XG5cbmNvbnN0IHZlcmlmeUxvY2FsVXNlID0gKCkgPT4ge1xuXHR2ci5sb2NhbFRvSW5mby5mb3JFYWNoKChpbmZvLCBsb2NhbCkgPT4ge1xuXHRcdGNvbnN0IG5vTm9uRGVidWcgPSBpc0VtcHR5KGluZm8ubm9uRGVidWdBY2Nlc3Nlcylcblx0XHRpZiAobm9Ob25EZWJ1ZyAmJiBpc0VtcHR5KGluZm8uZGVidWdBY2Nlc3NlcykpXG5cdFx0XHRjeC53YXJuSWYoIWxvY2FsLm9rVG9Ob3RVc2UsIGxvY2FsLmxvYywgKCkgPT5cblx0XHRcdFx0YFVudXNlZCBsb2NhbCB2YXJpYWJsZSAke2NvZGUobG9jYWwubmFtZSl9LmApXG5cdFx0ZWxzZSBpZiAoaW5mby5pc0luRGVidWcpXG5cdFx0XHRjeC53YXJuSWYoIW5vTm9uRGVidWcsICgpID0+IGhlYWQoaW5mby5ub25EZWJ1Z0FjY2Vzc2VzKS5sb2MsICgpID0+XG5cdFx0XHRcdGBEZWJ1Zy1vbmx5IGxvY2FsICR7Y29kZShsb2NhbC5uYW1lKX0gdXNlZCBvdXRzaWRlIG9mIGRlYnVnLmApXG5cdFx0ZWxzZVxuXHRcdFx0Y3gud2FybklmKCFsb2NhbC5va1RvTm90VXNlICYmIG5vTm9uRGVidWcsIGxvY2FsLmxvYywgKCkgPT5cblx0XHRcdFx0YExvY2FsICR7Y29kZShsb2NhbC5uYW1lKX0gdXNlZCBvbmx5IGluIGRlYnVnLmApXG5cdH0pXG59XG5cbmltcGxlbWVudE1hbnkoRUV4cG9ydHMsICd2ZXJpZnknLCB7XG5cdEFzc2lnbigpIHtcblx0XHRjb25zdCBkb1YgPSAoKSA9PiB7XG5cdFx0XHR0aGlzLmFzc2lnbmVlLnZlcmlmeSgpXG5cdFx0XHR0aGlzLnZhbHVlLnZlcmlmeSgpXG5cdFx0fVxuXHRcdGlmICh0aGlzLmFzc2lnbmVlLmlzTGF6eSlcblx0XHRcdHdpdGhCbG9ja0xvY2Fscyhkb1YpXG5cdFx0ZWxzZVxuXHRcdFx0ZG9WKClcblx0fSxcblx0QmxvY2tEbygpIHsgdmVyaWZ5TGluZXModGhpcy5saW5lcykgfSxcblx0QmxvY2tWYWwoKSB7XG5cdFx0Y29uc3QgeyBuZXdMb2NhbHMsIGxpc3RNYXBMZW5ndGggfSA9IHZlcmlmeUxpbmVzKHRoaXMubGluZXMpXG5cdFx0aWYgKHRoaXMucmV0dXJuZWQgaW5zdGFuY2VvZiBMaXN0UmV0dXJuIHx8IHRoaXMucmV0dXJuZWQgaW5zdGFuY2VvZiBNYXBSZXR1cm4pXG5cdFx0XHRzZXRMaXN0TWFwTGVuZ3RoKHRoaXMucmV0dXJuZWQsIGxpc3RNYXBMZW5ndGgpXG5cdFx0ZWxzZVxuXHRcdFx0YXNzZXJ0KGxpc3RNYXBMZW5ndGggPT09IDApXG5cdFx0cGx1c0xvY2FscyhuZXdMb2NhbHMsICgpID0+IHRoaXMucmV0dXJuZWQudmVyaWZ5KCkpXG5cdH0sXG5cdEJsb2NrV3JhcCgpIHtcblx0XHR0aGlzLmJsb2NrLnZlcmlmeSgpXG5cdH0sXG5cdENhc2VEbzogdmVyaWZ5Q2FzZSxcblx0Q2FzZVZhbDogdmVyaWZ5Q2FzZSxcblx0Ly8gT25seSByZWFjaCBoZXJlIGZvciBpbi9vdXQgY29uZGl0aW9uXG5cdERlYnVnKCkgeyB2ZXJpZnlMaW5lcyhbIHRoaXMgXSkgfSxcblx0RW5kTG9vcCgpIHtcblx0XHRpZkVsc2Uob3BMb29wLFxuXHRcdFx0bG9vcCA9PiBzZXRFbmRMb29wKHRoaXMsIGxvb3ApLFxuXHRcdFx0KCkgPT4gY3guZmFpbCh0aGlzLmxvYywgJ05vdCBpbiBhIGxvb3AuJykpXG5cdH0sXG5cdEZ1bigpIHtcblx0XHR3aXRoQmxvY2tMb2NhbHMoKCkgPT4ge1xuXHRcdFx0Y3guY2hlY2soaXNFbXB0eSh0aGlzLm9wUmVzRGVjbGFyZSkgfHwgdGhpcy5ibG9jayBpbnN0YW5jZW9mIEJsb2NrVmFsLCB0aGlzLmxvYyxcblx0XHRcdFx0J0Z1bmN0aW9uIHdpdGggcmV0dXJuIGNvbmRpdGlvbiBtdXN0IHJldHVybiBzb21ldGhpbmcuJylcblx0XHRcdHRoaXMuYXJncy5mb3JFYWNoKGFyZyA9PiB2bShhcmcub3BUeXBlKSlcblx0XHRcdHdpdGhJbkdlbmVyYXRvcih0aGlzLmlzR2VuZXJhdG9yLCAoKSA9PiB7XG5cdFx0XHRcdGNvbnN0IGFsbEFyZ3MgPSB0aGlzLmFyZ3MuY29uY2F0KHRoaXMub3BSZXN0QXJnKVxuXHRcdFx0XHRhbGxBcmdzLmZvckVhY2goXyA9PiByZWdpc3RlckxvY2FsKF8pKVxuXHRcdFx0XHRwbHVzTG9jYWxzKGFsbEFyZ3MsICgpID0+IHtcblx0XHRcdFx0XHR2bSh0aGlzLm9wSW4pXG5cdFx0XHRcdFx0dGhpcy5ibG9jay52ZXJpZnkoKVxuXHRcdFx0XHRcdHRoaXMub3BSZXNEZWNsYXJlLmZvckVhY2gocmQgPT4ge1xuXHRcdFx0XHRcdFx0cmQudmVyaWZ5KClcblx0XHRcdFx0XHRcdHJlZ2lzdGVyTG9jYWwocmQpXG5cdFx0XHRcdFx0fSlcblx0XHRcdFx0XHR0aGlzLm9wT3V0LmZvckVhY2gobyA9PiBwbHVzTG9jYWxzKHRoaXMub3BSZXNEZWNsYXJlLCAoKSA9PiBvLnZlcmlmeSgpKSlcblx0XHRcdFx0fSlcblx0XHRcdH0pXG5cdFx0fSlcblx0fSxcblx0TG9jYWxBY2Nlc3MoKSB7XG5cdFx0Y29uc3QgbG9jYWwgPSBsb2NhbHMuZ2V0KHRoaXMubmFtZSlcblx0XHRpZiAobG9jYWwgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0dnIuYWNjZXNzVG9Mb2NhbC5zZXQodGhpcywgbG9jYWwpXG5cdFx0XHRjb25zdCBpbmZvID0gdnIubG9jYWxUb0luZm8uZ2V0KGxvY2FsKVxuXHRcdFx0Y29uc3QgYWNjZXNzZXMgPSBpc0luRGVidWcgPyBpbmZvLmRlYnVnQWNjZXNzZXMgOiBpbmZvLm5vbkRlYnVnQWNjZXNzZXNcblx0XHRcdGFjY2Vzc2VzLnB1c2godGhpcylcblx0XHR9IGVsc2Vcblx0XHRcdGN4LmZhaWwodGhpcy5sb2MsXG5cdFx0XHRcdGBDb3VsZCBub3QgZmluZCBsb2NhbCBvciBnbG9iYWwgJHtjb2RlKHRoaXMubmFtZSl9LlxcbmAgK1xuXHRcdFx0XHQnQXZhaWxhYmxlIGxvY2FscyBhcmU6XFxuJyArXG5cdFx0XHRcdGAke2NvZGUobWFwS2V5cyhsb2NhbHMpLmpvaW4oJyAnKSl9LmApXG5cdH0sXG5cdExvb3AoKSB7IHdpdGhJbkxvb3AodGhpcywgKCkgPT4gdGhpcy5ibG9jay52ZXJpZnkoKSkgfSxcblx0Ly8gQWRkaW5nIExvY2FsRGVjbGFyZXMgdG8gdGhlIGF2YWlsYWJsZSBsb2NhbHMgaXMgZG9uZSBieSBGdW4gb3IgbGluZU5ld0xvY2Fscy5cblx0TG9jYWxEZWNsYXJlKCkgeyB2bSh0aGlzLm9wVHlwZSkgfSxcblx0TWFwRW50cnkoKSB7XG5cdFx0dGhpcy5rZXkudmVyaWZ5KClcblx0XHR0aGlzLnZhbC52ZXJpZnkoKVxuXHR9LFxuXHQvLyBUT0RPOiBKdXN0IGhhdmUgbGluZXMsIG5vdCBibG9jay5saW5lc1xuXHRNb2R1bGUoKSB7XG5cdFx0Y29uc3QgdXNlTG9jYWxzID0gdmVyaWZ5VXNlcyh0aGlzLnVzZXMsIHRoaXMuZGVidWdVc2VzKVxuXHRcdHBsdXNMb2NhbHModXNlTG9jYWxzLCAoKSA9PiB7XG5cdFx0XHRjb25zdCB7IGxpc3RNYXBMZW5ndGggfSA9IHZlcmlmeUxpbmVzKHRoaXMuYmxvY2subGluZXMpXG5cdFx0XHQvLyBJZiB3ZSBhcmUgcmV0dXJuaW5nIGEgbGlzdCwgdGhlIE1vZHVsZURlZmF1bHRFeHBvcnQgd2lsbCBiZSB0aGUgbGFzdCBsaW5lLlxuXHRcdFx0Y29uc3QgZXggPSBsYXN0KHRoaXMuYmxvY2subGluZXMpXG5cdFx0XHRpZiAoZXggaW5zdGFuY2VvZiBNb2R1bGVEZWZhdWx0RXhwb3J0KSB7XG5cdFx0XHRcdGNvbnN0IHJldCA9IGV4LnZhbHVlXG5cdFx0XHRcdGlmIChyZXQgaW5zdGFuY2VvZiBMaXN0UmV0dXJuIHx8IHJldCBpbnN0YW5jZW9mIE1hcFJldHVybilcblx0XHRcdFx0XHRzZXRMaXN0TWFwTGVuZ3RoKHJldCwgbGlzdE1hcExlbmd0aClcblx0XHRcdH1cblx0XHR9KVxuXHR9LFxuXHRZaWVsZCgpIHtcblx0XHRjeC5jaGVjayhpc0luR2VuZXJhdG9yLCB0aGlzLmxvYywgJ0Nhbm5vdCB5aWVsZCBvdXRzaWRlIG9mIGdlbmVyYXRvciBjb250ZXh0Jylcblx0XHR0aGlzLnlpZWxkZWQudmVyaWZ5KClcblx0fSxcblx0WWllbGRUbygpIHtcblx0XHRjeC5jaGVjayhpc0luR2VuZXJhdG9yLCB0aGlzLmxvYywgJ0Nhbm5vdCB5aWVsZCBvdXRzaWRlIG9mIGdlbmVyYXRvciBjb250ZXh0Jylcblx0XHR0aGlzLnlpZWxkZWRUby52ZXJpZnkoKVxuXHR9LFxuXG5cdC8vIFRoZXNlIG9uZXMganVzdCByZWN1cnNlIHRvIHRoZWlyIGNoaWxkcmVuLlxuXHRBc3NpZ25EZXN0cnVjdHVyZSgpIHtcblx0XHR0aGlzLnZhbHVlLnZlcmlmeSgpXG5cdFx0dm0odGhpcy5hc3NpZ25lZXMpXG5cdH0sXG5cdENhbGwoKSB7XG5cdFx0dGhpcy5jYWxsZWQudmVyaWZ5KClcblx0XHR2bSh0aGlzLmFyZ3MpXG5cdH0sXG5cdENhc2VEb1BhcnQ6IHZlcmlmeUNhc2VQYXJ0LFxuXHRDYXNlVmFsUGFydDogdmVyaWZ5Q2FzZVBhcnQsXG5cdEdsb2JhbEFjY2VzcygpIHsgfSxcblx0T2JqUmV0dXJuKCkgeyB2bSh0aGlzLm9wT2JqZWQpIH0sXG5cdE9ialNpbXBsZSgpIHtcblx0XHRjb25zdCBrZXlzID0gbmV3IFNldCgpXG5cdFx0dGhpcy5wYWlycy5mb3JFYWNoKHBhaXIgPT4ge1xuXHRcdFx0Y3guY2hlY2soIWtleXMuaGFzKHBhaXIua2V5KSwgcGFpci5sb2MsICgpID0+IGBEdXBsaWNhdGUga2V5ICR7cGFpci5rZXl9YClcblx0XHRcdGtleXMuYWRkKHBhaXIua2V5KVxuXHRcdFx0cGFpci52YWx1ZS52ZXJpZnkoKVxuXHRcdH0pXG5cdH0sXG5cdExhenkoKSB7IHdpdGhCbG9ja0xvY2FscygoKSA9PiB0aGlzLnZhbHVlLnZlcmlmeSgpKSB9LFxuXHRMaXN0UmV0dXJuKCkgeyB9LFxuXHRMaXN0RW50cnkoKSB7IHRoaXMudmFsdWUudmVyaWZ5KCkgfSxcblx0TGlzdFNpbXBsZSgpIHsgdm0odGhpcy5wYXJ0cykgfSxcblx0TnVtYmVyTGl0ZXJhbCgpIHsgfSxcblx0TWFwUmV0dXJuKCkgeyB9LFxuXHRNZW1iZXIoKSB7IHRoaXMub2JqZWN0LnZlcmlmeSgpIH0sXG5cdE1vZHVsZURlZmF1bHRFeHBvcnQoKSB7IHRoaXMudmFsdWUudmVyaWZ5KCkgfSxcblx0UXVvdGUoKSB7XG5cdFx0dGhpcy5wYXJ0cy5mb3JFYWNoKF8gPT4ge1xuXHRcdFx0aWYgKHR5cGVvZiBfICE9PSAnc3RyaW5nJylcblx0XHRcdFx0Xy52ZXJpZnkoKVxuXHRcdH0pXG5cdH0sXG5cdFNwZWNpYWwoKSB7IH0sXG5cdFNwbGF0KCkgeyB0aGlzLnNwbGF0dGVkLnZlcmlmeSgpIH1cbn0pXG5cbmZ1bmN0aW9uIHZlcmlmeUNhc2UoKSB7XG5cdGNvbnN0IG5ld0xvY2FscyA9IFtdXG5cdHRoaXMub3BDYXNlZC5mb3JFYWNoKGNhc2VkID0+IHtcblx0XHRyZWdpc3RlckxvY2FsKGNhc2VkLmFzc2lnbmVlKVxuXHRcdGNhc2VkLnZlcmlmeSgpXG5cdFx0bmV3TG9jYWxzLnB1c2goY2FzZWQuYXNzaWduZWUpXG5cdH0pXG5cdHBsdXNMb2NhbHMobmV3TG9jYWxzLCAoKSA9PiB7XG5cdFx0dm0odGhpcy5wYXJ0cylcblx0XHR2bSh0aGlzLm9wRWxzZSlcblx0fSlcbn1cblxuZnVuY3Rpb24gdmVyaWZ5Q2FzZVBhcnQoKSB7XG5cdGlmICh0aGlzLnRlc3QgaW5zdGFuY2VvZiBQYXR0ZXJuKSB7XG5cdFx0dGhpcy50ZXN0LnR5cGUudmVyaWZ5KClcblx0XHR0aGlzLnRlc3QucGF0dGVybmVkLnZlcmlmeSgpXG5cdFx0dm0odGhpcy50ZXN0LmxvY2Fscylcblx0XHR0aGlzLnRlc3QubG9jYWxzLmZvckVhY2gocmVnaXN0ZXJMb2NhbClcblx0XHRwbHVzTG9jYWxzKHRoaXMudGVzdC5sb2NhbHMsICgpID0+IHRoaXMucmVzdWx0LnZlcmlmeSgpKVxuXHR9IGVsc2Uge1xuXHRcdHRoaXMudGVzdC52ZXJpZnkoKVxuXHRcdHRoaXMucmVzdWx0LnZlcmlmeSgpXG5cdH1cbn1cblxuY29uc3Rcblx0dmVyaWZ5VXNlcyA9ICh1c2VzLCBkZWJ1Z1VzZXMpID0+IHtcblx0XHRjb25zdCB1c2VMb2NhbHMgPSBbXVxuXHRcdGNvbnN0XG5cdFx0XHR2ZXJpZnlVc2UgPSB1c2UgPT4ge1xuXHRcdFx0XHR1c2UudXNlZC5mb3JFYWNoKHVzZUxvY2FsKVxuXHRcdFx0XHR1c2Uub3BVc2VEZWZhdWx0LmZvckVhY2godXNlTG9jYWwpXG5cdFx0XHR9LFxuXHRcdFx0dXNlTG9jYWwgPSBfID0+IHtcblx0XHRcdFx0cmVnaXN0ZXJMb2NhbChfKVxuXHRcdFx0XHR1c2VMb2NhbHMucHVzaChfKVxuXHRcdFx0fVxuXHRcdHVzZXMuZm9yRWFjaCh1c2UgPT4ge1xuXHRcdFx0aWYgKCEodXNlIGluc3RhbmNlb2YgVXNlRG8pKSB2ZXJpZnlVc2UodXNlKVxuXHRcdH0pXG5cdFx0d2l0aEluRGVidWcodHJ1ZSwgKCkgPT4gZGVidWdVc2VzLmZvckVhY2godmVyaWZ5VXNlKSlcblx0XHRyZXR1cm4gdXNlTG9jYWxzXG5cdH0sXG5cblx0dmVyaWZ5TGluZXMgPSBsaW5lcyA9PiB7XG5cdFx0Y29uc3QgbmV3TG9jYWxzID0gWyBdXG5cdFx0Ly8gRmlyc3QsIGdldCBsb2NhbHMgZm9yIHRoZSB3aG9sZSBibG9jay5cblx0XHRjb25zdCBnZXRMaW5lTG9jYWxzID0gbGluZSA9PiB7XG5cdFx0XHRpZiAobGluZSBpbnN0YW5jZW9mIERlYnVnKVxuXHRcdFx0XHR3aXRoSW5EZWJ1Zyh0cnVlLCAoKSA9PiBsaW5lLmxpbmVzLmZvckVhY2goZ2V0TGluZUxvY2FscykpXG5cdFx0XHRlbHNlIHtcblx0XHRcdFx0Y29uc3QgbmV3cyA9IGxpbmVOZXdMb2NhbHMobGluZSlcblx0XHRcdFx0bmV3cy5mb3JFYWNoKHJlZ2lzdGVyTG9jYWwpXG5cdFx0XHRcdG5ld0xvY2Fscy5wdXNoKC4uLm5ld3MpXG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0bGluZXMuZm9yRWFjaChnZXRMaW5lTG9jYWxzKVxuXG5cdFx0Y29uc3QgdGhpc0Jsb2NrTG9jYWxOYW1lcyA9IG5ldyBTZXQoKVxuXHRcdGNvbnN0IHNoYWRvd2VkID0gbmV3IE1hcCgpXG5cblx0XHRsZXQgbGlzdE1hcExlbmd0aCA9IDBcblxuXHRcdGNvbnN0IHZlcmlmeUxpbmUgPSBsaW5lID0+IHtcblx0XHRcdGlmIChsaW5lIGluc3RhbmNlb2YgRGVidWcpXG5cdFx0XHRcdC8vIFRPRE86IERvIGFueXRoaW5nIGluIHRoaXMgc2l0dWF0aW9uP1xuXHRcdFx0XHQvLyBjeC5jaGVjayghaW5EZWJ1ZywgbGluZS5sb2MsICdSZWR1bmRhbnQgYGRlYnVnYC4nKVxuXHRcdFx0XHR3aXRoSW5EZWJ1Zyh0cnVlLCAoKSA9PiBsaW5lLmxpbmVzLmZvckVhY2godmVyaWZ5TGluZSkpXG5cdFx0XHRlbHNlIHtcblx0XHRcdFx0dmVyaWZ5SXNTdGF0ZW1lbnQobGluZSlcblx0XHRcdFx0bGluZU5ld0xvY2FscyhsaW5lKS5mb3JFYWNoKGwgPT4ge1xuXHRcdFx0XHRcdGNvbnN0IGdvdCA9IGxvY2Fscy5nZXQobC5uYW1lKVxuXHRcdFx0XHRcdGlmIChnb3QgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdFx0Y3guY2hlY2soIXRoaXNCbG9ja0xvY2FsTmFtZXMuaGFzKGwubmFtZSksIGwubG9jLFxuXHRcdFx0XHRcdFx0XHQoKSA9PiBgQSBsb2NhbCAke2NvZGUobC5uYW1lKX0gaXMgYWxyZWFkeSBpbiB0aGlzIGJsb2NrLmApXG5cdFx0XHRcdFx0XHRzaGFkb3dlZC5zZXQobC5uYW1lLCBnb3QpXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdGxvY2Fscy5zZXQobC5uYW1lLCBsKVxuXHRcdFx0XHRcdHRoaXNCbG9ja0xvY2FsTmFtZXMuYWRkKGwubmFtZSlcblx0XHRcdFx0fSlcblx0XHRcdFx0aWYgKGxpbmUgaW5zdGFuY2VvZiBMaXN0RW50cnkgfHwgbGluZSBpbnN0YW5jZW9mIE1hcEVudHJ5KSB7XG5cdFx0XHRcdFx0c2V0RW50cnlJbmRleChsaW5lLCBsaXN0TWFwTGVuZ3RoKVxuXHRcdFx0XHRcdGxpc3RNYXBMZW5ndGggPSBsaXN0TWFwTGVuZ3RoICsgMVxuXHRcdFx0XHR9XG5cdFx0XHRcdGxpbmUudmVyaWZ5KClcblx0XHRcdH1cblx0XHR9XG5cblx0XHRwbHVzUGVuZGluZ0Jsb2NrTG9jYWxzKG5ld0xvY2FscywgKCkgPT4gbGluZXMuZm9yRWFjaCh2ZXJpZnlMaW5lKSlcblxuXHRcdG5ld0xvY2Fscy5mb3JFYWNoKGwgPT4ge1xuXHRcdFx0Y29uc3QgcyA9IHNoYWRvd2VkLmdldChsLm5hbWUpXG5cdFx0XHRpZiAocyA9PT0gdW5kZWZpbmVkKVxuXHRcdFx0XHRsb2NhbHMuZGVsZXRlKGwubmFtZSlcblx0XHRcdGVsc2Vcblx0XHRcdFx0bG9jYWxzLnNldChsLm5hbWUsIHMpXG5cdFx0fSlcblxuXHRcdHJldHVybiB7IG5ld0xvY2FscywgbGlzdE1hcExlbmd0aCB9XG5cdH0sXG5cblx0dmVyaWZ5SXNTdGF0ZW1lbnQgPSBsaW5lID0+IHtcblx0XHRzd2l0Y2ggKHRydWUpIHtcblx0XHRcdGNhc2UgbGluZSBpbnN0YW5jZW9mIERvOlxuXHRcdFx0Ly8gU29tZSBWYWxzIGFyZSBhbHNvIGNvbmNlcHR1YWxseSBEb3MsIGJ1dCB0aGlzIHdhcyBlYXNpZXIgdGhhbiBtdWx0aXBsZSBpbmhlcml0YW5jZS5cblx0XHRcdGNhc2UgbGluZSBpbnN0YW5jZW9mIENhbGw6XG5cdFx0XHRjYXNlIGxpbmUgaW5zdGFuY2VvZiBZaWVsZDpcblx0XHRcdGNhc2UgbGluZSBpbnN0YW5jZW9mIFlpZWxkVG86XG5cdFx0XHRjYXNlIGxpbmUgaW5zdGFuY2VvZiBTcGVjaWFsICYmIGxpbmUuayA9PT0gJ2RlYnVnZ2VyJzpcblx0XHRcdC8vIE9LLCB1c2VkIHRvIG1lYW4gYHBhc3NgXG5cdFx0XHRjYXNlIGxpbmUgaW5zdGFuY2VvZiBHbG9iYWxBY2Nlc3MgJiYgbGluZS5uYW1lID09PSAnbnVsbCc6XG5cdFx0XHRcdHJldHVyblxuXHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0Y3guZmFpbChsaW5lLmxvYywgJ0V4cHJlc3Npb24gaW4gc3RhdGVtZW50IHBvc2l0aW9uLicpXG5cdFx0fVxuXHR9LFxuXG5cdGxpbmVOZXdMb2NhbHMgPSBsaW5lID0+XG5cdFx0bGluZSBpbnN0YW5jZW9mIEFzc2lnbiA/XG5cdFx0XHRbIGxpbmUuYXNzaWduZWUgXSA6XG5cdFx0XHRsaW5lIGluc3RhbmNlb2YgQXNzaWduRGVzdHJ1Y3R1cmUgP1xuXHRcdFx0bGluZS5hc3NpZ25lZXMgOlxuXHRcdFx0WyBdXG4iXSwic291cmNlUm9vdCI6Ii9zcmMifQ==