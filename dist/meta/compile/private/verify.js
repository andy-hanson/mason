if (typeof define !== 'function') var define = require('amdefine')(module);define(['exports', 'module', '../CompileError', '../Expression', './util', './VerifyResults'], function (exports, module, _CompileError, _Expression, _util, _VerifyResults) {
	'use strict';

	module.exports = verify;

	function _interopRequire(obj) { return obj && obj.__esModule ? obj['default'] : obj; }

	function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) arr2[i] = arr[i]; return arr2; } else { return Array.from(arr); } }

	var _VerifyResults2 = _interopRequire(_VerifyResults);

	const vm = function (es) {
		return es.forEach(function (e) {
			return e.verify();
		});
	};
	const vop = function (op) {
		return (0, _util.opEach)(op, function (_) {
			return _.verify();
		});
	};

	let cx, locals,
	// Locals for this block.
	// Replaces `locals` when entering into sub-function.
	pendingBlockLocals, isInDebug, isInGenerator, opLoop, vr;

	const init = function (_cx) {
		cx = _cx;
		locals = new Map();
		pendingBlockLocals = [];
		isInDebug = false;
		isInGenerator = false;
		opLoop = null;
		vr = new _VerifyResults2();
	},
	     
	// Release for garbage collection
	uninit = function () {
		locals = pendingBlockLocals = opLoop = vr = undefined;
	},
	      withInGenerator = function (_isInGenerator, fun) {
		const g = isInGenerator;
		isInGenerator = _isInGenerator;
		fun();
		isInGenerator = g;
	},
	      plusLocals = function (addedLocals, fun) {
		const shadowed = new Map();
		addedLocals.forEach(function (l) {
			const got = locals.get(l.name);
			if (got !== undefined) shadowed.set(l.name, got);
			locals.set(l.name, l);
		});
		fun();
		addedLocals.forEach(function (l) {
			const s = shadowed.get(l.name);
			if (s === undefined) locals.delete(l.name);else locals.set(l.name, s);
		});
	},
	      plusPendingBlockLocals = function (pending, fun) {
		const oldLength = pendingBlockLocals.length;
		pendingBlockLocals.push.apply(pendingBlockLocals, _toConsumableArray(pending));
		fun();
		while (pendingBlockLocals.length > oldLength) pendingBlockLocals.pop();
	},
	      withInLoop = function (loop, fun) {
		const l = opLoop;
		opLoop = loop;
		fun();
		opLoop = l;
	},
	      withInDebug = function (_isInDebug, fun) {
		const d = isInDebug;
		isInDebug = _isInDebug;
		fun();
		isInDebug = d;
	},
	      withBlockLocals = function (fun) {
		const bl = pendingBlockLocals;
		pendingBlockLocals = [];
		plusLocals(bl, fun);
		pendingBlockLocals = bl;
	},
	      accessLocal = function (declare, access, isDebugAccess) {
		return _addAccess(vr.localToInfo.get(declare), access, isDebugAccess);
	},
	      accessLocalForReturn = function (declare, access) {
		const info = vr.localToInfo.get(declare);
		_addAccess(info, access, info.isInDebug);
	},
	      _addAccess = function (localInfo, access, isDebugAccess) {
		return (isDebugAccess ? localInfo.debugAccesses : localInfo.nonDebugAccesses).push(access);
	},
	     

	// Vr setters
	setEndLoop = function (endLoop, loop) {
		vr.endLoopToLoop.set(endLoop, loop);
	},
	      registerLocal = function (local) {
		vr.localToInfo.set(local, (0, _VerifyResults.LocalInfo)(isInDebug, [], []));
	},
	      setEntryIndex = function (listMapEntry, index) {
		vr.entryToIndex.set(listMapEntry, index);
	};

	function verify(cx, e) {
		init(cx);
		e.verify();
		verifyLocalUse();
		const out = vr;
		uninit();
		return out;
	}

	const verifyLocalUse = function () {
		vr.localToInfo.forEach(function (info, local) {
			if (!(local instanceof _Expression.LocalDeclareRes)) {
				const noNonDebug = (0, _util.isEmpty)(info.nonDebugAccesses);
				if (noNonDebug && (0, _util.isEmpty)(info.debugAccesses)) cx.warn(local.loc, function () {
					return 'Unused local variable ' + (0, _CompileError.code)(local.name) + '.';
				});else if (info.isInDebug) cx.warnIf(!noNonDebug, function () {
					return (0, _util.head)(info.nonDebugAccesses).loc;
				}, function () {
					return 'Debug-only local ' + (0, _CompileError.code)(local.name) + ' used outside of debug.';
				});else cx.warnIf(noNonDebug, local.loc, function () {
					return 'Local ' + (0, _CompileError.code)(local.name) + ' used only in debug.';
				});
			}
		});
	};

	(0, _util.implementMany)(_Expression, 'verify', {
		Assign: function () {
			var _this = this;

			const doV = function () {
				_this.assignee.verify();
				_this.value.verify();
			};
			if (this.assignee.isLazy()) withBlockLocals(doV);else doV();
		},
		AssignDestructure: function () {
			this.value.verify();
			vm(this.assignees);
		},
		AssignMutate: function () {
			var _this2 = this;

			const declare = getLocalDeclare(this.name, this.loc);
			cx.check(declare.isMutable(), this.loc, function () {
				return '' + (0, _CompileError.code)(_this2.name) + ' is not mutable.';
			});
			// TODO: Track assignments. Mutable local must be mutated somewhere.
			this.value.verify();
		},

		BagEntry: function () {
			this.value.verify();
		},
		BagSimple: function () {
			vm(this.parts);
		},
		BlockDo: function () {
			verifyLines(this.lines);
		},
		BlockWithReturn: function () {
			var _this3 = this;

			var _verifyLines = verifyLines(this.lines);

			const newLocals = _verifyLines.newLocals;

			plusLocals(newLocals, function () {
				return _this3.returned.verify();
			});
		},
		BlockObj: function () {
			var _this4 = this;

			var _verifyLines2 = verifyLines(this.lines);

			const newLocals = _verifyLines2.newLocals;

			this.keys.forEach(function (_) {
				return accessLocalForReturn(_, _this4);
			});
			(0, _util.opEach)(this.opObjed, function (_) {
				return plusLocals(newLocals, function () {
					return _.verify();
				});
			});
		},
		BlockBag: blockBagOrMap,
		BlockMap: blockBagOrMap,
		BlockWrap: function () {
			this.block.verify();
		},
		Call: function () {
			this.called.verify();
			vm(this.args);
		},
		CaseDo: verifyCase,
		CaseDoPart: verifyCasePart,
		CaseVal: verifyCase,
		CaseValPart: verifyCasePart,
		// Only reach here for in/out condition
		Debug: function () {
			verifyLines([this]);
		},
		EndLoop: function () {
			var _this5 = this;

			(0, _util.ifElse)(opLoop, function (_) {
				return setEndLoop(_this5, _);
			}, function () {
				return cx.fail(_this5.loc, 'Not in a loop.');
			});
		},
		Fun: function () {
			var _this6 = this;

			withBlockLocals(function () {
				cx.check(_this6.opResDeclare === null || _this6.block instanceof _Expression.BlockVal, _this6.loc, 'Function with return condition must return something.');
				_this6.args.forEach(function (arg) {
					return vop(arg.opType);
				});
				withInGenerator(_this6.isGenerator, function () {
					const allArgs = (0, _util.cat)(_this6.args, _this6.opRestArg);
					allArgs.forEach(function (_) {
						return registerLocal(_);
					});
					plusLocals(allArgs, function () {
						vop(_this6.opIn);
						_this6.block.verify();
						(0, _util.opEach)(_this6.opResDeclare, function (_) {
							_.verify();
							registerLocal(_);
						});
						const verifyOut = function () {
							return (0, _util.opEach)(_this6.opOut, function (_) {
								return _.verify();
							});
						};
						(0, _util.ifElse)(_this6.opResDeclare, function (rd) {
							return plusLocals([rd], verifyOut);
						}, verifyOut);
					});
				});
			});
		},
		GlobalAccess: function () {},
		Lazy: function () {
			var _this7 = this;

			withBlockLocals(function () {
				return _this7.value.verify();
			});
		},
		LocalAccess: function () {
			const declare = getLocalDeclare(this.name, this.loc);
			vr.accessToLocal.set(this, declare);
			accessLocal(declare, this, isInDebug);
		},
		Loop: function () {
			var _this8 = this;

			withInLoop(this, function () {
				return _this8.block.verify();
			});
		},
		// Adding LocalDeclares to the available locals is done by Fun or lineNewLocals.
		LocalDeclare: function () {
			vop(this.opType);
		},
		NumberLiteral: function () {},
		MapEntry: function () {
			this.key.verify();
			this.val.verify();
		},
		Member: function () {
			this.object.verify();
		},
		Module: function () {
			var _this9 = this;

			// No need to verify this.doUses.
			const useLocals = verifyUses(this.uses, this.debugUses);
			plusLocals(useLocals, function () {
				var _verifyLines3 = verifyLines(_this9.lines);

				const newLocals = _verifyLines3.newLocals;

				_this9.exports.forEach(function (ex) {
					return accessLocalForReturn(ex, _this9);
				});
				(0, _util.opEach)(_this9.opDefaultExport, function (_) {
					return plusLocals(newLocals, function () {
						return _.verify();
					});
				});
			});

			const exports = (0, _util.newSet)(this.exports);
			const markExportLines = function (line) {
				if (line instanceof _Expression.Assign && exports.has(line.assignee) || line instanceof _Expression.AssignDestructure && line.assignees.some(function (_) {
					return exports.has(_);
				})) vr.exportAssigns.add(line);else if (line instanceof _Expression.Debug) line.lines.forEach(markExportLines);
			};
			this.lines.forEach(markExportLines);
		},
		ObjSimple: function () {
			const keys = new Set();
			this.pairs.forEach(function (pair) {
				cx.check(!keys.has(pair.key), pair.loc, function () {
					return 'Duplicate key ' + pair.key;
				});
				keys.add(pair.key);
				pair.value.verify();
			});
		},
		Quote: function () {
			this.parts.forEach(function (_) {
				if (typeof _ !== 'string') _.verify();
			});
		},
		SpecialDo: function () {},
		SpecialVal: function () {},
		Splat: function () {
			this.splatted.verify();
		},
		Yield: function () {
			cx.check(isInGenerator, this.loc, 'Cannot yield outside of generator context');
			this.yielded.verify();
		},
		YieldTo: function () {
			cx.check(isInGenerator, this.loc, 'Cannot yield outside of generator context');
			this.yieldedTo.verify();
		}
	});

	function blockBagOrMap() {
		var _verifyLines4 = verifyLines(this.lines);

		const listMapLength = _verifyLines4.listMapLength;

		vr.blockToLength.set(this, listMapLength);
	}

	function verifyCase() {
		var _this10 = this;

		const newLocals = [];
		(0, _util.opEach)(this.opCased, function (_) {
			registerLocal(_.assignee);
			_.verify();
			newLocals.push(_.assignee);
		});
		plusLocals(newLocals, function () {
			vm(_this10.parts);
			vop(_this10.opElse);
		});
	}

	function verifyCasePart() {
		var _this11 = this;

		if (this.test instanceof _Expression.Pattern) {
			this.test.type.verify();
			this.test.patterned.verify();
			vm(this.test.locals);
			this.test.locals.forEach(registerLocal);
			plusLocals(this.test.locals, function () {
				return _this11.result.verify();
			});
		} else {
			this.test.verify();
			this.result.verify();
		}
	}

	const getLocalDeclare = function (name, accessLoc) {
		const declare = locals.get(name);
		cx.check(declare !== undefined, accessLoc, function () {
			return 'No such local ' + (0, _CompileError.code)(name) + '.\nLocals are:\n' + (0, _CompileError.code)((0, _util.mapKeys)(locals).join(' ')) + '.';
		});
		return declare;
	},
	      lineNewLocals = function (line) {
		return line instanceof _Expression.Assign ? [line.assignee] : line instanceof _Expression.AssignDestructure ? line.assignees : [];
	},
	      verifyUses = function (uses, debugUses) {
		const useLocals = [];
		const verifyUse = function (use) {
			use.used.forEach(useLocal);
			(0, _util.opEach)(use.opUseDefault, useLocal);
		},
		      useLocal = function (_) {
			registerLocal(_);
			useLocals.push(_);
		};
		uses.forEach(verifyUse);
		withInDebug(true, function () {
			return debugUses.forEach(verifyUse);
		});
		return useLocals;
	},
	      verifyLines = function (lines) {
		const newLocals = [];
		// First, get locals for the whole block.
		const getLineLocals = function (line) {
			if (line instanceof _Expression.Debug) withInDebug(true, function () {
				return line.lines.forEach(getLineLocals);
			});else {
				const news = lineNewLocals(line);
				news.forEach(registerLocal);
				newLocals.push.apply(newLocals, _toConsumableArray(news));
			}
		};

		lines.forEach(getLineLocals);

		const thisBlockLocalNames = new Set();
		const shadowed = new Map();

		let listMapLength = 0;

		const verifyLine = function (line) {
			if (line instanceof _Expression.Debug)
				// TODO: Do anything in this situation?
				// cx.check(!inDebug, line.loc, 'Redundant `debug`.')
				withInDebug(true, function () {
					return line.lines.forEach(verifyLine);
				});else {
				verifyIsStatement(line);
				lineNewLocals(line).forEach(function (l) {
					const got = locals.get(l.name);
					if (got !== undefined) {
						cx.check(!thisBlockLocalNames.has(l.name), l.loc, function () {
							return 'A local ' + (0, _CompileError.code)(l.name) + ' is already in this block.';
						});
						shadowed.set(l.name, got);
					}
					locals.set(l.name, l);
					thisBlockLocalNames.add(l.name);
				});
				if (line instanceof _Expression.BagEntry || line instanceof _Expression.MapEntry) {
					setEntryIndex(line, listMapLength);
					listMapLength = listMapLength + 1;
				}
				line.verify();
			}
		};

		plusPendingBlockLocals(newLocals, function () {
			return lines.forEach(verifyLine);
		});

		newLocals.forEach(function (l) {
			const s = shadowed.get(l.name);
			if (s === undefined) locals.delete(l.name);else locals.set(l.name, s);
		});

		return { newLocals: newLocals, listMapLength: listMapLength };
	},
	      verifyIsStatement = function (line) {
		const isStatement = line instanceof _Expression.Do || line instanceof _Expression.Call || line instanceof _Expression.Yield || line instanceof _Expression.YieldTo || line instanceof _Expression.BagEntry || line instanceof _Expression.MapEntry || line instanceof _Expression.SpecialDo;
		cx.check(isStatement, line.loc, 'Expression in statement position.');
	};
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1ldGEvY29tcGlsZS9wcml2YXRlL3ZlcmlmeS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7a0JBaUh3QixNQUFNOzs7Ozs7OztBQTFHOUIsT0FBTSxFQUFFLEdBQUcsVUFBQSxFQUFFO1NBQUksRUFBRSxDQUFDLE9BQU8sQ0FBQyxVQUFBLENBQUM7VUFBSSxDQUFDLENBQUMsTUFBTSxFQUFFO0dBQUEsQ0FBQztFQUFBLENBQUE7QUFDNUMsT0FBTSxHQUFHLEdBQUcsVUFBQSxFQUFFO1NBQUksVUFKbUQsTUFBTSxFQUlsRCxFQUFFLEVBQUUsVUFBQSxDQUFDO1VBQUksQ0FBQyxDQUFDLE1BQU0sRUFBRTtHQUFBLENBQUM7RUFBQSxDQUFBOztBQUU3QyxLQUNDLEVBQUUsRUFDRixNQUFNOzs7QUFHTixtQkFBa0IsRUFDbEIsU0FBUyxFQUNULGFBQWEsRUFDYixNQUFNLEVBQ04sRUFBRSxDQUFBOztBQUVILE9BQ0MsSUFBSSxHQUFHLFVBQUEsR0FBRyxFQUFJO0FBQ2IsSUFBRSxHQUFHLEdBQUcsQ0FBQTtBQUNSLFFBQU0sR0FBRyxJQUFJLEdBQUcsRUFBRSxDQUFBO0FBQ2xCLG9CQUFrQixHQUFHLEVBQUUsQ0FBQTtBQUN2QixXQUFTLEdBQUcsS0FBSyxDQUFBO0FBQ2pCLGVBQWEsR0FBRyxLQUFLLENBQUE7QUFDckIsUUFBTSxHQUFHLElBQUksQ0FBQTtBQUNiLElBQUUsR0FBRyxxQkFBbUIsQ0FBQTtFQUN4Qjs7O0FBRUQsT0FBTSxHQUFHLFlBQU07QUFDZCxRQUFNLEdBQUcsa0JBQWtCLEdBQUcsTUFBTSxHQUFHLEVBQUUsR0FBRyxTQUFTLENBQUE7RUFDckQ7T0FFRCxlQUFlLEdBQUcsVUFBQyxjQUFjLEVBQUUsR0FBRyxFQUFLO0FBQzFDLFFBQU0sQ0FBQyxHQUFHLGFBQWEsQ0FBQTtBQUN2QixlQUFhLEdBQUcsY0FBYyxDQUFBO0FBQzlCLEtBQUcsRUFBRSxDQUFBO0FBQ0wsZUFBYSxHQUFHLENBQUMsQ0FBQTtFQUNqQjtPQUVELFVBQVUs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Y2VzQ29udGVudCI6WyJpbXBvcnQgeyBjb2RlIH0gZnJvbSAnLi4vQ29tcGlsZUVycm9yJ1xuaW1wb3J0ICogYXMgRUV4cG9ydHMgZnJvbSAnLi4vRXhwcmVzc2lvbidcbmltcG9ydCB7IEFzc2lnbiwgQXNzaWduRGVzdHJ1Y3R1cmUsIEJsb2NrVmFsLCBDYWxsLCBEZWJ1ZywgRG8sIEJhZ0VudHJ5LFxuXHRMb2NhbERlY2xhcmVSZXMsIE1hcEVudHJ5LCBQYXR0ZXJuLCBTcGVjaWFsRG8sIFlpZWxkLCBZaWVsZFRvIH0gZnJvbSAnLi4vRXhwcmVzc2lvbidcbmltcG9ydCB7IGNhdCwgaGVhZCwgaWZFbHNlLCBpbXBsZW1lbnRNYW55LCBpc0VtcHR5LCBtYXBLZXlzLCBuZXdTZXQsIG9wRWFjaCB9IGZyb20gJy4vdXRpbCdcbmltcG9ydCBWZXJpZnlSZXN1bHRzLCB7IExvY2FsSW5mbyB9IGZyb20gJy4vVmVyaWZ5UmVzdWx0cydcblxuY29uc3Qgdm0gPSBlcyA9PiBlcy5mb3JFYWNoKGUgPT4gZS52ZXJpZnkoKSlcbmNvbnN0IHZvcCA9IG9wID0+IG9wRWFjaChvcCwgXyA9PiBfLnZlcmlmeSgpKVxuXG5sZXRcblx0Y3gsXG5cdGxvY2Fscyxcblx0Ly8gTG9jYWxzIGZvciB0aGlzIGJsb2NrLlxuXHQvLyBSZXBsYWNlcyBgbG9jYWxzYCB3aGVuIGVudGVyaW5nIGludG8gc3ViLWZ1bmN0aW9uLlxuXHRwZW5kaW5nQmxvY2tMb2NhbHMsXG5cdGlzSW5EZWJ1Zyxcblx0aXNJbkdlbmVyYXRvcixcblx0b3BMb29wLFxuXHR2clxuXG5jb25zdFxuXHRpbml0ID0gX2N4ID0+IHtcblx0XHRjeCA9IF9jeFxuXHRcdGxvY2FscyA9IG5ldyBNYXAoKVxuXHRcdHBlbmRpbmdCbG9ja0xvY2FscyA9IFtdXG5cdFx0aXNJbkRlYnVnID0gZmFsc2Vcblx0XHRpc0luR2VuZXJhdG9yID0gZmFsc2Vcblx0XHRvcExvb3AgPSBudWxsXG5cdFx0dnIgPSBuZXcgVmVyaWZ5UmVzdWx0cygpXG5cdH0sXG5cdC8vIFJlbGVhc2UgZm9yIGdhcmJhZ2UgY29sbGVjdGlvblxuXHR1bmluaXQgPSAoKSA9PiB7XG5cdFx0bG9jYWxzID0gcGVuZGluZ0Jsb2NrTG9jYWxzID0gb3BMb29wID0gdnIgPSB1bmRlZmluZWRcblx0fSxcblxuXHR3aXRoSW5HZW5lcmF0b3IgPSAoX2lzSW5HZW5lcmF0b3IsIGZ1bikgPT4ge1xuXHRcdGNvbnN0IGcgPSBpc0luR2VuZXJhdG9yXG5cdFx0aXNJbkdlbmVyYXRvciA9IF9pc0luR2VuZXJhdG9yXG5cdFx0ZnVuKClcblx0XHRpc0luR2VuZXJhdG9yID0gZ1xuXHR9LFxuXG5cdHBsdXNMb2NhbHMgPSAoYWRkZWRMb2NhbHMsIGZ1bikgPT4ge1xuXHRcdGNvbnN0IHNoYWRvd2VkID0gbmV3IE1hcCgpXG5cdFx0YWRkZWRMb2NhbHMuZm9yRWFjaChsID0+IHtcblx0XHRcdGNvbnN0IGdvdCA9IGxvY2Fscy5nZXQobC5uYW1lKVxuXHRcdFx0aWYgKGdvdCAhPT0gdW5kZWZpbmVkKVxuXHRcdFx0XHRzaGFkb3dlZC5zZXQobC5uYW1lLCBnb3QpXG5cdFx0XHRsb2NhbHMuc2V0KGwubmFtZSwgbClcblx0XHR9KVxuXHRcdGZ1bigpXG5cdFx0YWRkZWRMb2NhbHMuZm9yRWFjaChsID0+IHtcblx0XHRcdGNvbnN0IHMgPSBzaGFkb3dlZC5nZXQobC5uYW1lKVxuXHRcdFx0aWYgKHMgPT09IHVuZGVmaW5lZClcblx0XHRcdFx0bG9jYWxzLmRlbGV0ZShsLm5hbWUpXG5cdFx0XHRlbHNlXG5cdFx0XHRcdGxvY2Fscy5zZXQobC5uYW1lLCBzKVxuXHRcdH0pXG5cdH0sXG5cblx0cGx1c1BlbmRpbmdCbG9ja0xvY2FscyA9IChwZW5kaW5nLCBmdW4pID0+IHtcblx0XHRjb25zdCBvbGRMZW5ndGggPSBwZW5kaW5nQmxvY2tMb2NhbHMubGVuZ3RoXG5cdFx0cGVuZGluZ0Jsb2NrTG9jYWxzLnB1c2goLi4ucGVuZGluZylcblx0XHRmdW4oKVxuXHRcdHdoaWxlIChwZW5kaW5nQmxvY2tMb2NhbHMubGVuZ3RoID4gb2xkTGVuZ3RoKVxuXHRcdFx0cGVuZGluZ0Jsb2NrTG9jYWxzLnBvcCgpXG5cdH0sXG5cblx0d2l0aEluTG9vcCA9IChsb29wLCBmdW4pID0+IHtcblx0XHRjb25zdCBsID0gb3BMb29wXG5cdFx0b3BMb29wID0gbG9vcFxuXHRcdGZ1bigpXG5cdFx0b3BMb29wID0gbFxuXHR9LFxuXG5cdHdpdGhJbkRlYnVnID0gKF9pc0luRGVidWcsIGZ1bikgPT4ge1xuXHRcdGNvbnN0IGQgPSBpc0luRGVidWdcblx0XHRpc0luRGVidWcgPSBfaXNJbkRlYnVnXG5cdFx0ZnVuKClcblx0XHRpc0luRGVidWcgPSBkXG5cdH0sXG5cblx0d2l0aEJsb2NrTG9jYWxzID0gZnVuID0+IHtcblx0XHRjb25zdCBibCA9IHBlbmRpbmdCbG9ja0xvY2Fsc1xuXHRcdHBlbmRpbmdCbG9ja0xvY2FscyA9IFtdXG5cdFx0cGx1c0xvY2FscyhibCwgZnVuKVxuXHRcdHBlbmRpbmdCbG9ja0xvY2FscyA9IGJsXG5cdH0sXG5cblx0YWNjZXNzTG9jYWwgPSAoZGVjbGFyZSwgYWNjZXNzLCBpc0RlYnVnQWNjZXNzKSA9PlxuXHRcdF9hZGRBY2Nlc3ModnIubG9jYWxUb0luZm8uZ2V0KGRlY2xhcmUpLCBhY2Nlc3MsIGlzRGVidWdBY2Nlc3MpLFxuXHRhY2Nlc3NMb2NhbEZvclJldHVybiA9IChkZWNsYXJlLCBhY2Nlc3MpID0+IHtcblx0XHRjb25zdCBpbmZvID0gdnIubG9jYWxUb0luZm8uZ2V0KGRlY2xhcmUpXG5cdFx0X2FkZEFjY2VzcyhpbmZvLCBhY2Nlc3MsIGluZm8uaXNJbkRlYnVnKVxuXHR9LFxuXHRfYWRkQWNjZXNzID0gKGxvY2FsSW5mbywgYWNjZXNzLCBpc0RlYnVnQWNjZXNzKSA9PlxuXHRcdChpc0RlYnVnQWNjZXNzID8gbG9jYWxJbmZvLmRlYnVnQWNjZXNzZXMgOiBsb2NhbEluZm8ubm9uRGVidWdBY2Nlc3NlcykucHVzaChhY2Nlc3MpLFxuXG5cblx0Ly8gVnIgc2V0dGVyc1xuXHRzZXRFbmRMb29wID0gKGVuZExvb3AsIGxvb3ApID0+IHtcblx0XHR2ci5lbmRMb29wVG9Mb29wLnNldChlbmRMb29wLCBsb29wKVxuXHR9LFxuXG5cdHJlZ2lzdGVyTG9jYWwgPSBsb2NhbCA9PiB7XG5cdFx0dnIubG9jYWxUb0luZm8uc2V0KGxvY2FsLCBMb2NhbEluZm8oaXNJbkRlYnVnLCBbXSwgW10pKVxuXHR9LFxuXG5cdHNldEVudHJ5SW5kZXggPSAobGlzdE1hcEVudHJ5LCBpbmRleCkgPT4ge1xuXHRcdHZyLmVudHJ5VG9JbmRleC5zZXQobGlzdE1hcEVudHJ5LCBpbmRleClcblx0fVxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiB2ZXJpZnkoY3gsIGUpIHtcblx0aW5pdChjeClcblx0ZS52ZXJpZnkoKVxuXHR2ZXJpZnlMb2NhbFVzZSgpXG5cdGNvbnN0IG91dCA9IHZyXG5cdHVuaW5pdCgpXG5cdHJldHVybiBvdXRcbn1cblxuY29uc3QgdmVyaWZ5TG9jYWxVc2UgPSAoKSA9PiB7XG5cdHZyLmxvY2FsVG9JbmZvLmZvckVhY2goKGluZm8sIGxvY2FsKSA9PiB7XG5cdFx0aWYgKCEobG9jYWwgaW5zdGFuY2VvZiBMb2NhbERlY2xhcmVSZXMpKSB7XG5cdFx0XHRjb25zdCBub05vbkRlYnVnID0gaXNFbXB0eShpbmZvLm5vbkRlYnVnQWNjZXNzZXMpXG5cdFx0XHRpZiAobm9Ob25EZWJ1ZyAmJiBpc0VtcHR5KGluZm8uZGVidWdBY2Nlc3NlcykpXG5cdFx0XHRcdGN4Lndhcm4obG9jYWwubG9jLCAoKSA9PiBgVW51c2VkIGxvY2FsIHZhcmlhYmxlICR7Y29kZShsb2NhbC5uYW1lKX0uYClcblx0XHRcdGVsc2UgaWYgKGluZm8uaXNJbkRlYnVnKVxuXHRcdFx0XHRjeC53YXJuSWYoIW5vTm9uRGVidWcsICgpID0+IGhlYWQoaW5mby5ub25EZWJ1Z0FjY2Vzc2VzKS5sb2MsICgpID0+XG5cdFx0XHRcdFx0YERlYnVnLW9ubHkgbG9jYWwgJHtjb2RlKGxvY2FsLm5hbWUpfSB1c2VkIG91dHNpZGUgb2YgZGVidWcuYClcblx0XHRcdGVsc2Vcblx0XHRcdFx0Y3gud2FybklmKG5vTm9uRGVidWcsIGxvY2FsLmxvYywgKCkgPT5cblx0XHRcdFx0XHRgTG9jYWwgJHtjb2RlKGxvY2FsLm5hbWUpfSB1c2VkIG9ubHkgaW4gZGVidWcuYClcblx0XHR9XG5cdH0pXG59XG5cbmltcGxlbWVudE1hbnkoRUV4cG9ydHMsICd2ZXJpZnknLCB7XG5cdEFzc2lnbigpIHtcblx0XHRjb25zdCBkb1YgPSAoKSA9PiB7XG5cdFx0XHR0aGlzLmFzc2lnbmVlLnZlcmlmeSgpXG5cdFx0XHR0aGlzLnZhbHVlLnZlcmlmeSgpXG5cdFx0fVxuXHRcdGlmICh0aGlzLmFzc2lnbmVlLmlzTGF6eSgpKVxuXHRcdFx0d2l0aEJsb2NrTG9jYWxzKGRvVilcblx0XHRlbHNlXG5cdFx0XHRkb1YoKVxuXHR9LFxuXHRBc3NpZ25EZXN0cnVjdHVyZSgpIHtcblx0XHR0aGlzLnZhbHVlLnZlcmlmeSgpXG5cdFx0dm0odGhpcy5hc3NpZ25lZXMpXG5cdH0sXG5cdEFzc2lnbk11dGF0ZSgpIHtcblx0XHRjb25zdCBkZWNsYXJlID0gZ2V0TG9jYWxEZWNsYXJlKHRoaXMubmFtZSwgdGhpcy5sb2MpXG5cdFx0Y3guY2hlY2soZGVjbGFyZS5pc011dGFibGUoKSwgdGhpcy5sb2MsICgpID0+IGAke2NvZGUodGhpcy5uYW1lKX0gaXMgbm90IG11dGFibGUuYClcblx0XHQvLyBUT0RPOiBUcmFjayBhc3NpZ25tZW50cy4gTXV0YWJsZSBsb2NhbCBtdXN0IGJlIG11dGF0ZWQgc29tZXdoZXJlLlxuXHRcdHRoaXMudmFsdWUudmVyaWZ5KClcblx0fSxcblxuXHRCYWdFbnRyeSgpIHsgdGhpcy52YWx1ZS52ZXJpZnkoKSB9LFxuXHRCYWdTaW1wbGUoKSB7IHZtKHRoaXMucGFydHMpIH0sXG5cdEJsb2NrRG8oKSB7IHZlcmlmeUxpbmVzKHRoaXMubGluZXMpIH0sXG5cdEJsb2NrV2l0aFJldHVybigpIHtcblx0XHRjb25zdCB7IG5ld0xvY2FscyB9ID0gdmVyaWZ5TGluZXModGhpcy5saW5lcylcblx0XHRwbHVzTG9jYWxzKG5ld0xvY2FscywgKCkgPT4gdGhpcy5yZXR1cm5lZC52ZXJpZnkoKSlcblx0fSxcblx0QmxvY2tPYmooKSB7XG5cdFx0Y29uc3QgeyBuZXdMb2NhbHMgfSA9IHZlcmlmeUxpbmVzKHRoaXMubGluZXMpXG5cdFx0dGhpcy5rZXlzLmZvckVhY2goXyA9PiBhY2Nlc3NMb2NhbEZvclJldHVybihfLCB0aGlzKSlcblx0XHRvcEVhY2godGhpcy5vcE9iamVkLCBfID0+IHBsdXNMb2NhbHMobmV3TG9jYWxzLCAoKSA9PiBfLnZlcmlmeSgpKSlcblx0fSxcblx0QmxvY2tCYWc6IGJsb2NrQmFnT3JNYXAsXG5cdEJsb2NrTWFwOiBibG9ja0JhZ09yTWFwLFxuXHRCbG9ja1dyYXAoKSB7XG5cdFx0dGhpcy5ibG9jay52ZXJpZnkoKVxuXHR9LFxuXHRDYWxsKCkge1xuXHRcdHRoaXMuY2FsbGVkLnZlcmlmeSgpXG5cdFx0dm0odGhpcy5hcmdzKVxuXHR9LFxuXHRDYXNlRG86IHZlcmlmeUNhc2UsXG5cdENhc2VEb1BhcnQ6IHZlcmlmeUNhc2VQYXJ0LFxuXHRDYXNlVmFsOiB2ZXJpZnlDYXNlLFxuXHRDYXNlVmFsUGFydDogdmVyaWZ5Q2FzZVBhcnQsXG5cdC8vIE9ubHkgcmVhY2ggaGVyZSBmb3IgaW4vb3V0IGNvbmRpdGlvblxuXHREZWJ1ZygpIHsgdmVyaWZ5TGluZXMoWyB0aGlzIF0pIH0sXG5cdEVuZExvb3AoKSB7XG5cdFx0aWZFbHNlKG9wTG9vcCwgXyA9PiBzZXRFbmRMb29wKHRoaXMsIF8pLCAoKSA9PiBjeC5mYWlsKHRoaXMubG9jLCAnTm90IGluIGEgbG9vcC4nKSlcblx0fSxcblx0RnVuKCkge1xuXHRcdHdpdGhCbG9ja0xvY2FscygoKSA9PiB7XG5cdFx0XHRjeC5jaGVjayh0aGlzLm9wUmVzRGVjbGFyZSA9PT0gbnVsbCB8fCB0aGlzLmJsb2NrIGluc3RhbmNlb2YgQmxvY2tWYWwsIHRoaXMubG9jLFxuXHRcdFx0XHQnRnVuY3Rpb24gd2l0aCByZXR1cm4gY29uZGl0aW9uIG11c3QgcmV0dXJuIHNvbWV0aGluZy4nKVxuXHRcdFx0dGhpcy5hcmdzLmZvckVhY2goYXJnID0+IHZvcChhcmcub3BUeXBlKSlcblx0XHRcdHdpdGhJbkdlbmVyYXRvcih0aGlzLmlzR2VuZXJhdG9yLCAoKSA9PiB7XG5cdFx0XHRcdGNvbnN0IGFsbEFyZ3MgPSBjYXQodGhpcy5hcmdzLCB0aGlzLm9wUmVzdEFyZylcblx0XHRcdFx0YWxsQXJncy5mb3JFYWNoKF8gPT4gcmVnaXN0ZXJMb2NhbChfKSlcblx0XHRcdFx0cGx1c0xvY2FscyhhbGxBcmdzLCAoKSA9PiB7XG5cdFx0XHRcdFx0dm9wKHRoaXMub3BJbilcblx0XHRcdFx0XHR0aGlzLmJsb2NrLnZlcmlmeSgpXG5cdFx0XHRcdFx0b3BFYWNoKHRoaXMub3BSZXNEZWNsYXJlLCBfID0+IHtcblx0XHRcdFx0XHRcdF8udmVyaWZ5KClcblx0XHRcdFx0XHRcdHJlZ2lzdGVyTG9jYWwoXylcblx0XHRcdFx0XHR9KVxuXHRcdFx0XHRcdGNvbnN0IHZlcmlmeU91dCA9ICgpID0+IG9wRWFjaCh0aGlzLm9wT3V0LCBfID0+IF8udmVyaWZ5KCkpXG5cdFx0XHRcdFx0aWZFbHNlKHRoaXMub3BSZXNEZWNsYXJlLCByZCA9PiBwbHVzTG9jYWxzKFsgcmQgXSwgdmVyaWZ5T3V0KSwgdmVyaWZ5T3V0KVxuXHRcdFx0XHR9KVxuXHRcdFx0fSlcblx0XHR9KVxuXHR9LFxuXHRHbG9iYWxBY2Nlc3MoKSB7IH0sXG5cdExhenkoKSB7IHdpdGhCbG9ja0xvY2FscygoKSA9PiB0aGlzLnZhbHVlLnZlcmlmeSgpKSB9LFxuXHRMb2NhbEFjY2VzcygpIHtcblx0XHRjb25zdCBkZWNsYXJlID0gZ2V0TG9jYWxEZWNsYXJlKHRoaXMubmFtZSwgdGhpcy5sb2MpXG5cdFx0dnIuYWNjZXNzVG9Mb2NhbC5zZXQodGhpcywgZGVjbGFyZSlcblx0XHRhY2Nlc3NMb2NhbChkZWNsYXJlLCB0aGlzLCBpc0luRGVidWcpXG5cdH0sXG5cdExvb3AoKSB7IHdpdGhJbkxvb3AodGhpcywgKCkgPT4gdGhpcy5ibG9jay52ZXJpZnkoKSkgfSxcblx0Ly8gQWRkaW5nIExvY2FsRGVjbGFyZXMgdG8gdGhlIGF2YWlsYWJsZSBsb2NhbHMgaXMgZG9uZSBieSBGdW4gb3IgbGluZU5ld0xvY2Fscy5cblx0TG9jYWxEZWNsYXJlKCkgeyB2b3AodGhpcy5vcFR5cGUpIH0sXG5cdE51bWJlckxpdGVyYWwoKSB7IH0sXG5cdE1hcEVudHJ5KCkge1xuXHRcdHRoaXMua2V5LnZlcmlmeSgpXG5cdFx0dGhpcy52YWwudmVyaWZ5KClcblx0fSxcblx0TWVtYmVyKCkgeyB0aGlzLm9iamVjdC52ZXJpZnkoKSB9LFxuXHRNb2R1bGUoKSB7XG5cdFx0Ly8gTm8gbmVlZCB0byB2ZXJpZnkgdGhpcy5kb1VzZXMuXG5cdFx0Y29uc3QgdXNlTG9jYWxzID0gdmVyaWZ5VXNlcyh0aGlzLnVzZXMsIHRoaXMuZGVidWdVc2VzKVxuXHRcdHBsdXNMb2NhbHModXNlTG9jYWxzLCAoKSA9PiB7XG5cdFx0XHRjb25zdCB7IG5ld0xvY2FscyB9ID0gdmVyaWZ5TGluZXModGhpcy5saW5lcylcblx0XHRcdHRoaXMuZXhwb3J0cy5mb3JFYWNoKGV4ID0+IGFjY2Vzc0xvY2FsRm9yUmV0dXJuKGV4LCB0aGlzKSlcblx0XHRcdG9wRWFjaCh0aGlzLm9wRGVmYXVsdEV4cG9ydCwgXyA9PiBwbHVzTG9jYWxzKG5ld0xvY2FscywgKCkgPT4gXy52ZXJpZnkoKSkpXG5cdFx0fSlcblxuXHRcdGNvbnN0IGV4cG9ydHMgPSBuZXdTZXQodGhpcy5leHBvcnRzKVxuXHRcdGNvbnN0IG1hcmtFeHBvcnRMaW5lcyA9IGxpbmUgPT4ge1xuXHRcdFx0aWYgKGxpbmUgaW5zdGFuY2VvZiBBc3NpZ24gJiYgZXhwb3J0cy5oYXMobGluZS5hc3NpZ25lZSkgfHxcblx0XHRcdFx0bGluZSBpbnN0YW5jZW9mIEFzc2lnbkRlc3RydWN0dXJlICYmIGxpbmUuYXNzaWduZWVzLnNvbWUoXyA9PiBleHBvcnRzLmhhcyhfKSkpXG5cdFx0XHRcdHZyLmV4cG9ydEFzc2lnbnMuYWRkKGxpbmUpXG5cdFx0XHRlbHNlIGlmIChsaW5lIGluc3RhbmNlb2YgRGVidWcpXG5cdFx0XHRcdGxpbmUubGluZXMuZm9yRWFjaChtYXJrRXhwb3J0TGluZXMpXG5cdFx0fVxuXHRcdHRoaXMubGluZXMuZm9yRWFjaChtYXJrRXhwb3J0TGluZXMpXG5cdH0sXG5cdE9ialNpbXBsZSgpIHtcblx0XHRjb25zdCBrZXlzID0gbmV3IFNldCgpXG5cdFx0dGhpcy5wYWlycy5mb3JFYWNoKHBhaXIgPT4ge1xuXHRcdFx0Y3guY2hlY2soIWtleXMuaGFzKHBhaXIua2V5KSwgcGFpci5sb2MsICgpID0+IGBEdXBsaWNhdGUga2V5ICR7cGFpci5rZXl9YClcblx0XHRcdGtleXMuYWRkKHBhaXIua2V5KVxuXHRcdFx0cGFpci52YWx1ZS52ZXJpZnkoKVxuXHRcdH0pXG5cdH0sXG5cdFF1b3RlKCkge1xuXHRcdHRoaXMucGFydHMuZm9yRWFjaChfID0+IHtcblx0XHRcdGlmICh0eXBlb2YgXyAhPT0gJ3N0cmluZycpXG5cdFx0XHRcdF8udmVyaWZ5KClcblx0XHR9KVxuXHR9LFxuXHRTcGVjaWFsRG8oKSB7IH0sXG5cdFNwZWNpYWxWYWwoKSB7IH0sXG5cdFNwbGF0KCkgeyB0aGlzLnNwbGF0dGVkLnZlcmlmeSgpIH0sXG5cdFlpZWxkKCkge1xuXHRcdGN4LmNoZWNrKGlzSW5HZW5lcmF0b3IsIHRoaXMubG9jLCAnQ2Fubm90IHlpZWxkIG91dHNpZGUgb2YgZ2VuZXJhdG9yIGNvbnRleHQnKVxuXHRcdHRoaXMueWllbGRlZC52ZXJpZnkoKVxuXHR9LFxuXHRZaWVsZFRvKCkge1xuXHRcdGN4LmNoZWNrKGlzSW5HZW5lcmF0b3IsIHRoaXMubG9jLCAnQ2Fubm90IHlpZWxkIG91dHNpZGUgb2YgZ2VuZXJhdG9yIGNvbnRleHQnKVxuXHRcdHRoaXMueWllbGRlZFRvLnZlcmlmeSgpXG5cdH1cbn0pXG5cbmZ1bmN0aW9uIGJsb2NrQmFnT3JNYXAoKSB7XG5cdGNvbnN0IHsgbGlzdE1hcExlbmd0aCB9ID0gdmVyaWZ5TGluZXModGhpcy5saW5lcylcblx0dnIuYmxvY2tUb0xlbmd0aC5zZXQodGhpcywgbGlzdE1hcExlbmd0aClcbn1cblxuZnVuY3Rpb24gdmVyaWZ5Q2FzZSgpIHtcblx0Y29uc3QgbmV3TG9jYWxzID0gW11cblx0b3BFYWNoKHRoaXMub3BDYXNlZCwgXyA9PiB7XG5cdFx0cmVnaXN0ZXJMb2NhbChfLmFzc2lnbmVlKVxuXHRcdF8udmVyaWZ5KClcblx0XHRuZXdMb2NhbHMucHVzaChfLmFzc2lnbmVlKVxuXHR9KVxuXHRwbHVzTG9jYWxzKG5ld0xvY2FscywgKCkgPT4ge1xuXHRcdHZtKHRoaXMucGFydHMpXG5cdFx0dm9wKHRoaXMub3BFbHNlKVxuXHR9KVxufVxuXG5mdW5jdGlvbiB2ZXJpZnlDYXNlUGFydCgpIHtcblx0aWYgKHRoaXMudGVzdCBpbnN0YW5jZW9mIFBhdHRlcm4pIHtcblx0XHR0aGlzLnRlc3QudHlwZS52ZXJpZnkoKVxuXHRcdHRoaXMudGVzdC5wYXR0ZXJuZWQudmVyaWZ5KClcblx0XHR2bSh0aGlzLnRlc3QubG9jYWxzKVxuXHRcdHRoaXMudGVzdC5sb2NhbHMuZm9yRWFjaChyZWdpc3RlckxvY2FsKVxuXHRcdHBsdXNMb2NhbHModGhpcy50ZXN0LmxvY2FscywgKCkgPT4gdGhpcy5yZXN1bHQudmVyaWZ5KCkpXG5cdH0gZWxzZSB7XG5cdFx0dGhpcy50ZXN0LnZlcmlmeSgpXG5cdFx0dGhpcy5yZXN1bHQudmVyaWZ5KClcblx0fVxufVxuXG5jb25zdFxuXHRnZXRMb2NhbERlY2xhcmUgPSAobmFtZSwgYWNjZXNzTG9jKSA9PiB7XG5cdFx0Y29uc3QgZGVjbGFyZSA9IGxvY2Fscy5nZXQobmFtZSlcblx0XHRjeC5jaGVjayhkZWNsYXJlICE9PSB1bmRlZmluZWQsIGFjY2Vzc0xvYywgKCkgPT5cblx0XHRcdGBObyBzdWNoIGxvY2FsICR7Y29kZShuYW1lKX0uXFxuTG9jYWxzIGFyZTpcXG4ke2NvZGUobWFwS2V5cyhsb2NhbHMpLmpvaW4oJyAnKSl9LmApXG5cdFx0cmV0dXJuIGRlY2xhcmVcblx0fSxcblxuXHRsaW5lTmV3TG9jYWxzID0gbGluZSA9PlxuXHRcdGxpbmUgaW5zdGFuY2VvZiBBc3NpZ24gP1xuXHRcdFx0WyBsaW5lLmFzc2lnbmVlIF0gOlxuXHRcdFx0bGluZSBpbnN0YW5jZW9mIEFzc2lnbkRlc3RydWN0dXJlID9cblx0XHRcdGxpbmUuYXNzaWduZWVzIDpcblx0XHRcdFsgXSxcblxuXHR2ZXJpZnlVc2VzID0gKHVzZXMsIGRlYnVnVXNlcykgPT4ge1xuXHRcdGNvbnN0IHVzZUxvY2FscyA9IFtdXG5cdFx0Y29uc3Rcblx0XHRcdHZlcmlmeVVzZSA9IHVzZSA9PiB7XG5cdFx0XHRcdHVzZS51c2VkLmZvckVhY2godXNlTG9jYWwpXG5cdFx0XHRcdG9wRWFjaCh1c2Uub3BVc2VEZWZhdWx0LCB1c2VMb2NhbClcblx0XHRcdH0sXG5cdFx0XHR1c2VMb2NhbCA9IF8gPT4ge1xuXHRcdFx0XHRyZWdpc3RlckxvY2FsKF8pXG5cdFx0XHRcdHVzZUxvY2Fscy5wdXNoKF8pXG5cdFx0XHR9XG5cdFx0dXNlcy5mb3JFYWNoKHZlcmlmeVVzZSlcblx0XHR3aXRoSW5EZWJ1Zyh0cnVlLCAoKSA9PiBkZWJ1Z1VzZXMuZm9yRWFjaCh2ZXJpZnlVc2UpKVxuXHRcdHJldHVybiB1c2VMb2NhbHNcblx0fSxcblxuXHR2ZXJpZnlMaW5lcyA9IGxpbmVzID0+IHtcblx0XHRjb25zdCBuZXdMb2NhbHMgPSBbIF1cblx0XHQvLyBGaXJzdCwgZ2V0IGxvY2FscyBmb3IgdGhlIHdob2xlIGJsb2NrLlxuXHRcdGNvbnN0IGdldExpbmVMb2NhbHMgPSBsaW5lID0+IHtcblx0XHRcdGlmIChsaW5lIGluc3RhbmNlb2YgRGVidWcpXG5cdFx0XHRcdHdpdGhJbkRlYnVnKHRydWUsICgpID0+IGxpbmUubGluZXMuZm9yRWFjaChnZXRMaW5lTG9jYWxzKSlcblx0XHRcdGVsc2Uge1xuXHRcdFx0XHRjb25zdCBuZXdzID0gbGluZU5ld0xvY2FscyhsaW5lKVxuXHRcdFx0XHRuZXdzLmZvckVhY2gocmVnaXN0ZXJMb2NhbClcblx0XHRcdFx0bmV3TG9jYWxzLnB1c2goLi4ubmV3cylcblx0XHRcdH1cblx0XHR9XG5cblx0XHRsaW5lcy5mb3JFYWNoKGdldExpbmVMb2NhbHMpXG5cblx0XHRjb25zdCB0aGlzQmxvY2tMb2NhbE5hbWVzID0gbmV3IFNldCgpXG5cdFx0Y29uc3Qgc2hhZG93ZWQgPSBuZXcgTWFwKClcblxuXHRcdGxldCBsaXN0TWFwTGVuZ3RoID0gMFxuXG5cdFx0Y29uc3QgdmVyaWZ5TGluZSA9IGxpbmUgPT4ge1xuXHRcdFx0aWYgKGxpbmUgaW5zdGFuY2VvZiBEZWJ1Zylcblx0XHRcdFx0Ly8gVE9ETzogRG8gYW55dGhpbmcgaW4gdGhpcyBzaXR1YXRpb24/XG5cdFx0XHRcdC8vIGN4LmNoZWNrKCFpbkRlYnVnLCBsaW5lLmxvYywgJ1JlZHVuZGFudCBgZGVidWdgLicpXG5cdFx0XHRcdHdpdGhJbkRlYnVnKHRydWUsICgpID0+IGxpbmUubGluZXMuZm9yRWFjaCh2ZXJpZnlMaW5lKSlcblx0XHRcdGVsc2Uge1xuXHRcdFx0XHR2ZXJpZnlJc1N0YXRlbWVudChsaW5lKVxuXHRcdFx0XHRsaW5lTmV3TG9jYWxzKGxpbmUpLmZvckVhY2gobCA9PiB7XG5cdFx0XHRcdFx0Y29uc3QgZ290ID0gbG9jYWxzLmdldChsLm5hbWUpXG5cdFx0XHRcdFx0aWYgKGdvdCAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0XHRjeC5jaGVjayghdGhpc0Jsb2NrTG9jYWxOYW1lcy5oYXMobC5uYW1lKSwgbC5sb2MsXG5cdFx0XHRcdFx0XHRcdCgpID0+IGBBIGxvY2FsICR7Y29kZShsLm5hbWUpfSBpcyBhbHJlYWR5IGluIHRoaXMgYmxvY2suYClcblx0XHRcdFx0XHRcdHNoYWRvd2VkLnNldChsLm5hbWUsIGdvdClcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0bG9jYWxzLnNldChsLm5hbWUsIGwpXG5cdFx0XHRcdFx0dGhpc0Jsb2NrTG9jYWxOYW1lcy5hZGQobC5uYW1lKVxuXHRcdFx0XHR9KVxuXHRcdFx0XHRpZiAobGluZSBpbnN0YW5jZW9mIEJhZ0VudHJ5IHx8IGxpbmUgaW5zdGFuY2VvZiBNYXBFbnRyeSkge1xuXHRcdFx0XHRcdHNldEVudHJ5SW5kZXgobGluZSwgbGlzdE1hcExlbmd0aClcblx0XHRcdFx0XHRsaXN0TWFwTGVuZ3RoID0gbGlzdE1hcExlbmd0aCArIDFcblx0XHRcdFx0fVxuXHRcdFx0XHRsaW5lLnZlcmlmeSgpXG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cGx1c1BlbmRpbmdCbG9ja0xvY2FscyhuZXdMb2NhbHMsICgpID0+IGxpbmVzLmZvckVhY2godmVyaWZ5TGluZSkpXG5cblx0XHRuZXdMb2NhbHMuZm9yRWFjaChsID0+IHtcblx0XHRcdGNvbnN0IHMgPSBzaGFkb3dlZC5nZXQobC5uYW1lKVxuXHRcdFx0aWYgKHMgPT09IHVuZGVmaW5lZClcblx0XHRcdFx0bG9jYWxzLmRlbGV0ZShsLm5hbWUpXG5cdFx0XHRlbHNlXG5cdFx0XHRcdGxvY2Fscy5zZXQobC5uYW1lLCBzKVxuXHRcdH0pXG5cblx0XHRyZXR1cm4geyBuZXdMb2NhbHMsIGxpc3RNYXBMZW5ndGggfVxuXHR9LFxuXG5cdHZlcmlmeUlzU3RhdGVtZW50ID0gbGluZSA9PiB7XG5cdFx0Y29uc3QgaXNTdGF0ZW1lbnQgPVxuXHRcdFx0bGluZSBpbnN0YW5jZW9mIERvIHx8XG5cdFx0XHRsaW5lIGluc3RhbmNlb2YgQ2FsbCB8fFxuXHRcdFx0bGluZSBpbnN0YW5jZW9mIFlpZWxkIHx8XG5cdFx0XHRsaW5lIGluc3RhbmNlb2YgWWllbGRUbyB8fFxuXHRcdFx0bGluZSBpbnN0YW5jZW9mIEJhZ0VudHJ5IHx8XG5cdFx0XHRsaW5lIGluc3RhbmNlb2YgTWFwRW50cnkgfHxcblx0XHRcdGxpbmUgaW5zdGFuY2VvZiBTcGVjaWFsRG9cblx0XHRjeC5jaGVjayhpc1N0YXRlbWVudCwgbGluZS5sb2MsICdFeHByZXNzaW9uIGluIHN0YXRlbWVudCBwb3NpdGlvbi4nKVxuXHR9XG4iXSwic291cmNlUm9vdCI6Ii9zcmMifQ==