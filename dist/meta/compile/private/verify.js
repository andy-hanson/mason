if (typeof define !== 'function') var define = require('amdefine')(module);define(['exports', 'module', '../CompileError', '../Expression', './U/Bag', './U/op', './U/util', './VerifyResults'], function (exports, module, _CompileError, _Expression, _UBag, _UOp, _UUtil, _VerifyResults) {
	'use strict';

	module.exports = verify;

	function _interopRequire(obj) { return obj && obj.__esModule ? obj['default'] : obj; }

	function _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) arr2[i] = arr[i]; return arr2; } else { return Array.from(arr); } }

	var _VerifyResults2 = _interopRequire(_VerifyResults);

	const vm = function (es) {
		return es.forEach(function (e) {
			return e.verify();
		});
	};
	const vop = function (op) {
		return (0, _UOp.opEach)(op, function (_) {
			return _.verify();
		});
	};

	let cx, locals,
	// Locals for this block.
	// Replaces `locals` when entering into sub-function.
	pendingBlockLocals, isInDebug, isInGenerator, opLoop, vr;

	const init = function (_cx) {
		cx = _cx;
		locals = new Map();
		pendingBlockLocals = [];
		isInDebug = false;
		isInGenerator = false;
		opLoop = null;
		vr = new _VerifyResults2();
	},
	     
	// Release for garbage collection
	uninit = function () {
		locals = pendingBlockLocals = opLoop = vr = undefined;
	},
	      withInGenerator = function (_isInGenerator, fun) {
		const g = isInGenerator;
		isInGenerator = _isInGenerator;
		fun();
		isInGenerator = g;
	},
	      plusLocals = function (addedLocals, fun) {
		const shadowed = new Map();
		addedLocals.forEach(function (l) {
			const got = locals.get(l.name);
			if (got !== undefined) shadowed.set(l.name, got);
			locals.set(l.name, l);
		});
		fun();
		addedLocals.forEach(function (l) {
			const s = shadowed.get(l.name);
			if (s === undefined) locals.delete(l.name);else locals.set(l.name, s);
		});
	},
	      plusPendingBlockLocals = function (pending, fun) {
		const oldLength = pendingBlockLocals.length;
		pendingBlockLocals.push.apply(pendingBlockLocals, _toConsumableArray(pending));
		fun();
		while (pendingBlockLocals.length > oldLength) pendingBlockLocals.pop();
	},
	      withInLoop = function (loop, fun) {
		const l = opLoop;
		opLoop = loop;
		fun();
		opLoop = l;
	},
	      withInDebug = function (_isInDebug, fun) {
		const d = isInDebug;
		isInDebug = _isInDebug;
		fun();
		isInDebug = d;
	},
	      withBlockLocals = function (fun) {
		const bl = pendingBlockLocals;
		pendingBlockLocals = [];
		plusLocals(bl, fun);
		pendingBlockLocals = bl;
	},
	      accessLocal = function (declare, access, isDebugAccess) {
		return _addAccess(vr.localToInfo.get(declare), access, isDebugAccess);
	},
	      accessLocalForReturn = function (declare, access) {
		const info = vr.localToInfo.get(declare);
		_addAccess(info, access, info.isInDebug);
	},
	      _addAccess = function (localInfo, access, isDebugAccess) {
		return (isDebugAccess ? localInfo.debugAccesses : localInfo.nonDebugAccesses).push(access);
	},
	     

	// Vr setters
	setEndLoop = function (endLoop, loop) {
		vr.endLoopToLoop.set(endLoop, loop);
	},
	      registerLocal = function (local) {
		vr.localToInfo.set(local, (0, _VerifyResults.LocalInfo)(isInDebug, [], []));
	},
	      setEntryIndex = function (listMapEntry, index) {
		vr.entryToIndex.set(listMapEntry, index);
	};

	function verify(cx, e) {
		init(cx);
		e.verify();
		verifyLocalUse();
		const out = vr;
		uninit();
		return out;
	}

	const verifyLocalUse = function () {
		vr.localToInfo.forEach(function (info, local) {
			if (!(local instanceof _Expression.LocalDeclareRes)) {
				const noNonDebug = (0, _UBag.isEmpty)(info.nonDebugAccesses);
				if (noNonDebug && (0, _UBag.isEmpty)(info.debugAccesses)) cx.warn(local.loc, function () {
					return 'Unused local variable ' + (0, _CompileError.code)(local.name) + '.';
				});else if (info.isInDebug) cx.warnIf(!noNonDebug, function () {
					return (0, _UBag.head)(info.nonDebugAccesses).loc;
				}, function () {
					return 'Debug-only local ' + (0, _CompileError.code)(local.name) + ' used outside of debug.';
				});else cx.warnIf(noNonDebug, local.loc, function () {
					return 'Local ' + (0, _CompileError.code)(local.name) + ' used only in debug.';
				});
			}
		});
	};

	(0, _UUtil.implementMany)(_Expression, 'verify', {
		Assign: function () {
			var _this = this;

			const doV = function () {
				_this.assignee.verify();
				_this.value.verify();
			};
			if (this.assignee.isLazy) withBlockLocals(doV);else doV();
		},
		BlockDo: function () {
			verifyLines(this.lines);
		},
		BlockWithReturn: function () {
			var _this2 = this;

			var _verifyLines = verifyLines(this.lines);

			const newLocals = _verifyLines.newLocals;

			plusLocals(newLocals, function () {
				return _this2.returned.verify();
			});
		},
		BlockObj: function () {
			var _this3 = this;

			var _verifyLines2 = verifyLines(this.lines);

			const newLocals = _verifyLines2.newLocals;

			this.keys.forEach(function (_) {
				return accessLocalForReturn(_, _this3);
			});
			(0, _UOp.opEach)(this.opObjed, function (_) {
				return plusLocals(newLocals, function () {
					return _.verify();
				});
			});
		},
		BlockBag: blockBagOrMap,
		BlockMap: blockBagOrMap,
		BlockWrap: function () {
			this.block.verify();
		},
		CaseDo: verifyCase,
		CaseVal: verifyCase,
		// Only reach here for in/out condition
		Debug: function () {
			verifyLines([this]);
		},
		EndLoop: function () {
			var _this4 = this;

			(0, _UOp.ifElse)(opLoop, function (_) {
				return setEndLoop(_this4, _);
			}, function () {
				return cx.fail(_this4.loc, 'Not in a loop.');
			});
		},
		Fun: function () {
			var _this5 = this;

			withBlockLocals(function () {
				cx.check(_this5.opResDeclare === null || _this5.block instanceof _Expression.BlockVal, _this5.loc, 'Function with return condition must return something.');
				_this5.args.forEach(function (arg) {
					return vop(arg.opType);
				});
				withInGenerator(_this5.isGenerator, function () {
					const allArgs = (0, _UBag.cat)(_this5.args, _this5.opRestArg);
					allArgs.forEach(function (_) {
						return registerLocal(_);
					});
					plusLocals(allArgs, function () {
						vop(_this5.opIn);
						_this5.block.verify();
						(0, _UOp.opEach)(_this5.opResDeclare, function (_) {
							_.verify();
							registerLocal(_);
						});
						const verifyOut = function () {
							return (0, _UOp.opEach)(_this5.opOut, function (_) {
								return _.verify();
							});
						};
						(0, _UOp.ifElse)(_this5.opResDeclare, function (rd) {
							return plusLocals([rd], verifyOut);
						}, verifyOut);
					});
				});
			});
		},
		LocalAccess: function () {
			var _this6 = this;

			const declare = locals.get(this.name);
			cx.check(declare !== undefined, this.loc, function () {
				return 'No such local ' + (0, _CompileError.code)(_this6.name) + '.\nLocals are:\n' + (0, _CompileError.code)((0, _UUtil.mapKeys)(locals).join(' ')) + '.';
			});
			vr.accessToLocal.set(this, declare);
			accessLocal(declare, this, isInDebug);
		},
		Loop: function () {
			var _this7 = this;

			withInLoop(this, function () {
				return _this7.block.verify();
			});
		},
		// Adding LocalDeclares to the available locals is done by Fun or lineNewLocals.
		LocalDeclare: function () {
			vop(this.opType);
		},
		MapEntry: function () {
			this.key.verify();
			this.val.verify();
		},
		Module: function () {
			var _this8 = this;

			const useLocals = verifyUses(this.uses, this.debugUses);
			plusLocals(useLocals, function () {
				var _verifyLines3 = verifyLines(_this8.lines);

				const newLocals = _verifyLines3.newLocals;

				_this8.exports.forEach(function (ex) {
					return accessLocalForReturn(ex, _this8);
				});
				(0, _UOp.opEach)(_this8.opDefaultExport, function (_) {
					return plusLocals(newLocals, function () {
						return _.verify();
					});
				});
			});

			const exports = (0, _UUtil.newSet)(this.exports);
			const markExportLines = function (line) {
				if (line instanceof _Expression.Assign && exports.has(line.assignee) || line instanceof _Expression.AssignDestructure && line.assignees.some(function (_) {
					return exports.has(_);
				})) vr.exportAssigns.add(line);else if (line instanceof _Expression.Debug) line.lines.forEach(markExportLines);
			};
			this.lines.forEach(markExportLines);
		},
		Yield: function () {
			cx.check(isInGenerator, this.loc, 'Cannot yield outside of generator context');
			this.yielded.verify();
		},
		YieldTo: function () {
			cx.check(isInGenerator, this.loc, 'Cannot yield outside of generator context');
			this.yieldedTo.verify();
		},

		// These ones just recurse to their children.
		AssignDestructure: function () {
			this.value.verify();
			vm(this.assignees);
		},
		Call: function () {
			this.called.verify();
			vm(this.args);
		},
		CaseDoPart: verifyCasePart,
		CaseValPart: verifyCasePart,
		GlobalAccess: function () {},
		ObjSimple: function () {
			const keys = new Set();
			this.pairs.forEach(function (pair) {
				cx.check(!keys.has(pair.key), pair.loc, function () {
					return 'Duplicate key ' + pair.key;
				});
				keys.add(pair.key);
				pair.value.verify();
			});
		},
		Lazy: function () {
			var _this9 = this;

			withBlockLocals(function () {
				return _this9.value.verify();
			});
		},
		BagEntry: function () {
			this.value.verify();
		},
		ListSimple: function () {
			vm(this.parts);
		},
		NumberLiteral: function () {},
		Member: function () {
			this.object.verify();
		},
		Quote: function () {
			this.parts.forEach(function (_) {
				if (typeof _ !== 'string') _.verify();
			});
		},
		Special: function () {},
		Splat: function () {
			this.splatted.verify();
		}
	});

	function blockBagOrMap() {
		var _verifyLines4 = verifyLines(this.lines);

		const listMapLength = _verifyLines4.listMapLength;

		vr.blockToLength.set(this, listMapLength);
	}

	function verifyCase() {
		var _this10 = this;

		const newLocals = [];
		(0, _UOp.opEach)(this.opCased, function (_) {
			registerLocal(_.assignee);
			_.verify();
			newLocals.push(_.assignee);
		});
		plusLocals(newLocals, function () {
			vm(_this10.parts);
			vop(_this10.opElse);
		});
	}

	function verifyCasePart() {
		var _this11 = this;

		if (this.test instanceof _Expression.Pattern) {
			this.test.type.verify();
			this.test.patterned.verify();
			vm(this.test.locals);
			this.test.locals.forEach(registerLocal);
			plusLocals(this.test.locals, function () {
				return _this11.result.verify();
			});
		} else {
			this.test.verify();
			this.result.verify();
		}
	}

	const verifyUses = function (uses, debugUses) {
		const useLocals = [];
		const verifyUse = function (use) {
			use.used.forEach(useLocal);
			(0, _UOp.opEach)(use.opUseDefault, useLocal);
		},
		      useLocal = function (_) {
			registerLocal(_);
			useLocals.push(_);
		};
		uses.forEach(function (use) {
			if (!(use instanceof _Expression.UseDo)) verifyUse(use);
		});
		withInDebug(true, function () {
			return debugUses.forEach(verifyUse);
		});
		return useLocals;
	},
	      verifyLines = function (lines) {
		const newLocals = [];
		// First, get locals for the whole block.
		const getLineLocals = function (line) {
			if (line instanceof _Expression.Debug) withInDebug(true, function () {
				return line.lines.forEach(getLineLocals);
			});else {
				const news = lineNewLocals(line);
				news.forEach(registerLocal);
				newLocals.push.apply(newLocals, _toConsumableArray(news));
			}
		};

		lines.forEach(getLineLocals);

		const thisBlockLocalNames = new Set();
		const shadowed = new Map();

		let listMapLength = 0;

		const verifyLine = function (line) {
			if (line instanceof _Expression.Debug)
				// TODO: Do anything in this situation?
				// cx.check(!inDebug, line.loc, 'Redundant `debug`.')
				withInDebug(true, function () {
					return line.lines.forEach(verifyLine);
				});else {
				verifyIsStatement(line);
				lineNewLocals(line).forEach(function (l) {
					const got = locals.get(l.name);
					if (got !== undefined) {
						cx.check(!thisBlockLocalNames.has(l.name), l.loc, function () {
							return 'A local ' + (0, _CompileError.code)(l.name) + ' is already in this block.';
						});
						shadowed.set(l.name, got);
					}
					locals.set(l.name, l);
					thisBlockLocalNames.add(l.name);
				});
				if (line instanceof _Expression.BagEntry || line instanceof _Expression.MapEntry) {
					setEntryIndex(line, listMapLength);
					listMapLength = listMapLength + 1;
				}
				line.verify();
			}
		};

		plusPendingBlockLocals(newLocals, function () {
			return lines.forEach(verifyLine);
		});

		newLocals.forEach(function (l) {
			const s = shadowed.get(l.name);
			if (s === undefined) locals.delete(l.name);else locals.set(l.name, s);
		});

		return { newLocals: newLocals, listMapLength: listMapLength };
	},
	      verifyIsStatement = function (line) {
		const isStatement = line instanceof _Expression.Do || line instanceof _Expression.Call || line instanceof _Expression.Yield || line instanceof _Expression.YieldTo || line instanceof _Expression.BagEntry || line instanceof _Expression.MapEntry || line instanceof _Expression.Special && line.kind === _Expression.SP_Debugger ||
		// OK, used to mean `pass`
		line instanceof _Expression.GlobalAccess && line.name === 'null';
		cx.check(isStatement, line.loc, 'Expression in statement position.');
	},
	      lineNewLocals = function (line) {
		return line instanceof _Expression.Assign ? [line.assignee] : line instanceof _Expression.AssignDestructure ? line.assignees : [];
	};
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1ldGEvY29tcGlsZS9wcml2YXRlL3ZlcmlmeS5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7a0JBb0h3QixNQUFNOzs7Ozs7OztBQTFHOUIsT0FBTSxFQUFFLEdBQUcsVUFBQSxFQUFFO1NBQUksRUFBRSxDQUFDLE9BQU8sQ0FBQyxVQUFBLENBQUM7VUFBSSxDQUFDLENBQUMsTUFBTSxFQUFFO0dBQUEsQ0FBQztFQUFBLENBQUE7QUFDNUMsT0FBTSxHQUFHLEdBQUcsVUFBQSxFQUFFO1NBQUksU0FMRCxNQUFNLEVBS0UsRUFBRSxFQUFFLFVBQUEsQ0FBQztVQUFJLENBQUMsQ0FBQyxNQUFNLEVBQUU7R0FBQSxDQUFDO0VBQUEsQ0FBQTs7QUFFN0MsS0FDQyxFQUFFLEVBQ0YsTUFBTTs7O0FBR04sbUJBQWtCLEVBQ2xCLFNBQVMsRUFDVCxhQUFhLEVBQ2IsTUFBTSxFQUNOLEVBQUUsQ0FBQTs7QUFFSCxPQUNDLElBQUksR0FBRyxVQUFBLEdBQUcsRUFBSTtBQUNiLElBQUUsR0FBRyxHQUFHLENBQUE7QUFDUixRQUFNLEdBQUcsSUFBSSxHQUFHLEVBQUUsQ0FBQTtBQUNsQixvQkFBa0IsR0FBRyxFQUFFLENBQUE7QUFDdkIsV0FBUyxHQUFHLEtBQUssQ0FBQTtBQUNqQixlQUFhLEdBQUcsS0FBSyxDQUFBO0FBQ3JCLFFBQU0sR0FBRyxJQUFJLENBQUE7QUFDYixJQUFFLEdBQUcscUJBQW1CLENBQUE7RUFDeEI7OztBQUVELE9BQU0sR0FBRyxZQUFNO0FBQ2QsUUFBTSxHQUFHLGtCQUFrQixHQUFHLE1BQU0sR0FBRyxFQUFFLEdBQUcsU0FBUyxDQUFBO0VBQ3JEO09BRUQsZUFBZSxHQUFHLFVBQUMsY0FBYyxFQUFFLEdBQUcsRUFBSztBQUMxQyxRQUFNLENBQUMsR0FBRyxhQUFhLENBQUE7QUFDdkIsZUFBYSxHQUFHLGNBQWMsQ0FBQTtBQUM5QixLQUFHLEVBQUUsQ0FBQTtBQUNMLGVBQWEsR0FBRyxDQUFDLENBQUE7RUFDakI7T0FFRCxVQUFVLEdB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QUVELGlCQUFpQixHQUFHLFVBQUEsSUFBSSxFQUFJO0FBQzNCLFFBQU0sV0FBVyxHQUNoQixJQUFJLHdCQTNYb0QsRUFBRSxBQTJYeEMsSUFDbEIsSUFBSSx3QkE1WHVDLElBQUksQUE0WDNCLElBQ3BCLElBQUksd0JBNVgyRCxLQUFLLEFBNFgvQyxJQUNyQixJQUFJLHdCQTdYa0UsT0FBTyxBQTZYdEQsSUFDdkIsSUFBSSx3QkEvWHNFLFFBQVEsQUErWDFELElBQ3hCLElBQUksd0JBL1hXLFFBQVEsQUErWEMsSUFDeEIsSUFBSSx3QkFoWThCLE9BQU8sQUFnWWxCLElBQUksSUFBSSxDQUFDLElBQUksaUJBaFlPLFdBQVcsQUFnWUY7O0FBRXBELE1BQUksd0JBbll3RCxZQUFZLEFBbVk1QyxJQUFJLElBQUksQ0FBQyxJQUFJLEtBQUssTUFBTSxDQUFBO0FBQ3JELElBQUUsQ0FBQyxLQUFLLENBQUMsV0FBVyxFQUFFLElBQUksQ0FBQyxHQUFHLEVBQUUsbUNBQW1DLENBQUMsQ0FBQTtFQUNwRTtPQUVELGFBQWEsR0FBRyxVQUFBLElBQUk7U0FDbkIsSUFBSSx3QkF4WUcsTUFBTSxBQXdZUyxHQUNyQixDQUFFLElBQUksQ0FBQyxRQUFRLENBQUUsR0FDakIsSUFBSSx3QkExWVUsaUJBQWlCLEFBMFlFLEdBQ2pDLElBQUksQ0FBQyxTQUFTLEdBQ2QsRUFBRztFQUFBLENBQUEiLCJmaWxlIjoibWV0YS9jb21waWxlL3ByaXZhdGUvdmVyaWZ5LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY29kZSB9IGZyb20gJy4uL0NvbXBpbGVFcnJvcidcbmltcG9ydCAqIGFzIEVFeHBvcnRzIGZyb20gJy4uL0V4cHJlc3Npb24nXG5pbXBvcnQgeyBBc3NpZ24sIEFzc2lnbkRlc3RydWN0dXJlLCBCbG9ja1ZhbCwgQ2FsbCwgRGVidWcsIERvLCBHbG9iYWxBY2Nlc3MsIEJhZ0VudHJ5LFxuXHRMb2NhbERlY2xhcmVSZXMsIE1hcEVudHJ5LCBQYXR0ZXJuLCBTcGVjaWFsLCBTUF9EZWJ1Z2dlciwgVXNlRG8sIFlpZWxkLCBZaWVsZFRvXG5cdH0gZnJvbSAnLi4vRXhwcmVzc2lvbidcbmltcG9ydCB7IGNhdCwgaGVhZCwgaXNFbXB0eSB9IGZyb20gJy4vVS9CYWcnXG5pbXBvcnQgeyBpZkVsc2UsIG9wRWFjaCB9IGZyb20gJy4vVS9vcCdcbmltcG9ydCB7IGltcGxlbWVudE1hbnksIG1hcEtleXMsIG5ld1NldCB9IGZyb20gJy4vVS91dGlsJ1xuaW1wb3J0IFZlcmlmeVJlc3VsdHMsIHsgTG9jYWxJbmZvIH0gZnJvbSAnLi9WZXJpZnlSZXN1bHRzJ1xuXG5jb25zdCB2bSA9IGVzID0+IGVzLmZvckVhY2goZSA9PiBlLnZlcmlmeSgpKVxuY29uc3Qgdm9wID0gb3AgPT4gb3BFYWNoKG9wLCBfID0+IF8udmVyaWZ5KCkpXG5cbmxldFxuXHRjeCxcblx0bG9jYWxzLFxuXHQvLyBMb2NhbHMgZm9yIHRoaXMgYmxvY2suXG5cdC8vIFJlcGxhY2VzIGBsb2NhbHNgIHdoZW4gZW50ZXJpbmcgaW50byBzdWItZnVuY3Rpb24uXG5cdHBlbmRpbmdCbG9ja0xvY2Fscyxcblx0aXNJbkRlYnVnLFxuXHRpc0luR2VuZXJhdG9yLFxuXHRvcExvb3AsXG5cdHZyXG5cbmNvbnN0XG5cdGluaXQgPSBfY3ggPT4ge1xuXHRcdGN4ID0gX2N4XG5cdFx0bG9jYWxzID0gbmV3IE1hcCgpXG5cdFx0cGVuZGluZ0Jsb2NrTG9jYWxzID0gW11cblx0XHRpc0luRGVidWcgPSBmYWxzZVxuXHRcdGlzSW5HZW5lcmF0b3IgPSBmYWxzZVxuXHRcdG9wTG9vcCA9IG51bGxcblx0XHR2ciA9IG5ldyBWZXJpZnlSZXN1bHRzKClcblx0fSxcblx0Ly8gUmVsZWFzZSBmb3IgZ2FyYmFnZSBjb2xsZWN0aW9uXG5cdHVuaW5pdCA9ICgpID0+IHtcblx0XHRsb2NhbHMgPSBwZW5kaW5nQmxvY2tMb2NhbHMgPSBvcExvb3AgPSB2ciA9IHVuZGVmaW5lZFxuXHR9LFxuXG5cdHdpdGhJbkdlbmVyYXRvciA9IChfaXNJbkdlbmVyYXRvciwgZnVuKSA9PiB7XG5cdFx0Y29uc3QgZyA9IGlzSW5HZW5lcmF0b3Jcblx0XHRpc0luR2VuZXJhdG9yID0gX2lzSW5HZW5lcmF0b3Jcblx0XHRmdW4oKVxuXHRcdGlzSW5HZW5lcmF0b3IgPSBnXG5cdH0sXG5cblx0cGx1c0xvY2FscyA9IChhZGRlZExvY2FscywgZnVuKSA9PiB7XG5cdFx0Y29uc3Qgc2hhZG93ZWQgPSBuZXcgTWFwKClcblx0XHRhZGRlZExvY2Fscy5mb3JFYWNoKGwgPT4ge1xuXHRcdFx0Y29uc3QgZ290ID0gbG9jYWxzLmdldChsLm5hbWUpXG5cdFx0XHRpZiAoZ290ICE9PSB1bmRlZmluZWQpXG5cdFx0XHRcdHNoYWRvd2VkLnNldChsLm5hbWUsIGdvdClcblx0XHRcdGxvY2Fscy5zZXQobC5uYW1lLCBsKVxuXHRcdH0pXG5cdFx0ZnVuKClcblx0XHRhZGRlZExvY2Fscy5mb3JFYWNoKGwgPT4ge1xuXHRcdFx0Y29uc3QgcyA9IHNoYWRvd2VkLmdldChsLm5hbWUpXG5cdFx0XHRpZiAocyA9PT0gdW5kZWZpbmVkKVxuXHRcdFx0XHRsb2NhbHMuZGVsZXRlKGwubmFtZSlcblx0XHRcdGVsc2Vcblx0XHRcdFx0bG9jYWxzLnNldChsLm5hbWUsIHMpXG5cdFx0fSlcblx0fSxcblxuXHRwbHVzUGVuZGluZ0Jsb2NrTG9jYWxzID0gKHBlbmRpbmcsIGZ1bikgPT4ge1xuXHRcdGNvbnN0IG9sZExlbmd0aCA9IHBlbmRpbmdCbG9ja0xvY2Fscy5sZW5ndGhcblx0XHRwZW5kaW5nQmxvY2tMb2NhbHMucHVzaCguLi5wZW5kaW5nKVxuXHRcdGZ1bigpXG5cdFx0d2hpbGUgKHBlbmRpbmdCbG9ja0xvY2Fscy5sZW5ndGggPiBvbGRMZW5ndGgpXG5cdFx0XHRwZW5kaW5nQmxvY2tMb2NhbHMucG9wKClcblx0fSxcblxuXHR3aXRoSW5Mb29wID0gKGxvb3AsIGZ1bikgPT4ge1xuXHRcdGNvbnN0IGwgPSBvcExvb3Bcblx0XHRvcExvb3AgPSBsb29wXG5cdFx0ZnVuKClcblx0XHRvcExvb3AgPSBsXG5cdH0sXG5cblx0d2l0aEluRGVidWcgPSAoX2lzSW5EZWJ1ZywgZnVuKSA9PiB7XG5cdFx0Y29uc3QgZCA9IGlzSW5EZWJ1Z1xuXHRcdGlzSW5EZWJ1ZyA9IF9pc0luRGVidWdcblx0XHRmdW4oKVxuXHRcdGlzSW5EZWJ1ZyA9IGRcblx0fSxcblxuXHR3aXRoQmxvY2tMb2NhbHMgPSBmdW4gPT4ge1xuXHRcdGNvbnN0IGJsID0gcGVuZGluZ0Jsb2NrTG9jYWxzXG5cdFx0cGVuZGluZ0Jsb2NrTG9jYWxzID0gW11cblx0XHRwbHVzTG9jYWxzKGJsLCBmdW4pXG5cdFx0cGVuZGluZ0Jsb2NrTG9jYWxzID0gYmxcblx0fSxcblxuXHRhY2Nlc3NMb2NhbCA9IChkZWNsYXJlLCBhY2Nlc3MsIGlzRGVidWdBY2Nlc3MpID0+XG5cdFx0X2FkZEFjY2Vzcyh2ci5sb2NhbFRvSW5mby5nZXQoZGVjbGFyZSksIGFjY2VzcywgaXNEZWJ1Z0FjY2VzcyksXG5cdGFjY2Vzc0xvY2FsRm9yUmV0dXJuID0gKGRlY2xhcmUsIGFjY2VzcykgPT4ge1xuXHRcdGNvbnN0IGluZm8gPSB2ci5sb2NhbFRvSW5mby5nZXQoZGVjbGFyZSlcblx0XHRfYWRkQWNjZXNzKGluZm8sIGFjY2VzcywgaW5mby5pc0luRGVidWcpXG5cdH0sXG5cdF9hZGRBY2Nlc3MgPSAobG9jYWxJbmZvLCBhY2Nlc3MsIGlzRGVidWdBY2Nlc3MpID0+XG5cdFx0KGlzRGVidWdBY2Nlc3MgPyBsb2NhbEluZm8uZGVidWdBY2Nlc3NlcyA6IGxvY2FsSW5mby5ub25EZWJ1Z0FjY2Vzc2VzKS5wdXNoKGFjY2VzcyksXG5cblxuXHQvLyBWciBzZXR0ZXJzXG5cdHNldEVuZExvb3AgPSAoZW5kTG9vcCwgbG9vcCkgPT4ge1xuXHRcdHZyLmVuZExvb3BUb0xvb3Auc2V0KGVuZExvb3AsIGxvb3ApXG5cdH0sXG5cblx0cmVnaXN0ZXJMb2NhbCA9IGxvY2FsID0+IHtcblx0XHR2ci5sb2NhbFRvSW5mby5zZXQobG9jYWwsIExvY2FsSW5mbyhpc0luRGVidWcsIFtdLCBbXSkpXG5cdH0sXG5cblx0c2V0RW50cnlJbmRleCA9IChsaXN0TWFwRW50cnksIGluZGV4KSA9PiB7XG5cdFx0dnIuZW50cnlUb0luZGV4LnNldChsaXN0TWFwRW50cnksIGluZGV4KVxuXHR9XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHZlcmlmeShjeCwgZSkge1xuXHRpbml0KGN4KVxuXHRlLnZlcmlmeSgpXG5cdHZlcmlmeUxvY2FsVXNlKClcblx0Y29uc3Qgb3V0ID0gdnJcblx0dW5pbml0KClcblx0cmV0dXJuIG91dFxufVxuXG5jb25zdCB2ZXJpZnlMb2NhbFVzZSA9ICgpID0+IHtcblx0dnIubG9jYWxUb0luZm8uZm9yRWFjaCgoaW5mbywgbG9jYWwpID0+IHtcblx0XHRpZiAoIShsb2NhbCBpbnN0YW5jZW9mIExvY2FsRGVjbGFyZVJlcykpIHtcblx0XHRcdGNvbnN0IG5vTm9uRGVidWcgPSBpc0VtcHR5KGluZm8ubm9uRGVidWdBY2Nlc3Nlcylcblx0XHRcdGlmIChub05vbkRlYnVnICYmIGlzRW1wdHkoaW5mby5kZWJ1Z0FjY2Vzc2VzKSlcblx0XHRcdFx0Y3gud2Fybihsb2NhbC5sb2MsICgpID0+IGBVbnVzZWQgbG9jYWwgdmFyaWFibGUgJHtjb2RlKGxvY2FsLm5hbWUpfS5gKVxuXHRcdFx0ZWxzZSBpZiAoaW5mby5pc0luRGVidWcpXG5cdFx0XHRcdGN4Lndhcm5JZighbm9Ob25EZWJ1ZywgKCkgPT4gaGVhZChpbmZvLm5vbkRlYnVnQWNjZXNzZXMpLmxvYywgKCkgPT5cblx0XHRcdFx0XHRgRGVidWctb25seSBsb2NhbCAke2NvZGUobG9jYWwubmFtZSl9IHVzZWQgb3V0c2lkZSBvZiBkZWJ1Zy5gKVxuXHRcdFx0ZWxzZVxuXHRcdFx0XHRjeC53YXJuSWYobm9Ob25EZWJ1ZywgbG9jYWwubG9jLCAoKSA9PlxuXHRcdFx0XHRcdGBMb2NhbCAke2NvZGUobG9jYWwubmFtZSl9IHVzZWQgb25seSBpbiBkZWJ1Zy5gKVxuXHRcdH1cblx0fSlcbn1cblxuaW1wbGVtZW50TWFueShFRXhwb3J0cywgJ3ZlcmlmeScsIHtcblx0QXNzaWduKCkge1xuXHRcdGNvbnN0IGRvViA9ICgpID0+IHtcblx0XHRcdHRoaXMuYXNzaWduZWUudmVyaWZ5KClcblx0XHRcdHRoaXMudmFsdWUudmVyaWZ5KClcblx0XHR9XG5cdFx0aWYgKHRoaXMuYXNzaWduZWUuaXNMYXp5KVxuXHRcdFx0d2l0aEJsb2NrTG9jYWxzKGRvVilcblx0XHRlbHNlXG5cdFx0XHRkb1YoKVxuXHR9LFxuXHRCbG9ja0RvKCkgeyB2ZXJpZnlMaW5lcyh0aGlzLmxpbmVzKSB9LFxuXHRCbG9ja1dpdGhSZXR1cm4oKSB7XG5cdFx0Y29uc3QgeyBuZXdMb2NhbHMgfSA9IHZlcmlmeUxpbmVzKHRoaXMubGluZXMpXG5cdFx0cGx1c0xvY2FscyhuZXdMb2NhbHMsICgpID0+IHRoaXMucmV0dXJuZWQudmVyaWZ5KCkpXG5cdH0sXG5cdEJsb2NrT2JqKCkge1xuXHRcdGNvbnN0IHsgbmV3TG9jYWxzIH0gPSB2ZXJpZnlMaW5lcyh0aGlzLmxpbmVzKVxuXHRcdHRoaXMua2V5cy5mb3JFYWNoKF8gPT4gYWNjZXNzTG9jYWxGb3JSZXR1cm4oXywgdGhpcykpXG5cdFx0b3BFYWNoKHRoaXMub3BPYmplZCwgXyA9PiBwbHVzTG9jYWxzKG5ld0xvY2FscywgKCkgPT4gXy52ZXJpZnkoKSkpXG5cdH0sXG5cdEJsb2NrQmFnOiBibG9ja0JhZ09yTWFwLFxuXHRCbG9ja01hcDogYmxvY2tCYWdPck1hcCxcblx0QmxvY2tXcmFwKCkge1xuXHRcdHRoaXMuYmxvY2sudmVyaWZ5KClcblx0fSxcblx0Q2FzZURvOiB2ZXJpZnlDYXNlLFxuXHRDYXNlVmFsOiB2ZXJpZnlDYXNlLFxuXHQvLyBPbmx5IHJlYWNoIGhlcmUgZm9yIGluL291dCBjb25kaXRpb25cblx0RGVidWcoKSB7IHZlcmlmeUxpbmVzKFsgdGhpcyBdKSB9LFxuXHRFbmRMb29wKCkge1xuXHRcdGlmRWxzZShvcExvb3AsIF8gPT4gc2V0RW5kTG9vcCh0aGlzLCBfKSwgKCkgPT4gY3guZmFpbCh0aGlzLmxvYywgJ05vdCBpbiBhIGxvb3AuJykpXG5cdH0sXG5cdEZ1bigpIHtcblx0XHR3aXRoQmxvY2tMb2NhbHMoKCkgPT4ge1xuXHRcdFx0Y3guY2hlY2sodGhpcy5vcFJlc0RlY2xhcmUgPT09IG51bGwgfHwgdGhpcy5ibG9jayBpbnN0YW5jZW9mIEJsb2NrVmFsLCB0aGlzLmxvYyxcblx0XHRcdFx0J0Z1bmN0aW9uIHdpdGggcmV0dXJuIGNvbmRpdGlvbiBtdXN0IHJldHVybiBzb21ldGhpbmcuJylcblx0XHRcdHRoaXMuYXJncy5mb3JFYWNoKGFyZyA9PiB2b3AoYXJnLm9wVHlwZSkpXG5cdFx0XHR3aXRoSW5HZW5lcmF0b3IodGhpcy5pc0dlbmVyYXRvciwgKCkgPT4ge1xuXHRcdFx0XHRjb25zdCBhbGxBcmdzID0gY2F0KHRoaXMuYXJncywgdGhpcy5vcFJlc3RBcmcpXG5cdFx0XHRcdGFsbEFyZ3MuZm9yRWFjaChfID0+IHJlZ2lzdGVyTG9jYWwoXykpXG5cdFx0XHRcdHBsdXNMb2NhbHMoYWxsQXJncywgKCkgPT4ge1xuXHRcdFx0XHRcdHZvcCh0aGlzLm9wSW4pXG5cdFx0XHRcdFx0dGhpcy5ibG9jay52ZXJpZnkoKVxuXHRcdFx0XHRcdG9wRWFjaCh0aGlzLm9wUmVzRGVjbGFyZSwgXyA9PiB7XG5cdFx0XHRcdFx0XHRfLnZlcmlmeSgpXG5cdFx0XHRcdFx0XHRyZWdpc3RlckxvY2FsKF8pXG5cdFx0XHRcdFx0fSlcblx0XHRcdFx0XHRjb25zdCB2ZXJpZnlPdXQgPSAoKSA9PiBvcEVhY2godGhpcy5vcE91dCwgXyA9PiBfLnZlcmlmeSgpKVxuXHRcdFx0XHRcdGlmRWxzZSh0aGlzLm9wUmVzRGVjbGFyZSwgcmQgPT4gcGx1c0xvY2FscyhbIHJkIF0sIHZlcmlmeU91dCksIHZlcmlmeU91dClcblx0XHRcdFx0fSlcblx0XHRcdH0pXG5cdFx0fSlcblx0fSxcblx0TG9jYWxBY2Nlc3MoKSB7XG5cdFx0Y29uc3QgZGVjbGFyZSA9IGxvY2Fscy5nZXQodGhpcy5uYW1lKVxuXHRcdGN4LmNoZWNrKGRlY2xhcmUgIT09IHVuZGVmaW5lZCwgdGhpcy5sb2MsICgpID0+XG5cdFx0XHRgTm8gc3VjaCBsb2NhbCAke2NvZGUodGhpcy5uYW1lKX0uXFxuTG9jYWxzIGFyZTpcXG4ke2NvZGUobWFwS2V5cyhsb2NhbHMpLmpvaW4oJyAnKSl9LmApXG5cdFx0dnIuYWNjZXNzVG9Mb2NhbC5zZXQodGhpcywgZGVjbGFyZSlcblx0XHRhY2Nlc3NMb2NhbChkZWNsYXJlLCB0aGlzLCBpc0luRGVidWcpXG5cdH0sXG5cdExvb3AoKSB7IHdpdGhJbkxvb3AodGhpcywgKCkgPT4gdGhpcy5ibG9jay52ZXJpZnkoKSkgfSxcblx0Ly8gQWRkaW5nIExvY2FsRGVjbGFyZXMgdG8gdGhlIGF2YWlsYWJsZSBsb2NhbHMgaXMgZG9uZSBieSBGdW4gb3IgbGluZU5ld0xvY2Fscy5cblx0TG9jYWxEZWNsYXJlKCkgeyB2b3AodGhpcy5vcFR5cGUpIH0sXG5cdE1hcEVudHJ5KCkge1xuXHRcdHRoaXMua2V5LnZlcmlmeSgpXG5cdFx0dGhpcy52YWwudmVyaWZ5KClcblx0fSxcblx0TW9kdWxlKCkge1xuXHRcdGNvbnN0IHVzZUxvY2FscyA9IHZlcmlmeVVzZXModGhpcy51c2VzLCB0aGlzLmRlYnVnVXNlcylcblx0XHRwbHVzTG9jYWxzKHVzZUxvY2FscywgKCkgPT4ge1xuXHRcdFx0Y29uc3QgeyBuZXdMb2NhbHMgfSA9IHZlcmlmeUxpbmVzKHRoaXMubGluZXMpXG5cdFx0XHR0aGlzLmV4cG9ydHMuZm9yRWFjaChleCA9PiBhY2Nlc3NMb2NhbEZvclJldHVybihleCwgdGhpcykpXG5cdFx0XHRvcEVhY2godGhpcy5vcERlZmF1bHRFeHBvcnQsIF8gPT4gcGx1c0xvY2FscyhuZXdMb2NhbHMsICgpID0+IF8udmVyaWZ5KCkpKVxuXHRcdH0pXG5cblx0XHRjb25zdCBleHBvcnRzID0gbmV3U2V0KHRoaXMuZXhwb3J0cylcblx0XHRjb25zdCBtYXJrRXhwb3J0TGluZXMgPSBsaW5lID0+IHtcblx0XHRcdGlmIChsaW5lIGluc3RhbmNlb2YgQXNzaWduICYmIGV4cG9ydHMuaGFzKGxpbmUuYXNzaWduZWUpIHx8XG5cdFx0XHRcdGxpbmUgaW5zdGFuY2VvZiBBc3NpZ25EZXN0cnVjdHVyZSAmJiBsaW5lLmFzc2lnbmVlcy5zb21lKF8gPT4gZXhwb3J0cy5oYXMoXykpKVxuXHRcdFx0XHR2ci5leHBvcnRBc3NpZ25zLmFkZChsaW5lKVxuXHRcdFx0ZWxzZSBpZiAobGluZSBpbnN0YW5jZW9mIERlYnVnKVxuXHRcdFx0XHRsaW5lLmxpbmVzLmZvckVhY2gobWFya0V4cG9ydExpbmVzKVxuXHRcdH1cblx0XHR0aGlzLmxpbmVzLmZvckVhY2gobWFya0V4cG9ydExpbmVzKVxuXHR9LFxuXHRZaWVsZCgpIHtcblx0XHRjeC5jaGVjayhpc0luR2VuZXJhdG9yLCB0aGlzLmxvYywgJ0Nhbm5vdCB5aWVsZCBvdXRzaWRlIG9mIGdlbmVyYXRvciBjb250ZXh0Jylcblx0XHR0aGlzLnlpZWxkZWQudmVyaWZ5KClcblx0fSxcblx0WWllbGRUbygpIHtcblx0XHRjeC5jaGVjayhpc0luR2VuZXJhdG9yLCB0aGlzLmxvYywgJ0Nhbm5vdCB5aWVsZCBvdXRzaWRlIG9mIGdlbmVyYXRvciBjb250ZXh0Jylcblx0XHR0aGlzLnlpZWxkZWRUby52ZXJpZnkoKVxuXHR9LFxuXG5cdC8vIFRoZXNlIG9uZXMganVzdCByZWN1cnNlIHRvIHRoZWlyIGNoaWxkcmVuLlxuXHRBc3NpZ25EZXN0cnVjdHVyZSgpIHtcblx0XHR0aGlzLnZhbHVlLnZlcmlmeSgpXG5cdFx0dm0odGhpcy5hc3NpZ25lZXMpXG5cdH0sXG5cdENhbGwoKSB7XG5cdFx0dGhpcy5jYWxsZWQudmVyaWZ5KClcblx0XHR2bSh0aGlzLmFyZ3MpXG5cdH0sXG5cdENhc2VEb1BhcnQ6IHZlcmlmeUNhc2VQYXJ0LFxuXHRDYXNlVmFsUGFydDogdmVyaWZ5Q2FzZVBhcnQsXG5cdEdsb2JhbEFjY2VzcygpIHsgfSxcblx0T2JqU2ltcGxlKCkge1xuXHRcdGNvbnN0IGtleXMgPSBuZXcgU2V0KClcblx0XHR0aGlzLnBhaXJzLmZvckVhY2gocGFpciA9PiB7XG5cdFx0XHRjeC5jaGVjaygha2V5cy5oYXMocGFpci5rZXkpLCBwYWlyLmxvYywgKCkgPT4gYER1cGxpY2F0ZSBrZXkgJHtwYWlyLmtleX1gKVxuXHRcdFx0a2V5cy5hZGQocGFpci5rZXkpXG5cdFx0XHRwYWlyLnZhbHVlLnZlcmlmeSgpXG5cdFx0fSlcblx0fSxcblx0TGF6eSgpIHsgd2l0aEJsb2NrTG9jYWxzKCgpID0+IHRoaXMudmFsdWUudmVyaWZ5KCkpIH0sXG5cdEJhZ0VudHJ5KCkgeyB0aGlzLnZhbHVlLnZlcmlmeSgpIH0sXG5cdExpc3RTaW1wbGUoKSB7IHZtKHRoaXMucGFydHMpIH0sXG5cdE51bWJlckxpdGVyYWwoKSB7IH0sXG5cdE1lbWJlcigpIHsgdGhpcy5vYmplY3QudmVyaWZ5KCkgfSxcblx0UXVvdGUoKSB7XG5cdFx0dGhpcy5wYXJ0cy5mb3JFYWNoKF8gPT4ge1xuXHRcdFx0aWYgKHR5cGVvZiBfICE9PSAnc3RyaW5nJylcblx0XHRcdFx0Xy52ZXJpZnkoKVxuXHRcdH0pXG5cdH0sXG5cdFNwZWNpYWwoKSB7IH0sXG5cdFNwbGF0KCkgeyB0aGlzLnNwbGF0dGVkLnZlcmlmeSgpIH1cbn0pXG5cbmZ1bmN0aW9uIGJsb2NrQmFnT3JNYXAoKSB7XG5cdGNvbnN0IHsgbGlzdE1hcExlbmd0aCB9ID0gdmVyaWZ5TGluZXModGhpcy5saW5lcylcblx0dnIuYmxvY2tUb0xlbmd0aC5zZXQodGhpcywgbGlzdE1hcExlbmd0aClcbn1cblxuZnVuY3Rpb24gdmVyaWZ5Q2FzZSgpIHtcblx0Y29uc3QgbmV3TG9jYWxzID0gW11cblx0b3BFYWNoKHRoaXMub3BDYXNlZCwgXyA9PiB7XG5cdFx0cmVnaXN0ZXJMb2NhbChfLmFzc2lnbmVlKVxuXHRcdF8udmVyaWZ5KClcblx0XHRuZXdMb2NhbHMucHVzaChfLmFzc2lnbmVlKVxuXHR9KVxuXHRwbHVzTG9jYWxzKG5ld0xvY2FscywgKCkgPT4ge1xuXHRcdHZtKHRoaXMucGFydHMpXG5cdFx0dm9wKHRoaXMub3BFbHNlKVxuXHR9KVxufVxuXG5mdW5jdGlvbiB2ZXJpZnlDYXNlUGFydCgpIHtcblx0aWYgKHRoaXMudGVzdCBpbnN0YW5jZW9mIFBhdHRlcm4pIHtcblx0XHR0aGlzLnRlc3QudHlwZS52ZXJpZnkoKVxuXHRcdHRoaXMudGVzdC5wYXR0ZXJuZWQudmVyaWZ5KClcblx0XHR2bSh0aGlzLnRlc3QubG9jYWxzKVxuXHRcdHRoaXMudGVzdC5sb2NhbHMuZm9yRWFjaChyZWdpc3RlckxvY2FsKVxuXHRcdHBsdXNMb2NhbHModGhpcy50ZXN0LmxvY2FscywgKCkgPT4gdGhpcy5yZXN1bHQudmVyaWZ5KCkpXG5cdH0gZWxzZSB7XG5cdFx0dGhpcy50ZXN0LnZlcmlmeSgpXG5cdFx0dGhpcy5yZXN1bHQudmVyaWZ5KClcblx0fVxufVxuXG5jb25zdFxuXHR2ZXJpZnlVc2VzID0gKHVzZXMsIGRlYnVnVXNlcykgPT4ge1xuXHRcdGNvbnN0IHVzZUxvY2FscyA9IFtdXG5cdFx0Y29uc3Rcblx0XHRcdHZlcmlmeVVzZSA9IHVzZSA9PiB7XG5cdFx0XHRcdHVzZS51c2VkLmZvckVhY2godXNlTG9jYWwpXG5cdFx0XHRcdG9wRWFjaCh1c2Uub3BVc2VEZWZhdWx0LCB1c2VMb2NhbClcblx0XHRcdH0sXG5cdFx0XHR1c2VMb2NhbCA9IF8gPT4ge1xuXHRcdFx0XHRyZWdpc3RlckxvY2FsKF8pXG5cdFx0XHRcdHVzZUxvY2Fscy5wdXNoKF8pXG5cdFx0XHR9XG5cdFx0dXNlcy5mb3JFYWNoKHVzZSA9PiB7XG5cdFx0XHRpZiAoISh1c2UgaW5zdGFuY2VvZiBVc2VEbykpIHZlcmlmeVVzZSh1c2UpXG5cdFx0fSlcblx0XHR3aXRoSW5EZWJ1Zyh0cnVlLCAoKSA9PiBkZWJ1Z1VzZXMuZm9yRWFjaCh2ZXJpZnlVc2UpKVxuXHRcdHJldHVybiB1c2VMb2NhbHNcblx0fSxcblxuXHR2ZXJpZnlMaW5lcyA9IGxpbmVzID0+IHtcblx0XHRjb25zdCBuZXdMb2NhbHMgPSBbIF1cblx0XHQvLyBGaXJzdCwgZ2V0IGxvY2FscyBmb3IgdGhlIHdob2xlIGJsb2NrLlxuXHRcdGNvbnN0IGdldExpbmVMb2NhbHMgPSBsaW5lID0+IHtcblx0XHRcdGlmIChsaW5lIGluc3RhbmNlb2YgRGVidWcpXG5cdFx0XHRcdHdpdGhJbkRlYnVnKHRydWUsICgpID0+IGxpbmUubGluZXMuZm9yRWFjaChnZXRMaW5lTG9jYWxzKSlcblx0XHRcdGVsc2Uge1xuXHRcdFx0XHRjb25zdCBuZXdzID0gbGluZU5ld0xvY2FscyhsaW5lKVxuXHRcdFx0XHRuZXdzLmZvckVhY2gocmVnaXN0ZXJMb2NhbClcblx0XHRcdFx0bmV3TG9jYWxzLnB1c2goLi4ubmV3cylcblx0XHRcdH1cblx0XHR9XG5cblx0XHRsaW5lcy5mb3JFYWNoKGdldExpbmVMb2NhbHMpXG5cblx0XHRjb25zdCB0aGlzQmxvY2tMb2NhbE5hbWVzID0gbmV3IFNldCgpXG5cdFx0Y29uc3Qgc2hhZG93ZWQgPSBuZXcgTWFwKClcblxuXHRcdGxldCBsaXN0TWFwTGVuZ3RoID0gMFxuXG5cdFx0Y29uc3QgdmVyaWZ5TGluZSA9IGxpbmUgPT4ge1xuXHRcdFx0aWYgKGxpbmUgaW5zdGFuY2VvZiBEZWJ1Zylcblx0XHRcdFx0Ly8gVE9ETzogRG8gYW55dGhpbmcgaW4gdGhpcyBzaXR1YXRpb24/XG5cdFx0XHRcdC8vIGN4LmNoZWNrKCFpbkRlYnVnLCBsaW5lLmxvYywgJ1JlZHVuZGFudCBgZGVidWdgLicpXG5cdFx0XHRcdHdpdGhJbkRlYnVnKHRydWUsICgpID0+IGxpbmUubGluZXMuZm9yRWFjaCh2ZXJpZnlMaW5lKSlcblx0XHRcdGVsc2Uge1xuXHRcdFx0XHR2ZXJpZnlJc1N0YXRlbWVudChsaW5lKVxuXHRcdFx0XHRsaW5lTmV3TG9jYWxzKGxpbmUpLmZvckVhY2gobCA9PiB7XG5cdFx0XHRcdFx0Y29uc3QgZ290ID0gbG9jYWxzLmdldChsLm5hbWUpXG5cdFx0XHRcdFx0aWYgKGdvdCAhPT0gdW5kZWZpbmVkKSB7XG5cdFx0XHRcdFx0XHRjeC5jaGVjayghdGhpc0Jsb2NrTG9jYWxOYW1lcy5oYXMobC5uYW1lKSwgbC5sb2MsXG5cdFx0XHRcdFx0XHRcdCgpID0+IGBBIGxvY2FsICR7Y29kZShsLm5hbWUpfSBpcyBhbHJlYWR5IGluIHRoaXMgYmxvY2suYClcblx0XHRcdFx0XHRcdHNoYWRvd2VkLnNldChsLm5hbWUsIGdvdClcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0bG9jYWxzLnNldChsLm5hbWUsIGwpXG5cdFx0XHRcdFx0dGhpc0Jsb2NrTG9jYWxOYW1lcy5hZGQobC5uYW1lKVxuXHRcdFx0XHR9KVxuXHRcdFx0XHRpZiAobGluZSBpbnN0YW5jZW9mIEJhZ0VudHJ5IHx8IGxpbmUgaW5zdGFuY2VvZiBNYXBFbnRyeSkge1xuXHRcdFx0XHRcdHNldEVudHJ5SW5kZXgobGluZSwgbGlzdE1hcExlbmd0aClcblx0XHRcdFx0XHRsaXN0TWFwTGVuZ3RoID0gbGlzdE1hcExlbmd0aCArIDFcblx0XHRcdFx0fVxuXHRcdFx0XHRsaW5lLnZlcmlmeSgpXG5cdFx0XHR9XG5cdFx0fVxuXG5cdFx0cGx1c1BlbmRpbmdCbG9ja0xvY2FscyhuZXdMb2NhbHMsICgpID0+IGxpbmVzLmZvckVhY2godmVyaWZ5TGluZSkpXG5cblx0XHRuZXdMb2NhbHMuZm9yRWFjaChsID0+IHtcblx0XHRcdGNvbnN0IHMgPSBzaGFkb3dlZC5nZXQobC5uYW1lKVxuXHRcdFx0aWYgKHMgPT09IHVuZGVmaW5lZClcblx0XHRcdFx0bG9jYWxzLmRlbGV0ZShsLm5hbWUpXG5cdFx0XHRlbHNlXG5cdFx0XHRcdGxvY2Fscy5zZXQobC5uYW1lLCBzKVxuXHRcdH0pXG5cblx0XHRyZXR1cm4geyBuZXdMb2NhbHMsIGxpc3RNYXBMZW5ndGggfVxuXHR9LFxuXG5cdHZlcmlmeUlzU3RhdGVtZW50ID0gbGluZSA9PiB7XG5cdFx0Y29uc3QgaXNTdGF0ZW1lbnQgPVxuXHRcdFx0bGluZSBpbnN0YW5jZW9mIERvIHx8XG5cdFx0XHRsaW5lIGluc3RhbmNlb2YgQ2FsbCB8fFxuXHRcdFx0bGluZSBpbnN0YW5jZW9mIFlpZWxkIHx8XG5cdFx0XHRsaW5lIGluc3RhbmNlb2YgWWllbGRUbyB8fFxuXHRcdFx0bGluZSBpbnN0YW5jZW9mIEJhZ0VudHJ5IHx8XG5cdFx0XHRsaW5lIGluc3RhbmNlb2YgTWFwRW50cnkgfHxcblx0XHRcdGxpbmUgaW5zdGFuY2VvZiBTcGVjaWFsICYmIGxpbmUua2luZCA9PT0gU1BfRGVidWdnZXIgfHxcblx0XHRcdC8vIE9LLCB1c2VkIHRvIG1lYW4gYHBhc3NgXG5cdFx0XHRsaW5lIGluc3RhbmNlb2YgR2xvYmFsQWNjZXNzICYmIGxpbmUubmFtZSA9PT0gJ251bGwnXG5cdFx0Y3guY2hlY2soaXNTdGF0ZW1lbnQsIGxpbmUubG9jLCAnRXhwcmVzc2lvbiBpbiBzdGF0ZW1lbnQgcG9zaXRpb24uJylcblx0fSxcblxuXHRsaW5lTmV3TG9jYWxzID0gbGluZSA9PlxuXHRcdGxpbmUgaW5zdGFuY2VvZiBBc3NpZ24gP1xuXHRcdFx0WyBsaW5lLmFzc2lnbmVlIF0gOlxuXHRcdFx0bGluZSBpbnN0YW5jZW9mIEFzc2lnbkRlc3RydWN0dXJlID9cblx0XHRcdGxpbmUuYXNzaWduZWVzIDpcblx0XHRcdFsgXVxuIl0sInNvdXJjZVJvb3QiOiIvc3JjIn0=