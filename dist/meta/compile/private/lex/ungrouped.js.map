{"version":3,"sources":["meta/compile/private/lex/ungrouped.js"],"names":[],"mappings":"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","file":"meta/compile/private/lex/ungrouped.js","sourcesContent":["import Loc, { Pos, StartLine, StartColumn, singleCharLoc } from 'esast/dist/Loc'\nimport { code } from '../../CompileError'\nimport { AllKeywords, ReservedWords } from '../Lang'\nimport { CallOnFocus, DotName, Keyword, Literal, Name } from '../Token'\nimport { assert } from '../U/util'\nimport GroupPre, { GP_OpenParen, GP_OpenBracket, GP_OpenBlock, GP_OpenQuote, GP_Line,\n\tGP_Space, GP_CloseParen, GP_CloseBracket, GP_CloseBlock, GP_CloseQuote} from './GroupPre'\nimport { showChar, N0, N1, N2, N3, N4, N5, N6, N7, N8, N9,\n\tOpParen, OpBracket, OpBrace, ClParen, ClBracket, ClBrace, Space, Dot, Colon, Tilde, Bar,\n\tUnderscore, Backslash, Hash, Newline, Quote, Tab, Hyphen, LetterN, LetterT,\n\tisDigit, isNameCharacter, isNumberCharacter, isReservedCharacter } from './char'\n\nexport default (cx, str) => {\n\tconst res = [ ]\n\tlet line = StartLine\n\tlet column = StartColumn\n\tlet index = 0\n\n\tconst\n\t\to = t => { res.push(t) },\n\n\t\tpos = () => Pos(line, column),\n\t\tloc = () => singleCharLoc(pos()),\n\n\t\tprev = () => str.charCodeAt(index - 1),\n\t\tpeek = () => str.charCodeAt(index),\n\n\t\teat = () => {\n\t\t\tconst ch = str.charCodeAt(index)\n\t\t\tindex = index + 1\n\t\t\tcolumn = column + 1\n\t\t\treturn ch\n\t\t},\n\t\ttryEat = ch => {\n\t\t\tconst canEat = peek() === ch\n\t\t\tif (canEat) {\n\t\t\t\tindex = index + 1\n\t\t\t\tcolumn = column + 1\n\t\t\t}\n\t\t\treturn canEat\n\t\t},\n\n\t\t// Caller must ensure that backing up nCharsToBackUp characters brings us to oldPos.\n\t\tstepBackMany = (oldPos, nCharsToBackUp) => {\n\t\t\tindex = index - nCharsToBackUp\n\t\t\tline = oldPos.line\n\t\t\tcolumn = oldPos.column\n\t\t},\n\n\t\t_skipWhile = pred => {\n\t\t\tconst startIndex = index\n\t\t\twhile (pred(peek()))\n\t\t\t\tindex = index + 1\n\t\t\tconst diff = index - startIndex\n\t\t\tcolumn = column + diff\n\t\t\treturn diff\n\t\t},\n\t\ttakeWhileWithPrev = pred => {\n\t\t\tconst startIndex = index\n\t\t\t_skipWhile(pred)\n\t\t\treturn str.slice(startIndex - 1, index)\n\t\t},\n\t\ttakeWhile = pred => {\n\t\t\tconst startIndex = index\n\t\t\t_skipWhile(pred)\n\t\t\treturn str.slice(startIndex, index)\n\t\t},\n\t\tskipWhileEquals = ch => _skipWhile(_ => _ === ch),\n\n\t\t// Called after seeing the first newline.\n\t\tskipNewlines = () => {\n\t\t\tline = line + 1\n\t\t\tconst startLine = line\n\t\t\twhile (peek() === Newline) {\n\t\t\t\tindex = index + 1\n\t\t\t\tline = line + 1\n\t\t\t}\n\t\t\tcolumn = StartColumn\n\t\t\treturn line - startLine\n\t\t},\n\n\t\tskipRestOfLine = () => {\n\t\t\twhile (peek() !== Newline)\n\t\t\t\tindex = index + 1\n\t\t}\n\n\tconst ungrouped = isInQuote => {\n\t\tlet indent = 0\n\n\t\tlet ch, startLine, startColumn\n\t\tconst\n\t\t\tloc = () => Loc(Pos(startLine, startColumn), pos()),\n\t\t\tkeyword = k => Keyword(loc(), k),\n\t\t\tgp = k => o(GroupPre(loc(), k)),\n\t\t\teatNumber = () => {\n\t\t\t\tconst lit = takeWhileWithPrev(isNumberCharacter)\n\t\t\t\tcx.check(!Number.isNaN(Number(lit)), pos, () =>\n\t\t\t\t\t`Invalid number literal ${code(lit)}`)\n\t\t\t\treturn Literal(loc(), lit, Number)\n\t\t\t}\n\n\t\twhile (index !== str.length) {\n\t\t\tstartLine = line\n\t\t\tstartColumn = column\n\n\t\t\tch = eat()\n\t\t\tswitch (ch) {\n\t\t\t\tcase N0: case N1: case N2: case N3: case N4:\n\t\t\t\tcase N5: case N6: case N7: case N8: case N9:\n\t\t\t\t\to(eatNumber())\n\t\t\t\t\tbreak\n\t\t\t\tcase OpParen:\n\t\t\t\t\tgp(GP_OpenParen)\n\t\t\t\t\tbreak\n\t\t\t\tcase OpBracket:\n\t\t\t\t\tgp(GP_OpenBracket)\n\t\t\t\t\tbreak\n\t\t\t\tcase ClParen:\n\t\t\t\t\tgp(GP_CloseParen)\n\t\t\t\t\tbreak\n\t\t\t\tcase ClBracket:\n\t\t\t\t\tgp(GP_CloseBracket)\n\t\t\t\t\tbreak\n\t\t\t\tcase ClBrace:\n\t\t\t\t\tcx.check(isInQuote, loc, () => `Reserved character ${showChar(ch)}`)\n\t\t\t\t\treturn\n\t\t\t\tcase Space:\n\t\t\t\t\tcx.warnIf(peek() === Space, loc, 'Multiple spaces in a row')\n\t\t\t\t\tgp(GP_Space)\n\t\t\t\t\tbreak\n\t\t\t\tcase Dot: {\n\t\t\t\t\tconst p = peek()\n\t\t\t\t\tif (p === Space || p === Newline) {\n\t\t\t\t\t\t// ObjLit assign in its own spaced group.\n\t\t\t\t\t\t// We can't just create a new Group here because we want to\n\t\t\t\t\t\t// ensure it's not part of the preceding or following spaced group.\n\t\t\t\t\t\tgp(GP_Space)\n\t\t\t\t\t\to(keyword('. '))\n\t\t\t\t\t\tgp(GP_Space)\n\t\t\t\t\t} else\n\t\t\t\t\t\to(DotName(\n\t\t\t\t\t\t\tloc(),\n\t\t\t\t\t\t\t// +1 for the dot we just skipped.\n\t\t\t\t\t\t\tskipWhileEquals(Dot) + 1,\n\t\t\t\t\t\t\ttakeWhile(isNameCharacter)))\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase Colon:\n\t\t\t\t\to(keyword(':'))\n\t\t\t\t\tbreak\n\t\t\t\tcase Tilde:\n\t\t\t\t\tif (tryEat(Bar)) {\n\t\t\t\t\t\to(keyword('~|'))\n\t\t\t\t\t\tgp(GP_Space)\n\t\t\t\t\t\tbreak\n\t\t\t\t\t} else {\n\t\t\t\t\t\to(keyword('~'))\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t\tcase Bar:\n\t\t\t\t\t// First arg in its own spaced group\n\t\t\t\t\to(keyword('|'))\n\t\t\t\t\tgp(GP_Space)\n\t\t\t\t\tbreak\n\t\t\t\tcase Underscore:\n\t\t\t\t\to(keyword('_'))\n\t\t\t\t\tbreak\n\t\t\t\tcase Hash:\n\t\t\t\t\tskipRestOfLine()\n\t\t\t\t\tbreak\n\t\t\t\tcase Newline: {\n\t\t\t\t\tcx.check(!isInQuote, loc, 'Quote interpolation cannot contain newline')\n\t\t\t\t\tcx.check(prev() !== Space, loc, 'Line ends in a space')\n\n\t\t\t\t\t// Skip any blank lines.\n\t\t\t\t\tskipNewlines()\n\t\t\t\t\tconst oldIndent = indent\n\t\t\t\t\tindent = skipWhileEquals(Tab)\n\t\t\t\t\tcx.check(peek() !== Space, pos, 'Line begins in a space')\n\t\t\t\t\tif (indent <= oldIndent) {\n\t\t\t\t\t\tfor (let i = indent; i < oldIndent; i = i + 1)\n\t\t\t\t\t\t\tgp(GP_CloseBlock)\n\t\t\t\t\t\tgp(GP_Line)\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcx.check(indent === oldIndent + 1, loc, 'Line is indented more than once')\n\t\t\t\t\t\tgp(GP_OpenBlock)\n\t\t\t\t\t}\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase Tab:\n\t\t\t\t\tcx.fail(loc(), 'Tab may only be used to indent')\n\t\t\t\t\tbreak\n\t\t\t\tcase Quote:\n\t\t\t\t\tlexQuote(indent)\n\t\t\t\t\tbreak\n\t\t\t\tcase Hyphen:\n\t\t\t\t\tif (isDigit(peek())) {\n\t\t\t\t\t\to(eatNumber())\n\t\t\t\t\t\tbreak\n\t\t\t\t\t}\n\t\t\t\t\t// Else fallthrough\n\t\t\t\tdefault: {\n\t\t\t\t\tcx.check(\n\t\t\t\t\t\t!isReservedCharacter(ch), loc, () => `Reserved character ${showChar(ch)}`)\n\t\t\t\t\t// All other characters should be handled in a case above.\n\t\t\t\t\tconst name = takeWhileWithPrev(isNameCharacter)\n\t\t\t\t\tswitch (name) {\n\t\t\t\t\t\tcase 'region':\n\t\t\t\t\t\t\t// Rest of line is a comment.\n\t\t\t\t\t\t\tskipRestOfLine()\n\t\t\t\t\t\t\to(keyword('region'))\n\t\t\t\t\t\t\tbreak\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tif (tryEat(Underscore))\n\t\t\t\t\t\t\t\to(CallOnFocus(loc(), name))\n\t\t\t\t\t\t\telse if (AllKeywords.has(name))\n\t\t\t\t\t\t\t\to(keyword(name))\n\t\t\t\t\t\t\telse if (ReservedWords.has(name))\n\t\t\t\t\t\t\t\tcx.fail(loc, `Reserved word ${code(name)}`)\n\t\t\t\t\t\t\telse\n\t\t\t\t\t\t\t\to(Name(loc(), name))\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tconst lexQuote = indent => {\n\t\tconst isIndented = peek() === Newline\n\t\tconst quoteIndent = indent + 1\n\n\t\tlet first = true\n\t\tlet read = ''\n\t\tlet startOfRead = pos()\n\n\t\tconst yieldRead = () => {\n\t\t\tif (read !== '') {\n\t\t\t\to(Literal(\n\t\t\t\t\tLoc(startOfRead, pos()),\n\t\t\t\t\t// Don't include leading newline of indented block\n\t\t\t\t\tfirst && isIndented ? read.slice(1) : read,\n\t\t\t\t\tString))\n\t\t\t\tfirst = false\n\t\t\t}\n\t\t\tread = ''\n\t\t\tstartOfRead = pos()\n\t\t}\n\n\t\to(GroupPre(loc(), GP_OpenQuote))\n\n\t\teatChars: while (true) {\n\t\t\tconst chPos = pos()\n\t\t\tconst ch = eat()\n\t\t\tswitch (ch) {\n\t\t\t\tcase Backslash: {\n\t\t\t\t\tread = read + quoteEscape(eat())\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase OpBrace: {\n\t\t\t\t\tyieldRead()\n\t\t\t\t\t// We can't create a Group now because there may be other GroupPre_s inside.\n\t\t\t\t\to(GroupPre(singleCharLoc(chPos), GP_OpenParen))\n\t\t\t\t\tungrouped(true)\n\t\t\t\t\to(GroupPre(loc(), GP_CloseParen))\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase Newline: {\n\t\t\t\t\tcx.check(prev !== Space, chPos, 'Line ends in a space')\n\t\t\t\t\tcx.check(isIndented, chPos, 'Unclosed quote.')\n\t\t\t\t\tlet newIndent = skipWhileEquals(Tab)\n\n\t\t\t\t\tlet extraNewlines = ''\n\t\t\t\t\t// Allow blank lines.\n\t\t\t\t\tif (newIndent === 0) {\n\t\t\t\t\t\textraNewlines = '\\n'.repeat(skipNewlines())\n\t\t\t\t\t\tnewIndent = skipWhileEquals(Tab)\n\t\t\t\t\t}\n\n\t\t\t\t\tif (newIndent < quoteIndent) {\n\t\t\t\t\t\t// Indented quote section is over.\n\t\t\t\t\t\t// Undo reading the tabs and newline.\n\t\t\t\t\t\tstepBackMany(chPos, newIndent + 1)\n\t\t\t\t\t\tassert(peek() === Newline)\n\t\t\t\t\t\tbreak eatChars\n\t\t\t\t\t} else\n\t\t\t\t\t\tread = read + extraNewlines + '\\n' + '\\t'.repeat(newIndent - quoteIndent)\n\t\t\t\t\tbreak\n\t\t\t\t}\n\t\t\t\tcase Quote:\n\t\t\t\t\tif (!isIndented)\n\t\t\t\t\t\tbreak eatChars\n\t\t\t\t\t// Else fallthrough\n\t\t\t\tdefault:\n\t\t\t\t\tread = read + String.fromCharCode(ch)\n\t\t\t}\n\t\t}\n\n\t\tyieldRead()\n\t\to(GroupPre(loc(), GP_CloseQuote))\n\t}\n\n\tconst quoteEscape = ch => {\n\t\tswitch (ch) {\n\t\t\tcase OpBrace: return '{'\n\t\t\tcase LetterN: return '\\n'\n\t\t\tcase LetterT: return '\\t'\n\t\t\tcase Quote: return '\"'\n\t\t\tcase Backslash: return '\\\\'\n\t\t\tdefault: cx.fail(pos, `No need to escape ${showChar(ch)}`)\n\t\t}\n\t}\n\n\tungrouped(false)\n\treturn res\n}\n"],"sourceRoot":"/src"}