if (typeof define !== 'function') var define = require('amdefine')(module);define(['exports', 'module', 'esast/dist/Loc', '../../CompileError', '../Lang', '../Token', '../U/util', './GroupPre', './char'], function (exports, module, _esastDistLoc, _CompileError, _Lang, _Token, _UUtil, _GroupPre, _char) {
	'use strict';

	function _interopRequire(obj) { return obj && obj.__esModule ? obj['default'] : obj; }

	var _Loc = _interopRequire(_esastDistLoc);

	var _GroupPre2 = _interopRequire(_GroupPre);

	const cc = function (ch) {
		return ch.charCodeAt(0);
	};
	const N0 = cc('0'),
	      N1 = cc('1'),
	      N2 = cc('2'),
	      N3 = cc('3'),
	      N4 = cc('4'),
	      N5 = cc('5'),
	      N6 = cc('6'),
	      N7 = cc('7'),
	      N8 = cc('8'),
	      N9 = cc('9'),
	      OpParen = cc('('),
	      OpBracket = cc('['),
	      OpBrace = cc('{'),
	      ClParen = cc(')'),
	      ClBracket = cc(']'),
	      ClBrace = cc('}'),
	      Ampersand = cc('&'),
	      Backslash = cc('\\'),
	      Backtick = cc('`'),
	      Bar = cc('|'),
	      Caret = cc('^'),
	      Colon = cc(':'),
	      Comma = cc(','),
	      Dot = cc('.'),
	      Hash = cc('#'),
	      Hyphen = cc('-'),
	      LetterN = cc('n'),
	      LetterT = cc('t'),
	      Newline = cc('\n'),
	      Percent = cc('%'),
	      Quote = cc('"'),
	      Semicolon = cc(';'),
	      Space = cc(' '),
	      Tab = cc('\t'),
	      Tilde = cc('~'),
	      Underscore = cc('_');

	module.exports = function (cx, str) {
		const res = [];
		let line = _esastDistLoc.StartLine;
		let column = _esastDistLoc.StartColumn;
		let index = 0;

		// Use these for debugging pos.
		/*
  const
  	checkPos = () => {
  		const p = getCorrectPos()
  		if (p.line !== line || p.column !== column)
  			throw new Error(`index: ${index}, wrong: ${Pos(line, column)}, right: ${p}`)
  	},
  	indexToPos = new Map(),
  	getCorrectPos = () => {
  		if (index === 0)
  			return Pos(StartLine, StartColumn)
  			let oldPos, oldIndex
  		for (oldIndex = index - 1; oldIndex > 0; oldIndex = oldIndex - 1) {
  			oldPos = indexToPos.get(oldIndex)
  			if (oldPos)
  				break
  		}
  		if (oldPos === undefined) {
  			assert(oldIndex === 0)
  			oldPos = Pos(StartLine, StartColumn)
  		}
  		let newLine = oldPos.line, newColumn = oldPos.column
  		for (; oldIndex < index; oldIndex = oldIndex + 1)
  			if (str.charCodeAt(oldIndex) === Newline) {
  				newLine = newLine + 1
  				newColumn = StartColumn
  			} else
  				newColumn = newColumn + 1
  			const p = Pos(newLine, newColumn)
  		indexToPos.set(index, p)
  		return p
  	}
  */

		const o = function (t) {
			res.push(t);
		},
		      pos = function () {
			return _esastDistLoc.Pos(line, column);
		},
		      loc = function () {
			return _esastDistLoc.singleCharLoc(pos());
		},
		      prev = function () {
			return str.charCodeAt(index - 1);
		},
		      peek = function () {
			return str.charCodeAt(index);
		},
		      eat = function () {
			const ch = str.charCodeAt(index);
			index = index + 1;
			column = column + 1;
			return ch;
		},
		      tryEat = function (ch) {
			const canEat = peek() === ch;
			if (canEat) {
				index = index + 1;
				column = column + 1;
			}
			return canEat;
		},
		      tryEatNewline = function () {
			const canEat = peek() === Newline;
			if (canEat) {
				index = index + 1;
				line = line + 1;
				column = _esastDistLoc.StartColumn;
			}
			return canEat;
		},
		     

		// Caller must ensure that backing up nCharsToBackUp characters brings us to oldPos.
		stepBackMany = function (oldPos, nCharsToBackUp) {
			index = index - nCharsToBackUp;
			line = oldPos.line;
			column = oldPos.column;
		},
		      _skipWhile = function (pred) {
			const startIndex = index;
			while (pred(peek())) index = index + 1;
			const diff = index - startIndex;
			column = column + diff;
			return diff;
		},
		      takeWhileWithPrev = function (pred) {
			const startIndex = index;
			_skipWhile(pred);
			return str.slice(startIndex - 1, index);
		},
		      takeWhile = function (pred) {
			const startIndex = index;
			_skipWhile(pred);
			return str.slice(startIndex, index);
		},
		      skipWhileEquals = function (ch) {
			return _skipWhile(function (_) {
				return _ === ch;
			});
		},
		     

		// Called after seeing the first newline.
		skipNewlines = function () {
			line = line + 1;
			const startLine = line;
			while (peek() === Newline) {
				index = index + 1;
				line = line + 1;
			}
			column = _esastDistLoc.StartColumn;
			return line - startLine;
		},
		      skipRestOfLine = function () {
			return _skipWhile(function (_) {
				return _ !== Newline;
			});
		};

		const ungrouped = function (isInQuote) {
			let indent = 0;

			let ch, startColumn;
			const loc = function () {
				return _Loc(_esastDistLoc.Pos(line, startColumn), pos());
			},
			      keyword = function (k) {
				return _Token.Keyword(loc(), k);
			},
			      gp = function (k) {
				return o(_GroupPre2(loc(), k));
			},
			      eatNumber = function () {
				const lit = takeWhileWithPrev(_char.isNumberCharacter);
				const num = Number(lit);
				cx.check(!Number.isNaN(num), pos, function () {
					return 'Invalid number literal ' + _CompileError.code(lit);
				});
				return _Token.TokenNumberLiteral(loc(), num);
			};

			while (index !== str.length) {
				startColumn = column;
				ch = eat();
				switch (ch) {
					case N0:case N1:case N2:case N3:case N4:
					case N5:case N6:case N7:case N8:case N9:
						o(eatNumber());
						break;
					case OpParen:
						gp(_GroupPre.GP_OpenParen);
						break;
					case OpBracket:
						gp(_GroupPre.GP_OpenBracket);
						break;
					case ClParen:
						gp(_GroupPre.GP_CloseParen);
						break;
					case ClBracket:
						gp(_GroupPre.GP_CloseBracket);
						break;
					case ClBrace:
						cx.check(isInQuote, loc, function () {
							return 'Reserved character ' + _char.showChar(ch);
						});
						return;
					case Space:
						cx.warnIf(peek() === Space, loc, 'Multiple spaces in a row');
						gp(_GroupPre.GP_Space);
						break;
					case Dot:
						{
							const p = peek();
							if (p === Space || p === Newline) {
								// ObjLit assign in its own spaced group.
								// We can't just create a new Group here because we want to
								// ensure it's not part of the preceding or following spaced group.
								gp(_GroupPre.GP_Space);
								o(keyword(_Token.KW_ObjAssign));
								gp(_GroupPre.GP_Space);
							} else o(_Token.DotName(loc(),
							// +1 for the dot we just skipped.
							skipWhileEquals(Dot) + 1, takeWhile(_char.isNameCharacter)));
							break;
						}
					case Colon:
						o(keyword(_Token.KW_Type));
						break;
					case Tilde:
						if (tryEat(Bar)) {
							o(keyword(_Token.KW_GenFun));
							gp(_GroupPre.GP_Space);
							break;
						} else {
							o(keyword(_Token.KW_Lazy));
							break;
						}
						break;
					case Bar:
						o(keyword(_Token.KW_Fun));
						// First arg in its own spaced group
						gp(_GroupPre.GP_Space);
						break;
					case Underscore:
						o(keyword(_Token.KW_Focus));
						break;
					case Hash:
						if (!(tryEat(Space) || tryEat(Tab))) cx.fail(loc, function () {
							return '' + _CompileError.code('#') + ' must be followed by space or tab.}';
						});
						skipRestOfLine();
						break;
					case Newline:
						{
							cx.check(!isInQuote, loc, 'Quote interpolation cannot contain newline');
							cx.check(prev() !== Space, loc, 'Line ends in a space');

							// Skip any blank lines.
							skipNewlines();
							const oldIndent = indent;
							indent = skipWhileEquals(Tab);
							cx.check(peek() !== Space, pos, 'Line begins in a space');
							if (indent <= oldIndent) {
								for (let i = indent; i < oldIndent; i = i + 1) gp(_GroupPre.GP_CloseBlock);
								gp(_GroupPre.GP_Line);
							} else {
								cx.check(indent === oldIndent + 1, loc, 'Line is indented more than once');
								gp(_GroupPre.GP_OpenBlock);
							}
							break;
						}
					case Quote:
						lexQuote(indent);
						break;
					case Ampersand:case Backslash:case Backtick:case Caret:
					case Comma:case Percent:case Semicolon:
						cx.fail(loc, 'Reserved character ' + _char.showChar(ch));
					case Tab:
						cx.fail(loc(), 'Tab may only be used to indent');
					case Hyphen:
						if (_char.isDigit(peek())) {
							o(eatNumber());
							break;
						}
					// else fallthrough
					default:
						{
							// All other characters should be handled in a case above.
							const name = takeWhileWithPrev(_char.isNameCharacter);
							const k = _Token.keywordKFromName(name);
							if (k !== undefined) {
								if (k === _Token.KW_Region) skipRestOfLine();
								o(keyword(k));
							} else if (tryEat(Underscore)) o(_Token.CallOnFocus(loc(), name));else {
								cx.check(!_Lang.isReservedName(name), pos, function () {
									return 'Reserved name ' + _CompileError.code(name);
								});
								o(_Token.Name(loc(), name));
							}
						}
				}
			}
		};

		const lexQuote = function (indent) {
			const quoteIndent = indent + 1;

			const isIndented = tryEatNewline();
			if (isIndented) {
				const actualIndent = skipWhileEquals(Tab);
				cx.check(actualIndent === quoteIndent, pos, 'Indented quote must have exactly one more indent than previous line.');
			}

			let read = '';

			const yieldRead = function () {
				if (read !== '') {
					o(read);
					read = '';
				}
			};

			o(_GroupPre2(loc(), _GroupPre.GP_OpenQuote));

			eatChars: while (true) {
				const chPos = pos();
				const ch = eat();
				switch (ch) {
					case Backslash:
						{
							read = read + quoteEscape(eat());
							break;
						}
					case OpBrace:
						{
							yieldRead();
							// We can't create a Group now because there may be other GroupPre_s inside.
							o(_GroupPre2(_esastDistLoc.singleCharLoc(chPos), _GroupPre.GP_OpenParen));
							ungrouped(true);
							o(_GroupPre2(loc(), _GroupPre.GP_CloseParen));
							break;
						}
					case Newline:
						{
							cx.check(prev !== Space, chPos, 'Line ends in a space');
							cx.check(isIndented, chPos, 'Unclosed quote.');
							// Allow extra blank lines.
							const numNewlines = skipNewlines() + 1;
							const newIndent = skipWhileEquals(Tab);
							if (newIndent < quoteIndent) {
								// Indented quote section is over.
								// Undo reading the tabs and newline.
								stepBackMany(chPos, numNewlines + newIndent);
								_UUtil.assert(peek() === Newline);
								break eatChars;
							} else read = read + '\n'.repeat(numNewlines) + '\t'.repeat(newIndent - quoteIndent);
							break;
						}
					case Quote:
						if (!isIndented) break eatChars;
					// Else fallthrough
					default:
						read = read + String.fromCharCode(ch);
				}
			}

			yieldRead();
			o(_GroupPre2(loc(), _GroupPre.GP_CloseQuote));
		};

		const quoteEscape = function (ch) {
			switch (ch) {
				case OpBrace:
					return '{';
				case LetterN:
					return '\n';
				case LetterT:
					return '\t';
				case Quote:
					return '"';
				case Backslash:
					return '\\';
				default:
					cx.fail(pos, 'No need to escape ' + _char.showChar(ch));
			}
		};

		ungrouped(false);
		return res;
	};
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1ldGEvY29tcGlsZS9wcml2YXRlL2xleC91bmdyb3VwZWQuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBV0EsT0FBTSxFQUFFLEdBQUcsVUFBQSxFQUFFO1NBQUksRUFBRSxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUM7RUFBQSxDQUFBO0FBQ2pDLE9BQ0MsRUFBRSxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUM7T0FBRSxFQUFFLEdBQUcsRUFBRSxDQUFDLEdBQUcsQ0FBQztPQUFFLEVBQUUsR0FBRyxFQUFFLENBQUMsR0FBRyxDQUFDO09BQUUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUM7T0FBRSxFQUFFLEdBQUcsRUFBRSxDQUFDLEdBQUcsQ0FBQztPQUNwRSxFQUFFLEdBQUcsRUFBRSxDQUFDLEdBQUcsQ0FBQztPQUFFLEVBQUUsR0FBRyxFQUFFLENBQUMsR0FBRyxDQUFDO09BQUUsRUFBRSxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUM7T0FBRSxFQUFFLEdBQUcsRUFBRSxDQUFDLEdBQUcsQ0FBQztPQUFFLEVBQUUsR0FBRyxFQUFFLENBQUMsR0FBRyxDQUFDO09BQ3BFLE9BQU8sR0FBRyxFQUFFLENBQUMsR0FBRyxDQUFDO09BQUUsU0FBUyxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUM7T0FBRSxPQUFPLEdBQUcsRUFBRSxDQUFDLEdBQUcsQ0FBQztPQUN6RCxPQUFPLEdBQUcsRUFBRSxDQUFDLEdBQUcsQ0FBQztPQUFFLFNBQVMsR0FBRyxFQUFFLENBQUMsR0FBRyxDQUFDO09BQUUsT0FBTyxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUM7T0FDekQsU0FBUyxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUM7T0FDbkIsU0FBUyxHQUFHLEVBQUUsQ0FBQyxJQUFJLENBQUM7T0FDcEIsUUFBUSxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUM7T0FDbEIsR0FBRyxHQUFHLEVBQUUsQ0FBQyxHQUFHLENBQUM7T0FDYixLQUFLLEdBQUcs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eEIsU0FBSyxPQUFPO0FBQUUsWUFBTyxJQUFJLENBQUE7QUFBQSxBQUN6QixTQUFLLE9BQU87QUFBRSxZQUFPLElBQUksQ0FBQTtBQUFBLEFBQ3pCLFNBQUssS0FBSztBQUFFLFlBQU8sR0FBRyxDQUFBO0FBQUEsQUFDdEIsU0FBSyxTQUFTO0FBQUUsWUFBTyxJQUFJLENBQUE7QUFBQSxBQUMzQjtBQUFTLE9BQUUsQ0FBQyxJQUFJLENBQUMsR0FBRyx5QkFBdUIsTUF2V3JDLFFBQVEsQ0F1V3NDLEVBQUUsQ0FBQyxDQUFHLENBQUE7QUFBQSxJQUMxRDtHQUNELENBQUE7O0FBRUQsV0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFBO0FBQ2hCLFNBQU8sR0FBRyxDQUFBO0VBQ1YiLCJmaWxlIjoibWV0YS9jb21waWxlL3ByaXZhdGUvbGV4L3VuZ3JvdXBlZC5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBMb2MsIHsgUG9zLCBTdGFydExpbmUsIFN0YXJ0Q29sdW1uLCBzaW5nbGVDaGFyTG9jIH0gZnJvbSAnZXNhc3QvZGlzdC9Mb2MnXG5pbXBvcnQgeyBjb2RlIH0gZnJvbSAnLi4vLi4vQ29tcGlsZUVycm9yJ1xuaW1wb3J0IHsgaXNSZXNlcnZlZE5hbWUgfSBmcm9tICcuLi9MYW5nJ1xuaW1wb3J0IHsgQ2FsbE9uRm9jdXMsIERvdE5hbWUsIEtleXdvcmQsIFRva2VuTnVtYmVyTGl0ZXJhbCwgTmFtZSxcblx0a2V5d29yZEtGcm9tTmFtZSxcblx0S1dfRm9jdXMsIEtXX0Z1biwgS1dfR2VuRnVuLCBLV19MYXp5LCBLV19PYmpBc3NpZ24sIEtXX1JlZ2lvbiwgS1dfVHlwZSB9IGZyb20gJy4uL1Rva2VuJ1xuaW1wb3J0IHsgYXNzZXJ0IH0gZnJvbSAnLi4vVS91dGlsJ1xuaW1wb3J0IEdyb3VwUHJlLCB7IEdQX09wZW5QYXJlbiwgR1BfT3BlbkJyYWNrZXQsIEdQX09wZW5CbG9jaywgR1BfT3BlblF1b3RlLCBHUF9MaW5lLFxuXHRHUF9TcGFjZSwgR1BfQ2xvc2VQYXJlbiwgR1BfQ2xvc2VCcmFja2V0LCBHUF9DbG9zZUJsb2NrLCBHUF9DbG9zZVF1b3RlfSBmcm9tICcuL0dyb3VwUHJlJ1xuaW1wb3J0IHsgc2hvd0NoYXIsIGlzRGlnaXQsIGlzTmFtZUNoYXJhY3RlciwgaXNOdW1iZXJDaGFyYWN0ZXIgfSBmcm9tICcuL2NoYXInXG5cbmNvbnN0IGNjID0gY2ggPT4gY2guY2hhckNvZGVBdCgwKVxuY29uc3Rcblx0TjAgPSBjYygnMCcpLCBOMSA9IGNjKCcxJyksIE4yID0gY2MoJzInKSwgTjMgPSBjYygnMycpLCBONCA9IGNjKCc0JyksXG5cdE41ID0gY2MoJzUnKSwgTjYgPSBjYygnNicpLCBONyA9IGNjKCc3JyksIE44ID0gY2MoJzgnKSwgTjkgPSBjYygnOScpLFxuXHRPcFBhcmVuID0gY2MoJygnKSwgT3BCcmFja2V0ID0gY2MoJ1snKSwgT3BCcmFjZSA9IGNjKCd7JyksXG5cdENsUGFyZW4gPSBjYygnKScpLCBDbEJyYWNrZXQgPSBjYygnXScpLCBDbEJyYWNlID0gY2MoJ30nKSxcblx0QW1wZXJzYW5kID0gY2MoJyYnKSxcblx0QmFja3NsYXNoID0gY2MoJ1xcXFwnKSxcblx0QmFja3RpY2sgPSBjYygnYCcpLFxuXHRCYXIgPSBjYygnfCcpLFxuXHRDYXJldCA9IGNjKCdeJyksXG5cdENvbG9uID0gY2MoJzonKSxcblx0Q29tbWEgPSBjYygnLCcpLFxuXHREb3QgPSBjYygnLicpLFxuXHRIYXNoID0gY2MoJyMnKSxcblx0SHlwaGVuID0gY2MoJy0nKSxcblx0TGV0dGVyTiA9IGNjKCduJyksXG5cdExldHRlclQgPSBjYygndCcpLFxuXHROZXdsaW5lID0gY2MoJ1xcbicpLFxuXHRQZXJjZW50ID0gY2MoJyUnKSxcblx0UXVvdGUgPSBjYygnXCInKSxcblx0U2VtaWNvbG9uID0gY2MoJzsnKSxcblx0U3BhY2UgPSBjYygnICcpLFxuXHRUYWIgPSBjYygnXFx0JyksXG5cdFRpbGRlID0gY2MoJ34nKSxcblx0VW5kZXJzY29yZSA9IGNjKCdfJylcblxuZXhwb3J0IGRlZmF1bHQgKGN4LCBzdHIpID0+IHtcblx0Y29uc3QgcmVzID0gWyBdXG5cdGxldCBsaW5lID0gU3RhcnRMaW5lXG5cdGxldCBjb2x1bW4gPSBTdGFydENvbHVtblxuXHRsZXQgaW5kZXggPSAwXG5cblx0Ly8gVXNlIHRoZXNlIGZvciBkZWJ1Z2dpbmcgcG9zLlxuXHQvKlxuXHRjb25zdFxuXHRcdGNoZWNrUG9zID0gKCkgPT4ge1xuXHRcdFx0Y29uc3QgcCA9IGdldENvcnJlY3RQb3MoKVxuXHRcdFx0aWYgKHAubGluZSAhPT0gbGluZSB8fCBwLmNvbHVtbiAhPT0gY29sdW1uKVxuXHRcdFx0XHR0aHJvdyBuZXcgRXJyb3IoYGluZGV4OiAke2luZGV4fSwgd3Jvbmc6ICR7UG9zKGxpbmUsIGNvbHVtbil9LCByaWdodDogJHtwfWApXG5cdFx0fSxcblx0XHRpbmRleFRvUG9zID0gbmV3IE1hcCgpLFxuXHRcdGdldENvcnJlY3RQb3MgPSAoKSA9PiB7XG5cdFx0XHRpZiAoaW5kZXggPT09IDApXG5cdFx0XHRcdHJldHVybiBQb3MoU3RhcnRMaW5lLCBTdGFydENvbHVtbilcblxuXHRcdFx0bGV0IG9sZFBvcywgb2xkSW5kZXhcblx0XHRcdGZvciAob2xkSW5kZXggPSBpbmRleCAtIDE7IG9sZEluZGV4ID4gMDsgb2xkSW5kZXggPSBvbGRJbmRleCAtIDEpIHtcblx0XHRcdFx0b2xkUG9zID0gaW5kZXhUb1Bvcy5nZXQob2xkSW5kZXgpXG5cdFx0XHRcdGlmIChvbGRQb3MpXG5cdFx0XHRcdFx0YnJlYWtcblx0XHRcdH1cblx0XHRcdGlmIChvbGRQb3MgPT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRhc3NlcnQob2xkSW5kZXggPT09IDApXG5cdFx0XHRcdG9sZFBvcyA9IFBvcyhTdGFydExpbmUsIFN0YXJ0Q29sdW1uKVxuXHRcdFx0fVxuXHRcdFx0bGV0IG5ld0xpbmUgPSBvbGRQb3MubGluZSwgbmV3Q29sdW1uID0gb2xkUG9zLmNvbHVtblxuXHRcdFx0Zm9yICg7IG9sZEluZGV4IDwgaW5kZXg7IG9sZEluZGV4ID0gb2xkSW5kZXggKyAxKVxuXHRcdFx0XHRpZiAoc3RyLmNoYXJDb2RlQXQob2xkSW5kZXgpID09PSBOZXdsaW5lKSB7XG5cdFx0XHRcdFx0bmV3TGluZSA9IG5ld0xpbmUgKyAxXG5cdFx0XHRcdFx0bmV3Q29sdW1uID0gU3RhcnRDb2x1bW5cblx0XHRcdFx0fSBlbHNlXG5cdFx0XHRcdFx0bmV3Q29sdW1uID0gbmV3Q29sdW1uICsgMVxuXG5cdFx0XHRjb25zdCBwID0gUG9zKG5ld0xpbmUsIG5ld0NvbHVtbilcblx0XHRcdGluZGV4VG9Qb3Muc2V0KGluZGV4LCBwKVxuXHRcdFx0cmV0dXJuIHBcblx0XHR9XG5cdCovXG5cblx0Y29uc3Rcblx0XHRvID0gdCA9PiB7IHJlcy5wdXNoKHQpIH0sXG5cblx0XHRwb3MgPSAoKSA9PiBQb3MobGluZSwgY29sdW1uKSxcblx0XHRsb2MgPSAoKSA9PiBzaW5nbGVDaGFyTG9jKHBvcygpKSxcblxuXHRcdHByZXYgPSAoKSA9PiBzdHIuY2hhckNvZGVBdChpbmRleCAtIDEpLFxuXHRcdHBlZWsgPSAoKSA9PiBzdHIuY2hhckNvZGVBdChpbmRleCksXG5cblx0XHRlYXQgPSAoKSA9PiB7XG5cdFx0XHRjb25zdCBjaCA9IHN0ci5jaGFyQ29kZUF0KGluZGV4KVxuXHRcdFx0aW5kZXggPSBpbmRleCArIDFcblx0XHRcdGNvbHVtbiA9IGNvbHVtbiArIDFcblx0XHRcdHJldHVybiBjaFxuXHRcdH0sXG5cdFx0dHJ5RWF0ID0gY2ggPT4ge1xuXHRcdFx0Y29uc3QgY2FuRWF0ID0gcGVlaygpID09PSBjaFxuXHRcdFx0aWYgKGNhbkVhdCkge1xuXHRcdFx0XHRpbmRleCA9IGluZGV4ICsgMVxuXHRcdFx0XHRjb2x1bW4gPSBjb2x1bW4gKyAxXG5cdFx0XHR9XG5cdFx0XHRyZXR1cm4gY2FuRWF0XG5cdFx0fSxcblx0XHR0cnlFYXROZXdsaW5lID0gKCkgPT4ge1xuXHRcdFx0Y29uc3QgY2FuRWF0ID0gcGVlaygpID09PSBOZXdsaW5lXG5cdFx0XHRpZiAoY2FuRWF0KSB7XG5cdFx0XHRcdGluZGV4ID0gaW5kZXggKyAxXG5cdFx0XHRcdGxpbmUgPSBsaW5lICsgMVxuXHRcdFx0XHRjb2x1bW4gPSBTdGFydENvbHVtblxuXHRcdFx0fVxuXHRcdFx0cmV0dXJuIGNhbkVhdFxuXHRcdH0sXG5cblx0XHQvLyBDYWxsZXIgbXVzdCBlbnN1cmUgdGhhdCBiYWNraW5nIHVwIG5DaGFyc1RvQmFja1VwIGNoYXJhY3RlcnMgYnJpbmdzIHVzIHRvIG9sZFBvcy5cblx0XHRzdGVwQmFja01hbnkgPSAob2xkUG9zLCBuQ2hhcnNUb0JhY2tVcCkgPT4ge1xuXHRcdFx0aW5kZXggPSBpbmRleCAtIG5DaGFyc1RvQmFja1VwXG5cdFx0XHRsaW5lID0gb2xkUG9zLmxpbmVcblx0XHRcdGNvbHVtbiA9IG9sZFBvcy5jb2x1bW5cblx0XHR9LFxuXG5cdFx0X3NraXBXaGlsZSA9IHByZWQgPT4ge1xuXHRcdFx0Y29uc3Qgc3RhcnRJbmRleCA9IGluZGV4XG5cdFx0XHR3aGlsZSAocHJlZChwZWVrKCkpKVxuXHRcdFx0XHRpbmRleCA9IGluZGV4ICsgMVxuXHRcdFx0Y29uc3QgZGlmZiA9IGluZGV4IC0gc3RhcnRJbmRleFxuXHRcdFx0Y29sdW1uID0gY29sdW1uICsgZGlmZlxuXHRcdFx0cmV0dXJuIGRpZmZcblx0XHR9LFxuXHRcdHRha2VXaGlsZVdpdGhQcmV2ID0gcHJlZCA9PiB7XG5cdFx0XHRjb25zdCBzdGFydEluZGV4ID0gaW5kZXhcblx0XHRcdF9za2lwV2hpbGUocHJlZClcblx0XHRcdHJldHVybiBzdHIuc2xpY2Uoc3RhcnRJbmRleCAtIDEsIGluZGV4KVxuXHRcdH0sXG5cdFx0dGFrZVdoaWxlID0gcHJlZCA9PiB7XG5cdFx0XHRjb25zdCBzdGFydEluZGV4ID0gaW5kZXhcblx0XHRcdF9za2lwV2hpbGUocHJlZClcblx0XHRcdHJldHVybiBzdHIuc2xpY2Uoc3RhcnRJbmRleCwgaW5kZXgpXG5cdFx0fSxcblx0XHRza2lwV2hpbGVFcXVhbHMgPSBjaCA9PiBfc2tpcFdoaWxlKF8gPT4gXyA9PT0gY2gpLFxuXG5cdFx0Ly8gQ2FsbGVkIGFmdGVyIHNlZWluZyB0aGUgZmlyc3QgbmV3bGluZS5cblx0XHRza2lwTmV3bGluZXMgPSAoKSA9PiB7XG5cdFx0XHRsaW5lID0gbGluZSArIDFcblx0XHRcdGNvbnN0IHN0YXJ0TGluZSA9IGxpbmVcblx0XHRcdHdoaWxlIChwZWVrKCkgPT09IE5ld2xpbmUpIHtcblx0XHRcdFx0aW5kZXggPSBpbmRleCArIDFcblx0XHRcdFx0bGluZSA9IGxpbmUgKyAxXG5cdFx0XHR9XG5cdFx0XHRjb2x1bW4gPSBTdGFydENvbHVtblxuXHRcdFx0cmV0dXJuIGxpbmUgLSBzdGFydExpbmVcblx0XHR9LFxuXG5cdFx0c2tpcFJlc3RPZkxpbmUgPSAoKSA9PlxuXHRcdFx0X3NraXBXaGlsZShfID0+IF8gIT09IE5ld2xpbmUpXG5cblx0Y29uc3QgdW5ncm91cGVkID0gaXNJblF1b3RlID0+IHtcblx0XHRsZXQgaW5kZW50ID0gMFxuXG5cdFx0bGV0IGNoLCBzdGFydENvbHVtblxuXHRcdGNvbnN0XG5cdFx0XHRsb2MgPSAoKSA9PiBMb2MoUG9zKGxpbmUsIHN0YXJ0Q29sdW1uKSwgcG9zKCkpLFxuXHRcdFx0a2V5d29yZCA9IGsgPT4gS2V5d29yZChsb2MoKSwgayksXG5cdFx0XHRncCA9IGsgPT4gbyhHcm91cFByZShsb2MoKSwgaykpLFxuXHRcdFx0ZWF0TnVtYmVyID0gKCkgPT4ge1xuXHRcdFx0XHRjb25zdCBsaXQgPSB0YWtlV2hpbGVXaXRoUHJldihpc051bWJlckNoYXJhY3Rlcilcblx0XHRcdFx0Y29uc3QgbnVtID0gTnVtYmVyKGxpdClcblx0XHRcdFx0Y3guY2hlY2soIU51bWJlci5pc05hTihudW0pLCBwb3MsICgpID0+XG5cdFx0XHRcdFx0YEludmFsaWQgbnVtYmVyIGxpdGVyYWwgJHtjb2RlKGxpdCl9YClcblx0XHRcdFx0cmV0dXJuIFRva2VuTnVtYmVyTGl0ZXJhbChsb2MoKSwgbnVtKVxuXHRcdFx0fVxuXG5cdFx0d2hpbGUgKGluZGV4ICE9PSBzdHIubGVuZ3RoKSB7XG5cdFx0XHRzdGFydENvbHVtbiA9IGNvbHVtblxuXHRcdFx0Y2ggPSBlYXQoKVxuXHRcdFx0c3dpdGNoIChjaCkge1xuXHRcdFx0XHRjYXNlIE4wOiBjYXNlIE4xOiBjYXNlIE4yOiBjYXNlIE4zOiBjYXNlIE40OlxuXHRcdFx0XHRjYXNlIE41OiBjYXNlIE42OiBjYXNlIE43OiBjYXNlIE44OiBjYXNlIE45OlxuXHRcdFx0XHRcdG8oZWF0TnVtYmVyKCkpXG5cdFx0XHRcdFx0YnJlYWtcblx0XHRcdFx0Y2FzZSBPcFBhcmVuOlxuXHRcdFx0XHRcdGdwKEdQX09wZW5QYXJlbilcblx0XHRcdFx0XHRicmVha1xuXHRcdFx0XHRjYXNlIE9wQnJhY2tldDpcblx0XHRcdFx0XHRncChHUF9PcGVuQnJhY2tldClcblx0XHRcdFx0XHRicmVha1xuXHRcdFx0XHRjYXNlIENsUGFyZW46XG5cdFx0XHRcdFx0Z3AoR1BfQ2xvc2VQYXJlbilcblx0XHRcdFx0XHRicmVha1xuXHRcdFx0XHRjYXNlIENsQnJhY2tldDpcblx0XHRcdFx0XHRncChHUF9DbG9zZUJyYWNrZXQpXG5cdFx0XHRcdFx0YnJlYWtcblx0XHRcdFx0Y2FzZSBDbEJyYWNlOlxuXHRcdFx0XHRcdGN4LmNoZWNrKGlzSW5RdW90ZSwgbG9jLCAoKSA9PiBgUmVzZXJ2ZWQgY2hhcmFjdGVyICR7c2hvd0NoYXIoY2gpfWApXG5cdFx0XHRcdFx0cmV0dXJuXG5cdFx0XHRcdGNhc2UgU3BhY2U6XG5cdFx0XHRcdFx0Y3gud2FybklmKHBlZWsoKSA9PT0gU3BhY2UsIGxvYywgJ011bHRpcGxlIHNwYWNlcyBpbiBhIHJvdycpXG5cdFx0XHRcdFx0Z3AoR1BfU3BhY2UpXG5cdFx0XHRcdFx0YnJlYWtcblx0XHRcdFx0Y2FzZSBEb3Q6IHtcblx0XHRcdFx0XHRjb25zdCBwID0gcGVlaygpXG5cdFx0XHRcdFx0aWYgKHAgPT09IFNwYWNlIHx8IHAgPT09IE5ld2xpbmUpIHtcblx0XHRcdFx0XHRcdC8vIE9iakxpdCBhc3NpZ24gaW4gaXRzIG93biBzcGFjZWQgZ3JvdXAuXG5cdFx0XHRcdFx0XHQvLyBXZSBjYW4ndCBqdXN0IGNyZWF0ZSBhIG5ldyBHcm91cCBoZXJlIGJlY2F1c2Ugd2Ugd2FudCB0b1xuXHRcdFx0XHRcdFx0Ly8gZW5zdXJlIGl0J3Mgbm90IHBhcnQgb2YgdGhlIHByZWNlZGluZyBvciBmb2xsb3dpbmcgc3BhY2VkIGdyb3VwLlxuXHRcdFx0XHRcdFx0Z3AoR1BfU3BhY2UpXG5cdFx0XHRcdFx0XHRvKGtleXdvcmQoS1dfT2JqQXNzaWduKSlcblx0XHRcdFx0XHRcdGdwKEdQX1NwYWNlKVxuXHRcdFx0XHRcdH0gZWxzZVxuXHRcdFx0XHRcdFx0byhEb3ROYW1lKFxuXHRcdFx0XHRcdFx0XHRsb2MoKSxcblx0XHRcdFx0XHRcdFx0Ly8gKzEgZm9yIHRoZSBkb3Qgd2UganVzdCBza2lwcGVkLlxuXHRcdFx0XHRcdFx0XHRza2lwV2hpbGVFcXVhbHMoRG90KSArIDEsXG5cdFx0XHRcdFx0XHRcdHRha2VXaGlsZShpc05hbWVDaGFyYWN0ZXIpKSlcblx0XHRcdFx0XHRicmVha1xuXHRcdFx0XHR9XG5cdFx0XHRcdGNhc2UgQ29sb246XG5cdFx0XHRcdFx0byhrZXl3b3JkKEtXX1R5cGUpKVxuXHRcdFx0XHRcdGJyZWFrXG5cdFx0XHRcdGNhc2UgVGlsZGU6XG5cdFx0XHRcdFx0aWYgKHRyeUVhdChCYXIpKSB7XG5cdFx0XHRcdFx0XHRvKGtleXdvcmQoS1dfR2VuRnVuKSlcblx0XHRcdFx0XHRcdGdwKEdQX1NwYWNlKVxuXHRcdFx0XHRcdFx0YnJlYWtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0byhrZXl3b3JkKEtXX0xhenkpKVxuXHRcdFx0XHRcdFx0YnJlYWtcblx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0YnJlYWtcblx0XHRcdFx0Y2FzZSBCYXI6XG5cdFx0XHRcdFx0byhrZXl3b3JkKEtXX0Z1bikpXG5cdFx0XHRcdFx0Ly8gRmlyc3QgYXJnIGluIGl0cyBvd24gc3BhY2VkIGdyb3VwXG5cdFx0XHRcdFx0Z3AoR1BfU3BhY2UpXG5cdFx0XHRcdFx0YnJlYWtcblx0XHRcdFx0Y2FzZSBVbmRlcnNjb3JlOlxuXHRcdFx0XHRcdG8oa2V5d29yZChLV19Gb2N1cykpXG5cdFx0XHRcdFx0YnJlYWtcblx0XHRcdFx0Y2FzZSBIYXNoOlxuXHRcdFx0XHRcdGlmICghKHRyeUVhdChTcGFjZSkgfHwgdHJ5RWF0KFRhYikpKVxuXHRcdFx0XHRcdFx0Y3guZmFpbChsb2MsICgpID0+IGAke2NvZGUoJyMnKX0gbXVzdCBiZSBmb2xsb3dlZCBieSBzcGFjZSBvciB0YWIufWApXG5cdFx0XHRcdFx0c2tpcFJlc3RPZkxpbmUoKVxuXHRcdFx0XHRcdGJyZWFrXG5cdFx0XHRcdGNhc2UgTmV3bGluZToge1xuXHRcdFx0XHRcdGN4LmNoZWNrKCFpc0luUXVvdGUsIGxvYywgJ1F1b3RlIGludGVycG9sYXRpb24gY2Fubm90IGNvbnRhaW4gbmV3bGluZScpXG5cdFx0XHRcdFx0Y3guY2hlY2socHJldigpICE9PSBTcGFjZSwgbG9jLCAnTGluZSBlbmRzIGluIGEgc3BhY2UnKVxuXG5cdFx0XHRcdFx0Ly8gU2tpcCBhbnkgYmxhbmsgbGluZXMuXG5cdFx0XHRcdFx0c2tpcE5ld2xpbmVzKClcblx0XHRcdFx0XHRjb25zdCBvbGRJbmRlbnQgPSBpbmRlbnRcblx0XHRcdFx0XHRpbmRlbnQgPSBza2lwV2hpbGVFcXVhbHMoVGFiKVxuXHRcdFx0XHRcdGN4LmNoZWNrKHBlZWsoKSAhPT0gU3BhY2UsIHBvcywgJ0xpbmUgYmVnaW5zIGluIGEgc3BhY2UnKVxuXHRcdFx0XHRcdGlmIChpbmRlbnQgPD0gb2xkSW5kZW50KSB7XG5cdFx0XHRcdFx0XHRmb3IgKGxldCBpID0gaW5kZW50OyBpIDwgb2xkSW5kZW50OyBpID0gaSArIDEpXG5cdFx0XHRcdFx0XHRcdGdwKEdQX0Nsb3NlQmxvY2spXG5cdFx0XHRcdFx0XHRncChHUF9MaW5lKVxuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRjeC5jaGVjayhpbmRlbnQgPT09IG9sZEluZGVudCArIDEsIGxvYywgJ0xpbmUgaXMgaW5kZW50ZWQgbW9yZSB0aGFuIG9uY2UnKVxuXHRcdFx0XHRcdFx0Z3AoR1BfT3BlbkJsb2NrKVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0XHRicmVha1xuXHRcdFx0XHR9XG5cdFx0XHRcdGNhc2UgUXVvdGU6XG5cdFx0XHRcdFx0bGV4UXVvdGUoaW5kZW50KVxuXHRcdFx0XHRcdGJyZWFrXG5cdFx0XHRcdGNhc2UgQW1wZXJzYW5kOiBjYXNlIEJhY2tzbGFzaDogY2FzZSBCYWNrdGljazogY2FzZSBDYXJldDpcblx0XHRcdFx0Y2FzZSBDb21tYTogY2FzZSBQZXJjZW50OiBjYXNlIFNlbWljb2xvbjpcblx0XHRcdFx0XHRjeC5mYWlsKGxvYywgYFJlc2VydmVkIGNoYXJhY3RlciAke3Nob3dDaGFyKGNoKX1gKVxuXHRcdFx0XHRjYXNlIFRhYjpcblx0XHRcdFx0XHRjeC5mYWlsKGxvYygpLCAnVGFiIG1heSBvbmx5IGJlIHVzZWQgdG8gaW5kZW50Jylcblx0XHRcdFx0Y2FzZSBIeXBoZW46XG5cdFx0XHRcdFx0aWYgKGlzRGlnaXQocGVlaygpKSkge1xuXHRcdFx0XHRcdFx0byhlYXROdW1iZXIoKSlcblx0XHRcdFx0XHRcdGJyZWFrXG5cdFx0XHRcdFx0fVxuXHRcdFx0XHRcdC8vIGVsc2UgZmFsbHRocm91Z2hcblx0XHRcdFx0ZGVmYXVsdDoge1xuXHRcdFx0XHRcdC8vIEFsbCBvdGhlciBjaGFyYWN0ZXJzIHNob3VsZCBiZSBoYW5kbGVkIGluIGEgY2FzZSBhYm92ZS5cblx0XHRcdFx0XHRjb25zdCBuYW1lID0gdGFrZVdoaWxlV2l0aFByZXYoaXNOYW1lQ2hhcmFjdGVyKVxuXHRcdFx0XHRcdGNvbnN0IGsgPSBrZXl3b3JkS0Zyb21OYW1lKG5hbWUpXG5cdFx0XHRcdFx0aWYgKGsgIT09IHVuZGVmaW5lZCkge1xuXHRcdFx0XHRcdFx0aWYgKGsgPT09IEtXX1JlZ2lvbilcblx0XHRcdFx0XHRcdFx0c2tpcFJlc3RPZkxpbmUoKVxuXHRcdFx0XHRcdFx0byhrZXl3b3JkKGspKVxuXHRcdFx0XHRcdH0gZWxzZSBpZiAodHJ5RWF0KFVuZGVyc2NvcmUpKVxuXHRcdFx0XHRcdFx0byhDYWxsT25Gb2N1cyhsb2MoKSwgbmFtZSkpXG5cdFx0XHRcdFx0ZWxzZSB7XG5cdFx0XHRcdFx0XHRjeC5jaGVjayghaXNSZXNlcnZlZE5hbWUobmFtZSksIHBvcywgKCkgPT4gYFJlc2VydmVkIG5hbWUgJHtjb2RlKG5hbWUpfWApXG5cdFx0XHRcdFx0XHRvKE5hbWUobG9jKCksIG5hbWUpKVxuXHRcdFx0XHRcdH1cblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdGNvbnN0IGxleFF1b3RlID0gaW5kZW50ID0+IHtcblx0XHRjb25zdCBxdW90ZUluZGVudCA9IGluZGVudCArIDFcblxuXHRcdGNvbnN0IGlzSW5kZW50ZWQgPSB0cnlFYXROZXdsaW5lKClcblx0XHRpZiAoaXNJbmRlbnRlZCkge1xuXHRcdFx0Y29uc3QgYWN0dWFsSW5kZW50ID0gc2tpcFdoaWxlRXF1YWxzKFRhYilcblx0XHRcdGN4LmNoZWNrKGFjdHVhbEluZGVudCA9PT0gcXVvdGVJbmRlbnQsIHBvcyxcblx0XHRcdFx0J0luZGVudGVkIHF1b3RlIG11c3QgaGF2ZSBleGFjdGx5IG9uZSBtb3JlIGluZGVudCB0aGFuIHByZXZpb3VzIGxpbmUuJylcblx0XHR9XG5cblx0XHRsZXQgcmVhZCA9ICcnXG5cblx0XHRjb25zdCB5aWVsZFJlYWQgPSAoKSA9PiB7XG5cdFx0XHRpZiAocmVhZCAhPT0gJycpIHtcblx0XHRcdFx0byhyZWFkKVxuXHRcdFx0XHRyZWFkID0gJydcblx0XHRcdH1cblx0XHR9XG5cblx0XHRvKEdyb3VwUHJlKGxvYygpLCBHUF9PcGVuUXVvdGUpKVxuXG5cdFx0ZWF0Q2hhcnM6IHdoaWxlICh0cnVlKSB7XG5cdFx0XHRjb25zdCBjaFBvcyA9IHBvcygpXG5cdFx0XHRjb25zdCBjaCA9IGVhdCgpXG5cdFx0XHRzd2l0Y2ggKGNoKSB7XG5cdFx0XHRcdGNhc2UgQmFja3NsYXNoOiB7XG5cdFx0XHRcdFx0cmVhZCA9IHJlYWQgKyBxdW90ZUVzY2FwZShlYXQoKSlcblx0XHRcdFx0XHRicmVha1xuXHRcdFx0XHR9XG5cdFx0XHRcdGNhc2UgT3BCcmFjZToge1xuXHRcdFx0XHRcdHlpZWxkUmVhZCgpXG5cdFx0XHRcdFx0Ly8gV2UgY2FuJ3QgY3JlYXRlIGEgR3JvdXAgbm93IGJlY2F1c2UgdGhlcmUgbWF5IGJlIG90aGVyIEdyb3VwUHJlX3MgaW5zaWRlLlxuXHRcdFx0XHRcdG8oR3JvdXBQcmUoc2luZ2xlQ2hhckxvYyhjaFBvcyksIEdQX09wZW5QYXJlbikpXG5cdFx0XHRcdFx0dW5ncm91cGVkKHRydWUpXG5cdFx0XHRcdFx0byhHcm91cFByZShsb2MoKSwgR1BfQ2xvc2VQYXJlbikpXG5cdFx0XHRcdFx0YnJlYWtcblx0XHRcdFx0fVxuXHRcdFx0XHRjYXNlIE5ld2xpbmU6IHtcblx0XHRcdFx0XHRjeC5jaGVjayhwcmV2ICE9PSBTcGFjZSwgY2hQb3MsICdMaW5lIGVuZHMgaW4gYSBzcGFjZScpXG5cdFx0XHRcdFx0Y3guY2hlY2soaXNJbmRlbnRlZCwgY2hQb3MsICdVbmNsb3NlZCBxdW90ZS4nKVxuXHRcdFx0XHRcdC8vIEFsbG93IGV4dHJhIGJsYW5rIGxpbmVzLlxuXHRcdFx0XHRcdGNvbnN0IG51bU5ld2xpbmVzID0gc2tpcE5ld2xpbmVzKCkgKyAxXG5cdFx0XHRcdFx0Y29uc3QgbmV3SW5kZW50ID0gc2tpcFdoaWxlRXF1YWxzKFRhYilcblx0XHRcdFx0XHRpZiAobmV3SW5kZW50IDwgcXVvdGVJbmRlbnQpIHtcblx0XHRcdFx0XHRcdC8vIEluZGVudGVkIHF1b3RlIHNlY3Rpb24gaXMgb3Zlci5cblx0XHRcdFx0XHRcdC8vIFVuZG8gcmVhZGluZyB0aGUgdGFicyBhbmQgbmV3bGluZS5cblx0XHRcdFx0XHRcdHN0ZXBCYWNrTWFueShjaFBvcywgbnVtTmV3bGluZXMgKyBuZXdJbmRlbnQpXG5cdFx0XHRcdFx0XHRhc3NlcnQocGVlaygpID09PSBOZXdsaW5lKVxuXHRcdFx0XHRcdFx0YnJlYWsgZWF0Q2hhcnNcblx0XHRcdFx0XHR9IGVsc2Vcblx0XHRcdFx0XHRcdHJlYWQgPSByZWFkICtcblx0XHRcdFx0XHRcdFx0J1xcbicucmVwZWF0KG51bU5ld2xpbmVzKSArICdcXHQnLnJlcGVhdChuZXdJbmRlbnQgLSBxdW90ZUluZGVudClcblx0XHRcdFx0XHRicmVha1xuXHRcdFx0XHR9XG5cdFx0XHRcdGNhc2UgUXVvdGU6XG5cdFx0XHRcdFx0aWYgKCFpc0luZGVudGVkKVxuXHRcdFx0XHRcdFx0YnJlYWsgZWF0Q2hhcnNcblx0XHRcdFx0XHQvLyBFbHNlIGZhbGx0aHJvdWdoXG5cdFx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdFx0cmVhZCA9IHJlYWQgKyBTdHJpbmcuZnJvbUNoYXJDb2RlKGNoKVxuXHRcdFx0fVxuXHRcdH1cblxuXHRcdHlpZWxkUmVhZCgpXG5cdFx0byhHcm91cFByZShsb2MoKSwgR1BfQ2xvc2VRdW90ZSkpXG5cdH1cblxuXHRjb25zdCBxdW90ZUVzY2FwZSA9IGNoID0+IHtcblx0XHRzd2l0Y2ggKGNoKSB7XG5cdFx0XHRjYXNlIE9wQnJhY2U6IHJldHVybiAneydcblx0XHRcdGNhc2UgTGV0dGVyTjogcmV0dXJuICdcXG4nXG5cdFx0XHRjYXNlIExldHRlclQ6IHJldHVybiAnXFx0J1xuXHRcdFx0Y2FzZSBRdW90ZTogcmV0dXJuICdcIidcblx0XHRcdGNhc2UgQmFja3NsYXNoOiByZXR1cm4gJ1xcXFwnXG5cdFx0XHRkZWZhdWx0OiBjeC5mYWlsKHBvcywgYE5vIG5lZWQgdG8gZXNjYXBlICR7c2hvd0NoYXIoY2gpfWApXG5cdFx0fVxuXHR9XG5cblx0dW5ncm91cGVkKGZhbHNlKVxuXHRyZXR1cm4gcmVzXG59XG4iXSwic291cmNlUm9vdCI6Ii9zcmMifQ==