if (typeof define !== 'function') var define = require('amdefine')(module);define(['exports'], function (exports) {
	'use strict';

	Object.defineProperty(exports, '__esModule', {
		value: true
	});
	var _ms2 = _ms;
	const bool = _ms2.bool;
	const unlazy = _ms2.unlazy;
	const
	// js.ms
	iNew = function (ctr, a, b, c) {
		// TODO:ES6 return new ctr(...args)
		switch (arguments.length) {
			case 0:
				throw new Error('`new` needs a constructor.');
			case 1:
				return new ctr();
			case 2:
				return new ctr(a);
			case 3:
				return new ctr(a, b);
			case 4:
				return new ctr(a, b, c);
			default:
				throw new Error('This many arguments not supported.');
		}
	},
	     

	// Boolean.ms
	// TODO:ES6 ...args
	iAnd = function () {
		const args = arguments;
		switch (args.length) {
			case 0:
				return true;
			case 1:
				return bool(args[0]);
			case 2:
				return bool(args[0]) && bool(unlazy(args[1]));
			case 3:
				return bool(args[0]) && bool(unlazy(args[1])) && bool(unlazy(args[2]));
			default:
				if (!bool(args[0])) return false;
				for (let i = 1; i < args.length; i = i + 1) if (!bool(unlazy(args[i]))) return false;
				return true;
		}
	},
	     

	// TODO:ES6 (...args) => {
	iOr = function () {
		const args = arguments;
		switch (args.length) {
			case 0:
				return false;
			case 1:
				return bool(args[0]);
			case 2:
				return bool(args[0]) || bool(unlazy(args[1]));
			case 3:
				return bool(args[0]) || bool(unlazy(args[1])) || bool(unlazy(args[2]));
			default:
				if (bool(args[0])) return true;
				for (let i = 1; i < args.length; i = i + 1) if (bool(unlazy(args[i]))) return true;
				return true;
		}
	},
	     

	// Kind.ms
	KindContains = function (kind, _) {
		return _ != null && _[kind['symbol-for-isa']] !== undefined;
	},
	      isEmpty = function (array) {
		return array.length === 0;
	},
	     

	// Try.ms
	ohNo = function (error) {
		throw makeError(error);
	},
	      alwaysDoAfter = function (tried, finallyDo) {
		try {
			return tried();
		} finally {
			finallyDo();
		}
	},
	      iTry = function (Success, tried) {
		try {
			return Success(tried());
		} catch (e) {
			return e;
		}
	},
	      makeError = function (error) {
		let err;
		try {
			err = _ms.unlazy(error);
		} catch (e) {
			// TODO: return new Error ('Error making error: ' + e.message)
			return makeError(e);
		}
		if (err instanceof Error) return err;else if (typeof err === 'string') return new Error(err);else if (err === undefined) return new Error('Oh no!');else throw new Error('Argument to `oh-no!` must be Error or String');
	},
	     

	// Array.ms
	// TODO:ES6 Shouldn't need this.
	arrayIterator = function* (_) {
		for (let i = 0; i < _.length; i = i + 1) yield _[i];
	},
	     

	// show.ms
	newSet = function () {
		return new Set();
	},
	     

	// Hash-Map.ms
	makeMap = function (hm, assoc, args) {
		let i = 0;
		while (i < args.length) {
			const key = args[i];
			i = i + 1;
			const val = args[i];
			i = i + 1;
			assoc(hm, key, val);
		}
	},
	     

	// Obj-Type.ms and Method.ms and Wrap-Type.ms
	buildStr = function (builder) {
		let s = '';
		builder(function (str) {
			s = s + str + '\n';
		});
		return s;
	},
	     
	// Obj-Type.ms
	addOne = function (_) {
		return _ + 1;
	},
	     

	// perf-test.ms
	timeStar = function (times, timeMe) {
		let i = times;
		const out = [];
		while (i > 0) {
			i = i - 1;
			out.push(timeMe(i));
		}
		return out;
	},
	     

	// Function.ms
	// TODO:ES6 (f, ...args) => Function.prototype.bind.call(f, null, ...args)
	iCurry = function (f) {
		return Function.prototype.bind.apply(f, arguments);
	},
	     

	// Method.js
	// TODO: Should be doable in Mason...
	methodArgNames = function (nArgs) {
		const res = [];
		const a = 'a'.charCodeAt(0);
		for (let i = 0; i < nArgs; i = i + 1) res.push(String.fromCharCode(a + i));
		return res.join(',');
	};

	exports.iNew = iNew;
	exports.iAnd = iAnd;
	exports.iOr = iOr;
	exports.KindContains = KindContains;
	exports.isEmpty = isEmpty;
	exports.ohNo = ohNo;
	exports.alwaysDoAfter = alwaysDoAfter;
	exports.iTry = iTry;
	exports.makeError = makeError;
	exports.arrayIterator = arrayIterator;
	exports.newSet = newSet;
	exports.makeMap = makeMap;
	exports.buildStr = buildStr;
	exports.addOne = addOne;
	exports.timeStar = timeStar;
	exports.iCurry = iCurry;
	exports.methodArgNames = methodArgNames;
	// hash-code.ms
	const hashes = new WeakMap();
	const hashCodeDefault = function (_, hashCode) {
		if (_ === null) return 108;
		if (_ === undefined) return 109;

		let hash = hashes.get(_);
		if (hash !== undefined) return hash;

		// Don't recurse infinitely.
		hashes.set(_, 17);

		hash = 17;
		for (let key in _) hash = hashCode(_[key]) + (hash * 23 | 0) | 0;

		hashes.set(_, hash);
		return hash;
	},
	      hashCodeString = function (_) {
		let hash = 13;
		for (let i = 0; i < _.length; i = i + 1) hash = (hash + _.charCodeAt(i) | 0) * 31;
		return hash;
	};
	exports.hashCodeDefault = hashCodeDefault;
	exports.hashCodeString = hashCodeString;
});
//# sourceMappingURL=data:application/json;base64,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QUMsSUFBSSxHQUFHLEVBQUUsR0FBSSxDQUFDLENBQUEsQUFBQyxHQUFJLENBQUMsQ0FBQTs7QUFFbEQsUUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUE7QUFDbkIsU0FBTyxJQUFJLENBQUE7RUFDWDtPQUVELGNBQWMsR0FBRyxVQUFBLENBQUMsRUFBSTtBQUNyQixNQUFJLElBQUksR0FBRyxFQUFFLENBQUE7QUFDYixPQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsRUFDdEMsSUFBSSxHQUFHLENBQUMsQUFBQyxJQUFJLEdBQUcsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsR0FBSSxDQUFDLENBQUEsR0FBSSxFQUFFLENBQUE7QUFDM0MsU0FBTyxJQUFJLENBQUE7RUFDWCxDQUFBO1NBMUJELGVBQWUsR0FBZixlQUFlO1NBcUJmLGNBQWMsR0FBZCxjQUFjIiwiZmlsZSI6InByaXZhdGUvanMtaW1wbC5qcyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IHsgYm9vbCwgdW5sYXp5IH0gPSBfbXNcblxuZXhwb3J0XHRjb25zdFxuXHQvLyBqcy5tc1xuXHRpTmV3ID0gZnVuY3Rpb24oY3RyLCBhLCBiLCBjKSB7XG5cdFx0Ly8gVE9ETzpFUzYgcmV0dXJuIG5ldyBjdHIoLi4uYXJncylcblx0XHRzd2l0Y2ggKGFyZ3VtZW50cy5sZW5ndGgpIHtcblx0XHRcdGNhc2UgMDogdGhyb3cgbmV3IEVycm9yKCdgbmV3YCBuZWVkcyBhIGNvbnN0cnVjdG9yLicpXG5cdFx0XHRjYXNlIDE6IHJldHVybiBuZXcgY3RyKClcblx0XHRcdGNhc2UgMjogcmV0dXJuIG5ldyBjdHIoYSlcblx0XHRcdGNhc2UgMzogcmV0dXJuIG5ldyBjdHIoYSwgYilcblx0XHRcdGNhc2UgNDogcmV0dXJuIG5ldyBjdHIoYSwgYiwgYylcblx0XHRcdGRlZmF1bHQ6IHRocm93IG5ldyBFcnJvcignVGhpcyBtYW55IGFyZ3VtZW50cyBub3Qgc3VwcG9ydGVkLicpXG5cdFx0fVxuXHR9LFxuXG5cdC8vIEJvb2xlYW4ubXNcblx0Ly8gVE9ETzpFUzYgLi4uYXJnc1xuXHRpQW5kID0gZnVuY3Rpb24oKSB7XG5cdFx0Y29uc3QgYXJncyA9IGFyZ3VtZW50c1xuXHRcdHN3aXRjaCAoYXJncy5sZW5ndGgpIHtcblx0XHRcdGNhc2UgMDogcmV0dXJuIHRydWVcblx0XHRcdGNhc2UgMTogcmV0dXJuIGJvb2woYXJnc1swXSlcblx0XHRcdGNhc2UgMjogcmV0dXJuIGJvb2woYXJnc1swXSkgJiYgYm9vbCh1bmxhenkoYXJnc1sxXSkpXG5cdFx0XHRjYXNlIDM6IHJldHVybiBib29sKGFyZ3NbMF0pICYmIGJvb2wodW5sYXp5KGFyZ3NbMV0pKSAmJiBib29sKHVubGF6eShhcmdzWzJdKSlcblx0XHRcdGRlZmF1bHQ6XG5cdFx0XHRcdGlmICghYm9vbChhcmdzWzBdKSlcblx0XHRcdFx0XHRyZXR1cm4gZmFsc2Vcblx0XHRcdFx0Zm9yIChsZXQgaSA9IDE7IGkgPCBhcmdzLmxlbmd0aDsgaSA9IGkgKyAxKVxuXHRcdFx0XHRcdGlmICghYm9vbCh1bmxhenkoYXJnc1tpXSkpKVxuXHRcdFx0XHRcdFx0cmV0dXJuIGZhbHNlXG5cdFx0XHRcdHJldHVybiB0cnVlXG5cdFx0fVxuXHR9LFxuXG5cdC8vIFRPRE86RVM2ICguLi5hcmdzKSA9PiB7XG5cdGlPciA9IGZ1bmN0aW9uKCkge1xuXHRcdGNvbnN0IGFyZ3MgPSBhcmd1bWVudHNcblx0XHRzd2l0Y2ggKGFyZ3MubGVuZ3RoKSB7XG5cdFx0XHRjYXNlIDA6IHJldHVybiBmYWxzZVxuXHRcdFx0Y2FzZSAxOiByZXR1cm4gYm9vbChhcmdzWzBdKVxuXHRcdFx0Y2FzZSAyOiByZXR1cm4gYm9vbChhcmdzWzBdKSB8fCBib29sKHVubGF6eShhcmdzWzFdKSlcblx0XHRcdGNhc2UgMzogcmV0dXJuIGJvb2woYXJnc1swXSkgfHwgYm9vbCh1bmxhenkoYXJnc1sxXSkpIHx8IGJvb2wodW5sYXp5KGFyZ3NbMl0pKVxuXHRcdFx0ZGVmYXVsdDpcblx0XHRcdFx0aWYgKGJvb2woYXJnc1swXSkpXG5cdFx0XHRcdFx0cmV0dXJuIHRydWVcblx0XHRcdFx0Zm9yIChsZXQgaSA9IDE7IGkgPCBhcmdzLmxlbmd0aDsgaSA9IGkgKyAxKVxuXHRcdFx0XHRcdGlmIChib29sKHVubGF6eShhcmdzW2ldKSkpXG5cdFx0XHRcdFx0XHRyZXR1cm4gdHJ1ZVxuXHRcdFx0XHRyZXR1cm4gdHJ1ZVxuXHRcdH1cblx0fSxcblxuXHQvLyBLaW5kLm1zXG5cdEtpbmRDb250YWlucyA9IChraW5kLCBfKSA9PlxuXHRcdF8gIT0gbnVsbCAmJiBfW2tpbmRbJ3N5bWJvbC1mb3ItaXNhJ11dICE9PSB1bmRlZmluZWQsXG5cdGlzRW1wdHkgPSBhcnJheSA9PiBhcnJheS5sZW5ndGggPT09IDAsXG5cblx0Ly8gVHJ5Lm1zXG5cdG9oTm8gPSBlcnJvciA9PiB7IHRocm93IG1ha2VFcnJvcihlcnJvcikgfSxcblx0YWx3YXlzRG9BZnRlciA9ICh0cmllZCwgZmluYWxseURvKSA9PiB7XG5cdFx0dHJ5IHtcblx0XHRcdHJldHVybiB0cmllZCgpXG5cdFx0fSBmaW5hbGx5IHtcblx0XHRcdGZpbmFsbHlEbygpXG5cdFx0fVxuXHR9LFxuXHRpVHJ5ID0gKFN1Y2Nlc3MsIHRyaWVkKSA9PiB7XG5cdFx0dHJ5IHtcblx0XHRcdHJldHVybiBTdWNjZXNzKHRyaWVkKCkpXG5cdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0cmV0dXJuIGVcblx0XHR9XG5cdH0sXG5cdG1ha2VFcnJvciA9IGVycm9yID0+IHtcblx0XHRsZXQgZXJyXG5cdFx0dHJ5IHtcblx0XHRcdGVyciA9IF9tcy51bmxhenkoZXJyb3IpXG5cdFx0fSBjYXRjaCAoZSkge1xuXHRcdFx0Ly8gVE9ETzogcmV0dXJuIG5ldyBFcnJvciAoJ0Vycm9yIG1ha2luZyBlcnJvcjogJyArIGUubWVzc2FnZSlcblx0XHRcdHJldHVybiBtYWtlRXJyb3IoZSlcblx0XHR9XG5cdFx0aWYgKGVyciBpbnN0YW5jZW9mIEVycm9yKVxuXHRcdFx0cmV0dXJuIGVyclxuXHRcdGVsc2UgaWYgKHR5cGVvZiBlcnIgPT09ICdzdHJpbmcnKVxuXHRcdFx0cmV0dXJuIG5ldyBFcnJvcihlcnIpXG5cdFx0ZWxzZSBpZiAoZXJyID09PSB1bmRlZmluZWQpXG5cdFx0XHRyZXR1cm4gbmV3IEVycm9yKCdPaCBubyEnKVxuXHRcdGVsc2Vcblx0XHRcdHRocm93IG5ldyBFcnJvcignQXJndW1lbnQgdG8gYG9oLW5vIWAgbXVzdCBiZSBFcnJvciBvciBTdHJpbmcnKVxuXHR9LFxuXG5cdC8vIEFycmF5Lm1zXG5cdC8vIFRPRE86RVM2IFNob3VsZG4ndCBuZWVkIHRoaXMuXG5cdGFycmF5SXRlcmF0b3IgPSBmdW5jdGlvbiooXykge1xuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgXy5sZW5ndGg7IGkgPSBpICsgMSlcblx0XHRcdHlpZWxkIF9baV1cblx0fSxcblxuXHQvLyBzaG93Lm1zXG5cdG5ld1NldCA9ICgpID0+IG5ldyBTZXQoKSxcblxuXHQvLyBIYXNoLU1hcC5tc1xuXHRtYWtlTWFwID0gKGhtLCBhc3NvYywgYXJncykgPT4ge1xuXHRcdGxldCBpID0gMFxuXHRcdHdoaWxlIChpIDwgYXJncy5sZW5ndGgpIHtcblx0XHRcdGNvbnN0IGtleSA9IGFyZ3NbaV1cblx0XHRcdGkgPSBpICsgMVxuXHRcdFx0Y29uc3QgdmFsID0gYXJnc1tpXVxuXHRcdFx0aSA9IGkgKyAxXG5cdFx0XHRhc3NvYyhobSwga2V5LCB2YWwpXG5cdFx0fVxuXHR9LFxuXG5cdC8vIE9iai1UeXBlLm1zIGFuZCBNZXRob2QubXMgYW5kIFdyYXAtVHlwZS5tc1xuXHRidWlsZFN0ciA9IGJ1aWxkZXIgPT4ge1xuXHRcdGxldCBzID0gJydcblx0XHRidWlsZGVyKHN0ciA9PiB7IHMgPSBzICsgc3RyICsgJ1xcbicgfSlcblx0XHRyZXR1cm4gc1xuXHR9LFxuXHQvLyBPYmotVHlwZS5tc1xuXHRhZGRPbmUgPSBfID0+IF8gKyAxLFxuXG5cdC8vIHBlcmYtdGVzdC5tc1xuXHR0aW1lU3RhciA9ICh0aW1lcywgdGltZU1lKSA9PiB7XG5cdFx0bGV0IGkgPSB0aW1lc1xuXHRcdGNvbnN0IG91dCA9IFtdXG5cdFx0d2hpbGUgKGkgPiAwKSB7XG5cdFx0XHRpID0gaSAtIDFcblx0XHRcdG91dC5wdXNoKHRpbWVNZShpKSlcblx0XHR9XG5cdFx0cmV0dXJuIG91dFxuXHR9LFxuXG5cdC8vIEZ1bmN0aW9uLm1zXG5cdC8vIFRPRE86RVM2IChmLCAuLi5hcmdzKSA9PiBGdW5jdGlvbi5wcm90b3R5cGUuYmluZC5jYWxsKGYsIG51bGwsIC4uLmFyZ3MpXG5cdGlDdXJyeSA9IGZ1bmN0aW9uKGYpIHtcblx0XHRyZXR1cm4gRnVuY3Rpb24ucHJvdG90eXBlLmJpbmQuYXBwbHkoZiwgYXJndW1lbnRzKVxuXHR9LFxuXG5cdC8vIE1ldGhvZC5qc1xuXHQvLyBUT0RPOiBTaG91bGQgYmUgZG9hYmxlIGluIE1hc29uLi4uXG5cdG1ldGhvZEFyZ05hbWVzID0gbkFyZ3MgPT4ge1xuXHRcdGNvbnN0IHJlcyA9IFsgXVxuXHRcdGNvbnN0IGEgPSAnYScuY2hhckNvZGVBdCgwKVxuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgbkFyZ3M7IGkgPSBpICsgMSlcblx0XHRcdHJlcy5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUoYSArIGkpKVxuXHRcdHJldHVybiByZXMuam9pbignLCcpXG5cdH1cblxuLy8gaGFzaC1jb2RlLm1zXG5jb25zdCBoYXNoZXMgPSBuZXcgV2Vha01hcCgpXG5leHBvcnQgY29uc3Rcblx0aGFzaENvZGVEZWZhdWx0ID0gKF8sIGhhc2hDb2RlKSA9PiB7XG5cdFx0aWYgKF8gPT09IG51bGwpXG5cdFx0XHRyZXR1cm4gMTA4XG5cdFx0aWYgKF8gPT09IHVuZGVmaW5lZClcblx0XHRcdHJldHVybiAxMDlcblxuXHRcdGxldCBoYXNoID0gaGFzaGVzLmdldChfKVxuXHRcdGlmIChoYXNoICE9PSB1bmRlZmluZWQpXG5cdFx0XHRyZXR1cm4gaGFzaFxuXG5cdFx0Ly8gRG9uJ3QgcmVjdXJzZSBpbmZpbml0ZWx5LlxuXHRcdGhhc2hlcy5zZXQoXywgMTcpXG5cblx0XHRoYXNoID0gMTdcblx0XHRmb3IgKGxldCBrZXkgaW4gXylcblx0XHRcdGhhc2ggPSAoaGFzaENvZGUoX1trZXldKSArICgoaGFzaCAqIDIzKSB8IDApKSB8IDBcblxuXHRcdGhhc2hlcy5zZXQoXywgaGFzaClcblx0XHRyZXR1cm4gaGFzaFxuXHR9LFxuXG5cdGhhc2hDb2RlU3RyaW5nID0gXyA9PiB7XG5cdFx0bGV0IGhhc2ggPSAxM1xuXHRcdGZvciAobGV0IGkgPSAwOyBpIDwgXy5sZW5ndGg7IGkgPSBpICsgMSlcblx0XHRcdGhhc2ggPSAoKGhhc2ggKyBfLmNoYXJDb2RlQXQoaSkpIHwgMCkgKiAzMVxuXHRcdHJldHVybiBoYXNoXG5cdH1cbiJdLCJzb3VyY2VSb290IjoiL3NyYyJ9