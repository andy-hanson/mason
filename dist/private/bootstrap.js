if (typeof define !== 'function') var define = require('amdefine')(module);define(['exports'], function (exports) {
	'use strict';

	Object.defineProperty(exports, '__esModule', {
		value: true
	});
	const pAdd = function (object, key, value) {
		return Object.defineProperty(object, key, {
			value: value,
			enumerable: true,
			// TODO:ES6 `writable` shouldn't need to be explicit
			writable: false
		});
	};

	exports.pAdd = pAdd;
	// region Builtin Functions for use by the compiler
	const
	// This object contains functions called upon by compiled code.
	ms = {},
	      msDef = function (name, fun) {
		return pAdd(ms, name, fun);
	},
	      msCall = function (name) {
		for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
			args[_key - 1] = arguments[_key];
		}

		return ms[name].apply(ms, args);
	};

	exports.ms = ms;
	exports.msDef = msDef;
	exports.msCall = msCall;
	pAdd(global, '_ms', ms);

	const msDefs = {
		lazyGetModule: function (module) {
			if (module === undefined) throw new Error('Module undefined.');
			return module._get instanceof ms.Lazy ? module._get : ms.lazy(function () {
				return module;
			});
		},

		getModule: function (module) {
			if (module === undefined) throw new Error('Module undefined.');
			return module._get instanceof ms.Lazy ? module._get.get() : module;
		},

		getDefaultExport: function (module) {
			if (module === undefined) throw new Error('Module undefined.');
			const mod = ms.getModule(module);
			return mod.default === undefined ? mod : mod.default;
		},

		lazyProp: function (lazyObject, key) {
			if (!(lazyObject instanceof ms.Lazy)) throw new Error('Expected a Lazy, got: ' + lazyObject);
			return ms.lazy(function () {
				return lazyObject.get()[key];
			});
		},

		get: function (object, key) {
			const _ = object[key];
			if (_ === undefined) throw new Error('Module ' + object.name + ' does not have ' + key);
			return _;
		},

		bool: function (b) {
			if (typeof b !== 'boolean') throw new Error('Expected Boolean, got ' + b);
			return b;
		},

		// Used for splat calls.
		// TODO:ES6 Shouldn't need. `fun(...arg)` should work for any iterable.
		arr: function (_) {
			if (_ instanceof Array) return _;
			const out = [];
			// TODO:ES6 Shouldn't need [Symbol.iterator]()
			for (let em of _[Symbol.iterator]()) out.push(em);
			return out;
		},

		// For use by Obj-Type.ms generated code.
		checkNoExtras: function (_this, _, rtName) {
			// If there was some key in `_` that we didn't copy:
			if (Object.keys(_).length > Object.keys(_this).length) Object.getOwnPropertyNames(_).forEach(function (name) {
				// TODO:DISPLAYNAME
				if (name !== 'name') if (!Object.prototype.hasOwnProperty.call(_this, name)) throw new Error('Extra prop ' + name + ' for ' + rtName);
			});
		},

		Lazy: function Lazy(get) {
			var _this2 = this;

			this.get = function () {
				_this2.get = function () {
					throw new Error('Lazy value depends on itself. Thunk: ' + get);
				};
				const _ = get();
				_this2.get = function () {
					return _;
				};
				return _;
			};
		},
		lazy: function (_) {
			return new ms.Lazy(_);
		},
		unlazy: function (_) {
			return _ instanceof ms.Lazy ? _.get() : _;
		},

		set: function (_, k0, v0, k1, v1, k2, v2, k3) {
			const doSet = function (k, v) {
				// TODO:DISPLAYNAME
				if (!(k === 'name' && _ instanceof Function)) _[k] = v;
			};

			doSet(k0, v0);
			if (k1 === undefined) return _;
			doSet(k1, v1);
			if (k2 === undefined) return _;
			doSet(k2, v2);
			if (k3 === undefined) return _;
			for (let i = 7; i < arguments.length; i = i + 2) doSet(arguments[i], arguments[i + 1]);
			return _;
		},

		lset: function (_, k0, v0, k1, v1, k2, v2, k3) {
			setOrLazy(_, k0, v0);
			if (k1 === undefined) return _;
			setOrLazy(_, k1, v1);
			if (k2 === undefined) return _;
			setOrLazy(_, k2, v2);
			if (k3 === undefined) return _;
			for (let i = 7; i < arguments.length; i = i + 2) setOrLazy(_, arguments[i], arguments[i + 1]);
			return _;
		}
	};
	Object.keys(msDefs).forEach(function (_) {
		return msDef(_, msDefs[_]);
	});

	const setOrLazy = function (obj, key, val) {
		if (val instanceof ms.Lazy) Object.setProperty(obj, key, { get: function () {
				return ms.unlazy(val);
			} });else pAdd(obj, key, val);
	};

	const msDefTemp = function (name, fun) {
		return ms[name] = fun;
	};

	msDefTemp('show', function (_) {
		if (typeof _ !== 'string' && typeof _ !== 'number') throw new Error('Only use Strings or Numbers here until this is overridden by show.ms. Got:\n' + _);
		return _.toString();
	});

	// region Contains
	// Some Types want to implement contains? before it is officially defined.
	const containsImplSymbol = 'impl-contains?';
	exports.containsImplSymbol = containsImplSymbol;
	const implContains = function (type, impl) {
		return Object.defineProperty(type.prototype, containsImplSymbol, {
			value: impl,
			enumerable: false
		});
	};

	exports.implContains = implContains;
	// Overwritten by Type/index.ms to actually do type checking.
	msDefTemp('checkContains', function (type, val) {
		return val;
	});

	Object[containsImplSymbol] = function (ignore, _) {
		if (_ == null) return false;
		switch (typeof _) {
			case 'boolean':
			case 'number':
			case 'string':
			case 'symbol':
				return false;
			default:
				return true;
		}
	};

	// An object is a Function if its typeof is `function`.
	// This helps us catch any callabe Obj-Type.
	// TODO: Separate Function from Callable
	// Since these are primitives, we can't use `instanceof`.
	[Function, Boolean, String, Symbol, Number].forEach(function (type) {
		// Generated code is faster than using a closure.
		const src = 'return typeof _ === "' + type.name.toLowerCase() + '"';
		pAdd(type, containsImplSymbol, Function('ignore', '_', src));
	});
});
//# sourceMappingURL=data:application/json;base64,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QUFTLENBQUM7QUFDZixRQUFLLFFBQVEsQ0FBQztBQUNkLFFBQUssUUFBUSxDQUFDO0FBQ2QsUUFBSyxRQUFRO0FBQ1osV0FBTyxLQUFLLENBQUE7QUFBQSxBQUNiO0FBQ0MsV0FBTyxJQUFJLENBQUE7QUFBQSxHQUNaO0VBQ0QsQ0FBQzs7Ozs7O0FBTUYsRUFBRSxRQUFRLEVBQUUsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsTUFBTSxDQUFFLENBQUMsT0FBTyxDQUFDLFVBQUEsSUFBSSxFQUFJOztBQUU3RCxRQUFNLEdBQUcsR0FBRyx1QkFBdUIsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxHQUFHLEdBQUcsQ0FBQTtBQUNuRSxNQUFJLENBQUMsSUFBSSxFQUFFLGtCQUFrQixFQUFFLFFBQVEsQ0FBQyxRQUFRLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQyxDQUFDLENBQUE7RUFDNUQsQ0FBQyxDQUFBIiwiZmlsZSI6InByaXZhdGUvYm9vdHN0cmFwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNvbnN0IHBBZGQgPSAob2JqZWN0LCBrZXksIHZhbHVlKSA9PlxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkob2JqZWN0LCBrZXksIHtcblx0XHR2YWx1ZSxcblx0XHRlbnVtZXJhYmxlOiB0cnVlLFxuXHRcdC8vIFRPRE86RVM2IGB3cml0YWJsZWAgc2hvdWxkbid0IG5lZWQgdG8gYmUgZXhwbGljaXRcblx0XHR3cml0YWJsZTogZmFsc2Vcblx0fSlcblxuLy8gcmVnaW9uIEJ1aWx0aW4gRnVuY3Rpb25zIGZvciB1c2UgYnkgdGhlIGNvbXBpbGVyXG5leHBvcnQgY29uc3Rcblx0Ly8gVGhpcyBvYmplY3QgY29udGFpbnMgZnVuY3Rpb25zIGNhbGxlZCB1cG9uIGJ5IGNvbXBpbGVkIGNvZGUuXG5cdG1zID0geyB9LFxuXHRtc0RlZiA9IChuYW1lLCBmdW4pID0+XG5cdFx0cEFkZChtcywgbmFtZSwgZnVuKSxcblx0bXNDYWxsID0gKG5hbWUsIC4uLmFyZ3MpID0+XG5cdFx0bXNbbmFtZV0oLi4uYXJncylcblxucEFkZChnbG9iYWwsICdfbXMnLCBtcylcblxuY29uc3QgbXNEZWZzID0ge1xuXHRsYXp5R2V0TW9kdWxlKG1vZHVsZSkge1xuXHRcdGlmIChtb2R1bGUgPT09IHVuZGVmaW5lZClcblx0XHRcdHRocm93IG5ldyBFcnJvcignTW9kdWxlIHVuZGVmaW5lZC4nKVxuXHRcdHJldHVybiBtb2R1bGUuX2dldCBpbnN0YW5jZW9mIG1zLkxhenkgPyBtb2R1bGUuX2dldCA6IG1zLmxhenkoKCkgPT4gbW9kdWxlKVxuXHR9LFxuXG5cdGdldE1vZHVsZShtb2R1bGUpIHtcblx0XHRpZiAobW9kdWxlID09PSB1bmRlZmluZWQpXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoJ01vZHVsZSB1bmRlZmluZWQuJylcblx0XHRyZXR1cm4gbW9kdWxlLl9nZXQgaW5zdGFuY2VvZiBtcy5MYXp5ID8gbW9kdWxlLl9nZXQuZ2V0KCkgOiBtb2R1bGVcblx0fSxcblxuXHRnZXREZWZhdWx0RXhwb3J0OiBtb2R1bGUgPT4ge1xuXHRcdGlmIChtb2R1bGUgPT09IHVuZGVmaW5lZClcblx0XHRcdHRocm93IG5ldyBFcnJvcignTW9kdWxlIHVuZGVmaW5lZC4nKVxuXHRcdGNvbnN0IG1vZCA9IG1zLmdldE1vZHVsZShtb2R1bGUpXG5cdFx0cmV0dXJuIG1vZC5kZWZhdWx0ID09PSB1bmRlZmluZWQgPyBtb2QgOiBtb2QuZGVmYXVsdFxuXHR9LFxuXG5cdGxhenlQcm9wKGxhenlPYmplY3QsIGtleSkge1xuXHRcdGlmICghKGxhenlPYmplY3QgaW5zdGFuY2VvZiBtcy5MYXp5KSlcblx0XHRcdHRocm93IG5ldyBFcnJvcihgRXhwZWN0ZWQgYSBMYXp5LCBnb3Q6ICR7bGF6eU9iamVjdH1gKVxuXHRcdHJldHVybiBtcy5sYXp5KCgpID0+IGxhenlPYmplY3QuZ2V0KClba2V5XSlcblx0fSxcblxuXHRnZXQob2JqZWN0LCBrZXkpIHtcblx0XHRjb25zdCBfID0gb2JqZWN0W2tleV1cblx0XHRpZiAoXyA9PT0gdW5kZWZpbmVkKVxuXHRcdFx0dGhyb3cgbmV3IEVycm9yKGBNb2R1bGUgJHtvYmplY3QubmFtZX0gZG9lcyBub3QgaGF2ZSAke2tleX1gKVxuXHRcdHJldHVybiBfXG5cdH0sXG5cblx0Ym9vbChiKSB7XG5cdFx0aWYgKHR5cGVvZiBiICE9PSAnYm9vbGVhbicpXG5cdFx0XHR0aHJvdyBuZXcgRXJyb3IoYEV4cGVjdGVkIEJvb2xlYW4sIGdvdCAke2J9YClcblx0XHRyZXR1cm4gYlxuXHR9LFxuXG5cdC8vIFVzZWQgZm9yIHNwbGF0IGNhbGxzLlxuXHQvLyBUT0RPOkVTNiBTaG91bGRuJ3QgbmVlZC4gYGZ1biguLi5hcmcpYCBzaG91bGQgd29yayBmb3IgYW55IGl0ZXJhYmxlLlxuXHRhcnIoXykge1xuXHRcdGlmIChfIGluc3RhbmNlb2YgQXJyYXkpXG5cdFx0XHRyZXR1cm4gX1xuXHRcdGNvbnN0IG91dCA9IFsgXVxuXHRcdC8vIFRPRE86RVM2IFNob3VsZG4ndCBuZWVkIFtTeW1ib2wuaXRlcmF0b3JdKClcblx0XHRmb3IgKGxldCBlbSBvZiBfW1N5bWJvbC5pdGVyYXRvcl0oKSlcblx0XHRcdG91dC5wdXNoKGVtKVxuXHRcdHJldHVybiBvdXRcblx0fSxcblxuXHQvLyBGb3IgdXNlIGJ5IE9iai1UeXBlLm1zIGdlbmVyYXRlZCBjb2RlLlxuXHRjaGVja05vRXh0cmFzKF90aGlzLCBfLCBydE5hbWUpIHtcblx0XHQvLyBJZiB0aGVyZSB3YXMgc29tZSBrZXkgaW4gYF9gIHRoYXQgd2UgZGlkbid0IGNvcHk6XG5cdFx0aWYgKE9iamVjdC5rZXlzKF8pLmxlbmd0aCA+IE9iamVjdC5rZXlzKF90aGlzKS5sZW5ndGgpXG5cdFx0XHRPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhfKS5mb3JFYWNoKGZ1bmN0aW9uKG5hbWUpIHtcblx0XHRcdFx0Ly8gVE9ETzpESVNQTEFZTkFNRVxuXHRcdFx0XHRpZiAobmFtZSAhPT0gJ25hbWUnKVxuXHRcdFx0XHRcdGlmICghT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKF90aGlzLCBuYW1lKSlcblx0XHRcdFx0XHRcdHRocm93IG5ldyBFcnJvcignRXh0cmEgcHJvcCAnICsgbmFtZSArICcgZm9yICcgKyBydE5hbWUpXG5cdFx0XHR9KVxuXHR9LFxuXG5cdExhenk6IGZ1bmN0aW9uIExhenkoZ2V0KSB7XG5cdFx0dGhpcy5nZXQgPSAoKSA9PiB7XG5cdFx0XHR0aGlzLmdldCA9ICgpID0+IHtcblx0XHRcdFx0dGhyb3cgbmV3IEVycm9yKGBMYXp5IHZhbHVlIGRlcGVuZHMgb24gaXRzZWxmLiBUaHVuazogJHtnZXR9YClcblx0XHRcdH1cblx0XHRcdGNvbnN0IF8gPSBnZXQoKVxuXHRcdFx0dGhpcy5nZXQgPSAoKSA9PiBfXG5cdFx0XHRyZXR1cm4gX1xuXHRcdH1cblx0fSxcblx0bGF6eTogXyA9PiBuZXcgbXMuTGF6eShfKSxcblx0dW5sYXp5OiBfID0+IF8gaW5zdGFuY2VvZiBtcy5MYXp5ID8gXy5nZXQoKSA6IF8sXG5cblx0c2V0KF8sIGswLCB2MCwgazEsIHYxLCBrMiwgdjIsIGszKSB7XG5cdFx0Y29uc3QgZG9TZXQgPSAoaywgdikgPT4ge1xuXHRcdFx0Ly8gVE9ETzpESVNQTEFZTkFNRVxuXHRcdFx0aWYgKCEoayA9PT0gJ25hbWUnICYmIF8gaW5zdGFuY2VvZiBGdW5jdGlvbikpXG5cdFx0XHRcdF9ba10gPSB2XG5cdFx0fVxuXG5cdFx0ZG9TZXQoazAsIHYwKVxuXHRcdGlmIChrMSA9PT0gdW5kZWZpbmVkKVxuXHRcdFx0cmV0dXJuIF9cblx0XHRkb1NldChrMSwgdjEpXG5cdFx0aWYgKGsyID09PSB1bmRlZmluZWQpXG5cdFx0XHRyZXR1cm4gX1xuXHRcdGRvU2V0KGsyLCB2Milcblx0XHRpZiAoazMgPT09IHVuZGVmaW5lZClcblx0XHRcdHJldHVybiBfXG5cdFx0Zm9yIChsZXQgaSA9IDc7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpID0gaSArIDIpXG5cdFx0XHRkb1NldChhcmd1bWVudHNbaV0sIGFyZ3VtZW50c1tpICsgMV0pXG5cdFx0cmV0dXJuIF9cblx0fSxcblxuXG5cdGxzZXQoXywgazAsIHYwLCBrMSwgdjEsIGsyLCB2MiwgazMpIHtcblx0XHRzZXRPckxhenkoXywgazAsIHYwKVxuXHRcdGlmIChrMSA9PT0gdW5kZWZpbmVkKVxuXHRcdFx0cmV0dXJuIF9cblx0XHRzZXRPckxhenkoXywgazEsIHYxKVxuXHRcdGlmIChrMiA9PT0gdW5kZWZpbmVkKVxuXHRcdFx0cmV0dXJuIF9cblx0XHRzZXRPckxhenkoXywgazIsIHYyKVxuXHRcdGlmIChrMyA9PT0gdW5kZWZpbmVkKVxuXHRcdFx0cmV0dXJuIF9cblx0XHRmb3IgKGxldCBpID0gNzsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkgPSBpICsgMilcblx0XHRcdHNldE9yTGF6eShfLCBhcmd1bWVudHNbaV0sIGFyZ3VtZW50c1tpICsgMV0pXG5cdFx0cmV0dXJuIF9cblx0fVxufVxuT2JqZWN0LmtleXMobXNEZWZzKS5mb3JFYWNoKF8gPT4gbXNEZWYoXywgbXNEZWZzW19dKSlcblxuY29uc3Qgc2V0T3JMYXp5ID0gKG9iaiwga2V5LCB2YWwpID0+IHtcblx0aWYgKHZhbCBpbnN0YW5jZW9mIG1zLkxhenkpXG5cdFx0T2JqZWN0LnNldFByb3BlcnR5KG9iaiwga2V5LCB7IGdldCgpIHsgcmV0dXJuIG1zLnVubGF6eSh2YWwpIH0gfSlcblx0ZWxzZVxuXHRcdHBBZGQob2JqLCBrZXksIHZhbClcbn1cblxuY29uc3QgbXNEZWZUZW1wID0gKG5hbWUsIGZ1bikgPT5cblx0bXNbbmFtZV0gPSBmdW5cblxubXNEZWZUZW1wKCdzaG93JywgXyA9PiB7XG5cdGlmICh0eXBlb2YgXyAhPT0gJ3N0cmluZycgJiYgdHlwZW9mIF8gIT09ICdudW1iZXInKVxuXHRcdHRocm93IG5ldyBFcnJvcihcblx0XHRcdGBPbmx5IHVzZSBTdHJpbmdzIG9yIE51bWJlcnMgaGVyZSB1bnRpbCB0aGlzIGlzIG92ZXJyaWRkZW4gYnkgc2hvdy5tcy4gR290OlxcbiR7X31gKVxuXHRyZXR1cm4gXy50b1N0cmluZygpXG59KVxuXG4vLyByZWdpb24gQ29udGFpbnNcbi8vIFNvbWUgVHlwZXMgd2FudCB0byBpbXBsZW1lbnQgY29udGFpbnM/IGJlZm9yZSBpdCBpcyBvZmZpY2lhbGx5IGRlZmluZWQuXG5leHBvcnQgY29uc3QgY29udGFpbnNJbXBsU3ltYm9sID0gJ2ltcGwtY29udGFpbnM/J1xuZXhwb3J0IGNvbnN0IGltcGxDb250YWlucyA9ICh0eXBlLCBpbXBsKSA9PlxuXHRPYmplY3QuZGVmaW5lUHJvcGVydHkodHlwZS5wcm90b3R5cGUsIGNvbnRhaW5zSW1wbFN5bWJvbCwge1xuXHRcdHZhbHVlOiBpbXBsLFxuXHRcdGVudW1lcmFibGU6IGZhbHNlXG5cdH0pXG5cbi8vIE92ZXJ3cml0dGVuIGJ5IFR5cGUvaW5kZXgubXMgdG8gYWN0dWFsbHkgZG8gdHlwZSBjaGVja2luZy5cbm1zRGVmVGVtcCgnY2hlY2tDb250YWlucycsICh0eXBlLCB2YWwpID0+IHZhbClcblxuT2JqZWN0W2NvbnRhaW5zSW1wbFN5bWJvbF0gPSBmdW5jdGlvbihpZ25vcmUsIF8pIHtcblx0aWYgKF8gPT0gbnVsbClcblx0XHRyZXR1cm4gZmFsc2Vcblx0c3dpdGNoICh0eXBlb2YgXykge1xuXHRcdGNhc2UgJ2Jvb2xlYW4nOlxuXHRcdGNhc2UgJ251bWJlcic6XG5cdFx0Y2FzZSAnc3RyaW5nJzpcblx0XHRjYXNlICdzeW1ib2wnOlxuXHRcdFx0cmV0dXJuIGZhbHNlXG5cdFx0ZGVmYXVsdDpcblx0XHRcdHJldHVybiB0cnVlXG5cdH1cbn07XG5cbi8vIEFuIG9iamVjdCBpcyBhIEZ1bmN0aW9uIGlmIGl0cyB0eXBlb2YgaXMgYGZ1bmN0aW9uYC5cbi8vIFRoaXMgaGVscHMgdXMgY2F0Y2ggYW55IGNhbGxhYmUgT2JqLVR5cGUuXG4vLyBUT0RPOiBTZXBhcmF0ZSBGdW5jdGlvbiBmcm9tIENhbGxhYmxlXG4vLyBTaW5jZSB0aGVzZSBhcmUgcHJpbWl0aXZlcywgd2UgY2FuJ3QgdXNlIGBpbnN0YW5jZW9mYC5cblsgRnVuY3Rpb24sIEJvb2xlYW4sIFN0cmluZywgU3ltYm9sLCBOdW1iZXIgXS5mb3JFYWNoKHR5cGUgPT4ge1xuXHQvLyBHZW5lcmF0ZWQgY29kZSBpcyBmYXN0ZXIgdGhhbiB1c2luZyBhIGNsb3N1cmUuXG5cdGNvbnN0IHNyYyA9ICdyZXR1cm4gdHlwZW9mIF8gPT09IFwiJyArIHR5cGUubmFtZS50b0xvd2VyQ2FzZSgpICsgJ1wiJ1xuXHRwQWRkKHR5cGUsIGNvbnRhaW5zSW1wbFN5bWJvbCwgRnVuY3Rpb24oJ2lnbm9yZScsICdfJywgc3JjKSlcbn0pXG4iXSwic291cmNlUm9vdCI6Ii9zcmMifQ==